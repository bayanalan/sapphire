import{S as Qe,i as Ye,s as Ze,k as x,a as G,l as I,m as j,c as V,h as E,n as w,b as z,D as A,C as Te,E as Nt,o as ut,F as de,q as ae,r as le,p as dt,G as ht,u as ft,H as Gt,I as Vt,y as _t,z as pt,A as vt,J as qt,K as Jt,L as Kt,g as De,d as Le,B as mt}from"../chunks/index.a6311b6a.js";import{p as Wt}from"../chunks/stores.4cf4ef89.js";import{_ as $e}from"../chunks/preload-helper.41c905a7.js";function zt(a,t){for(var e=0;e<t.length;e++){const r=t[e];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in a)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(a,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}))}var me=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xt(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var jt={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(a){(function(){var t=function(){this.init()};t.prototype={init:function(){var n=this||e;return n._counter=1e3,n._html5AudioPool=[],n.html5PoolSize=10,n._codecs={},n._howls=[],n._muted=!1,n._volume=1,n._canPlayEvent="canplaythrough",n._navigator=typeof window<"u"&&window.navigator?window.navigator:null,n.masterGain=null,n.noAudio=!1,n.usingWebAudio=!0,n.autoSuspend=!0,n.ctx=null,n.autoUnlock=!0,n._setup(),n},volume:function(n){var o=this||e;if(n=parseFloat(n),o.ctx||_(),typeof n<"u"&&n>=0&&n<=1){if(o._volume=n,o._muted)return o;o.usingWebAudio&&o.masterGain.gain.setValueAtTime(n,e.ctx.currentTime);for(var c=0;c<o._howls.length;c++)if(!o._howls[c]._webAudio)for(var f=o._howls[c]._getSoundIds(),m=0;m<f.length;m++){var y=o._howls[c]._soundById(f[m]);y&&y._node&&(y._node.volume=y._volume*n)}return o}return o._volume},mute:function(n){var o=this||e;o.ctx||_(),o._muted=n,o.usingWebAudio&&o.masterGain.gain.setValueAtTime(n?0:o._volume,e.ctx.currentTime);for(var c=0;c<o._howls.length;c++)if(!o._howls[c]._webAudio)for(var f=o._howls[c]._getSoundIds(),m=0;m<f.length;m++){var y=o._howls[c]._soundById(f[m]);y&&y._node&&(y._node.muted=n?!0:y._muted)}return o},stop:function(){for(var n=this||e,o=0;o<n._howls.length;o++)n._howls[o].stop();return n},unload:function(){for(var n=this||e,o=n._howls.length-1;o>=0;o--)n._howls[o].unload();return n.usingWebAudio&&n.ctx&&typeof n.ctx.close<"u"&&(n.ctx.close(),n.ctx=null,_()),n},codecs:function(n){return(this||e)._codecs[n.replace(/^x-/,"")]},_setup:function(){var n=this||e;if(n.state=n.ctx&&n.ctx.state||"suspended",n._autoSuspend(),!n.usingWebAudio)if(typeof Audio<"u")try{var o=new Audio;typeof o.oncanplaythrough>"u"&&(n._canPlayEvent="canplay")}catch{n.noAudio=!0}else n.noAudio=!0;try{var o=new Audio;o.muted&&(n.noAudio=!0)}catch{}return n.noAudio||n._setupCodecs(),n},_setupCodecs:function(){var n=this||e,o=null;try{o=typeof Audio<"u"?new Audio:null}catch{return n}if(!o||typeof o.canPlayType!="function")return n;var c=o.canPlayType("audio/mpeg;").replace(/^no$/,""),f=n._navigator?n._navigator.userAgent:"",m=f.match(/OPR\/([0-6].)/g),y=m&&parseInt(m[0].split("/")[1],10)<33,p=f.indexOf("Safari")!==-1&&f.indexOf("Chrome")===-1,b=f.match(/Version\/(.*?) /),T=p&&b&&parseInt(b[1],10)<15;return n._codecs={mp3:!!(!y&&(c||o.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!c,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(o.canPlayType('audio/wav; codecs="1"')||o.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!o.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(o.canPlayType("audio/x-m4b;")||o.canPlayType("audio/m4b;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!T&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!T&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(o.canPlayType("audio/x-flac;")||o.canPlayType("audio/flac;")).replace(/^no$/,"")},n},_unlockAudio:function(){var n=this||e;if(!(n._audioUnlocked||!n.ctx)){n._audioUnlocked=!1,n.autoUnlock=!1,!n._mobileUnloaded&&n.ctx.sampleRate!==44100&&(n._mobileUnloaded=!0,n.unload()),n._scratchBuffer=n.ctx.createBuffer(1,1,22050);var o=function(c){for(;n._html5AudioPool.length<n.html5PoolSize;)try{var f=new Audio;f._unlocked=!0,n._releaseHtml5Audio(f)}catch{n.noAudio=!0;break}for(var m=0;m<n._howls.length;m++)if(!n._howls[m]._webAudio)for(var y=n._howls[m]._getSoundIds(),p=0;p<y.length;p++){var b=n._howls[m]._soundById(y[p]);b&&b._node&&!b._node._unlocked&&(b._node._unlocked=!0,b._node.load())}n._autoResume();var T=n.ctx.createBufferSource();T.buffer=n._scratchBuffer,T.connect(n.ctx.destination),typeof T.start>"u"?T.noteOn(0):T.start(0),typeof n.ctx.resume=="function"&&n.ctx.resume(),T.onended=function(){T.disconnect(0),n._audioUnlocked=!0,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0),document.removeEventListener("click",o,!0),document.removeEventListener("keydown",o,!0);for(var S=0;S<n._howls.length;S++)n._howls[S]._emit("unlock")}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),document.addEventListener("click",o,!0),document.addEventListener("keydown",o,!0),n}},_obtainHtml5Audio:function(){var n=this||e;if(n._html5AudioPool.length)return n._html5AudioPool.pop();var o=new Audio().play();return o&&typeof Promise<"u"&&(o instanceof Promise||typeof o.then=="function")&&o.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(n){var o=this||e;return n._unlocked&&o._html5AudioPool.push(n),o},_autoSuspend:function(){var n=this;if(!(!n.autoSuspend||!n.ctx||typeof n.ctx.suspend>"u"||!e.usingWebAudio)){for(var o=0;o<n._howls.length;o++)if(n._howls[o]._webAudio){for(var c=0;c<n._howls[o]._sounds.length;c++)if(!n._howls[o]._sounds[c]._paused)return n}return n._suspendTimer&&clearTimeout(n._suspendTimer),n._suspendTimer=setTimeout(function(){if(n.autoSuspend){n._suspendTimer=null,n.state="suspending";var f=function(){n.state="suspended",n._resumeAfterSuspend&&(delete n._resumeAfterSuspend,n._autoResume())};n.ctx.suspend().then(f,f)}},3e4),n}},_autoResume:function(){var n=this;if(!(!n.ctx||typeof n.ctx.resume>"u"||!e.usingWebAudio))return n.state==="running"&&n.ctx.state!=="interrupted"&&n._suspendTimer?(clearTimeout(n._suspendTimer),n._suspendTimer=null):n.state==="suspended"||n.state==="running"&&n.ctx.state==="interrupted"?(n.ctx.resume().then(function(){n.state="running";for(var o=0;o<n._howls.length;o++)n._howls[o]._emit("resume")}),n._suspendTimer&&(clearTimeout(n._suspendTimer),n._suspendTimer=null)):n.state==="suspending"&&(n._resumeAfterSuspend=!0),n}};var e=new t,r=function(n){var o=this;if(!n.src||n.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}o.init(n)};r.prototype={init:function(n){var o=this;return e.ctx||_(),o._autoplay=n.autoplay||!1,o._format=typeof n.format!="string"?n.format:[n.format],o._html5=n.html5||!1,o._muted=n.mute||!1,o._loop=n.loop||!1,o._pool=n.pool||5,o._preload=typeof n.preload=="boolean"||n.preload==="metadata"?n.preload:!0,o._rate=n.rate||1,o._sprite=n.sprite||{},o._src=typeof n.src!="string"?n.src:[n.src],o._volume=n.volume!==void 0?n.volume:1,o._xhr={method:n.xhr&&n.xhr.method?n.xhr.method:"GET",headers:n.xhr&&n.xhr.headers?n.xhr.headers:null,withCredentials:n.xhr&&n.xhr.withCredentials?n.xhr.withCredentials:!1},o._duration=0,o._state="unloaded",o._sounds=[],o._endTimers={},o._queue=[],o._playLock=!1,o._onend=n.onend?[{fn:n.onend}]:[],o._onfade=n.onfade?[{fn:n.onfade}]:[],o._onload=n.onload?[{fn:n.onload}]:[],o._onloaderror=n.onloaderror?[{fn:n.onloaderror}]:[],o._onplayerror=n.onplayerror?[{fn:n.onplayerror}]:[],o._onpause=n.onpause?[{fn:n.onpause}]:[],o._onplay=n.onplay?[{fn:n.onplay}]:[],o._onstop=n.onstop?[{fn:n.onstop}]:[],o._onmute=n.onmute?[{fn:n.onmute}]:[],o._onvolume=n.onvolume?[{fn:n.onvolume}]:[],o._onrate=n.onrate?[{fn:n.onrate}]:[],o._onseek=n.onseek?[{fn:n.onseek}]:[],o._onunlock=n.onunlock?[{fn:n.onunlock}]:[],o._onresume=[],o._webAudio=e.usingWebAudio&&!o._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(o),o._autoplay&&o._queue.push({event:"play",action:function(){o.play()}}),o._preload&&o._preload!=="none"&&o.load(),o},load:function(){var n=this,o=null;if(e.noAudio){n._emit("loaderror",null,"No audio support.");return}typeof n._src=="string"&&(n._src=[n._src]);for(var c=0;c<n._src.length;c++){var f,m;if(n._format&&n._format[c])f=n._format[c];else{if(m=n._src[c],typeof m!="string"){n._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}f=/^data:audio\/([^;,]+);/i.exec(m),f||(f=/\.([^.]+)$/.exec(m.split("?",1)[0])),f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),f&&e.codecs(f)){o=n._src[c];break}}if(!o){n._emit("loaderror",null,"No codec support for selected audio sources.");return}return n._src=o,n._state="loading",window.location.protocol==="https:"&&o.slice(0,5)==="http:"&&(n._html5=!0,n._webAudio=!1),new i(n),n._webAudio&&l(n),n},play:function(n,o){var c=this,f=null;if(typeof n=="number")f=n,n=null;else{if(typeof n=="string"&&c._state==="loaded"&&!c._sprite[n])return null;if(typeof n>"u"&&(n="__default",!c._playLock)){for(var m=0,y=0;y<c._sounds.length;y++)c._sounds[y]._paused&&!c._sounds[y]._ended&&(m++,f=c._sounds[y]._id);m===1?n=null:f=null}}var p=f?c._soundById(f):c._inactiveSound();if(!p)return null;if(f&&!n&&(n=p._sprite||"__default"),c._state!=="loaded"){p._sprite=n,p._ended=!1;var b=p._id;return c._queue.push({event:"play",action:function(){c.play(b)}}),b}if(f&&!p._paused)return o||c._loadQueue("play"),p._id;c._webAudio&&e._autoResume();var T=Math.max(0,p._seek>0?p._seek:c._sprite[n][0]/1e3),S=Math.max(0,(c._sprite[n][0]+c._sprite[n][1])/1e3-T),R=S*1e3/Math.abs(p._rate),U=c._sprite[n][0]/1e3,M=(c._sprite[n][0]+c._sprite[n][1])/1e3;p._sprite=n,p._ended=!1;var $=function(){p._paused=!1,p._seek=T,p._start=U,p._stop=M,p._loop=!!(p._loop||c._sprite[n][2])};if(T>=M){c._ended(p);return}var P=p._node;if(c._webAudio){var q=function(){c._playLock=!1,$(),c._refreshBuffer(p);var v=p._muted||c._muted?0:p._volume;P.gain.setValueAtTime(v,e.ctx.currentTime),p._playStart=e.ctx.currentTime,typeof P.bufferSource.start>"u"?p._loop?P.bufferSource.noteGrainOn(0,T,86400):P.bufferSource.noteGrainOn(0,T,S):p._loop?P.bufferSource.start(0,T,86400):P.bufferSource.start(0,T,S),R!==1/0&&(c._endTimers[p._id]=setTimeout(c._ended.bind(c,p),R)),o||setTimeout(function(){c._emit("play",p._id),c._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?q():(c._playLock=!0,c.once("resume",q),c._clearTimer(p._id))}else{var L=function(){P.currentTime=T,P.muted=p._muted||c._muted||e._muted||P.muted,P.volume=p._volume*e.volume(),P.playbackRate=p._rate;try{var v=P.play();if(v&&typeof Promise<"u"&&(v instanceof Promise||typeof v.then=="function")?(c._playLock=!0,$(),v.then(function(){c._playLock=!1,P._unlocked=!0,o?c._loadQueue():c._emit("play",p._id)}).catch(function(){c._playLock=!1,c._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),p._ended=!0,p._paused=!0})):o||(c._playLock=!1,$(),c._emit("play",p._id)),P.playbackRate=p._rate,P.paused){c._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}n!=="__default"||p._loop?c._endTimers[p._id]=setTimeout(c._ended.bind(c,p),R):(c._endTimers[p._id]=function(){c._ended(p),P.removeEventListener("ended",c._endTimers[p._id],!1)},P.addEventListener("ended",c._endTimers[p._id],!1))}catch(g){c._emit("playerror",p._id,g)}};P.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(P.src=c._src,P.load());var X=window&&window.ejecta||!P.readyState&&e._navigator.isCocoonJS;if(P.readyState>=3||X)L();else{c._playLock=!0,c._state="loading";var Q=function(){c._state="loaded",L(),P.removeEventListener(e._canPlayEvent,Q,!1)};P.addEventListener(e._canPlayEvent,Q,!1),c._clearTimer(p._id)}}return p._id},pause:function(n){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"pause",action:function(){o.pause(n)}}),o;for(var c=o._getSoundIds(n),f=0;f<c.length;f++){o._clearTimer(c[f]);var m=o._soundById(c[f]);if(m&&!m._paused&&(m._seek=o.seek(c[f]),m._rateSeek=0,m._paused=!0,o._stopFade(c[f]),m._node))if(o._webAudio){if(!m._node.bufferSource)continue;typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),o._cleanBuffer(m._node)}else(!isNaN(m._node.duration)||m._node.duration===1/0)&&m._node.pause();arguments[1]||o._emit("pause",m?m._id:null)}return o},stop:function(n,o){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"stop",action:function(){c.stop(n)}}),c;for(var f=c._getSoundIds(n),m=0;m<f.length;m++){c._clearTimer(f[m]);var y=c._soundById(f[m]);y&&(y._seek=y._start||0,y._rateSeek=0,y._paused=!0,y._ended=!0,c._stopFade(f[m]),y._node&&(c._webAudio?y._node.bufferSource&&(typeof y._node.bufferSource.stop>"u"?y._node.bufferSource.noteOff(0):y._node.bufferSource.stop(0),c._cleanBuffer(y._node)):(!isNaN(y._node.duration)||y._node.duration===1/0)&&(y._node.currentTime=y._start||0,y._node.pause(),y._node.duration===1/0&&c._clearSound(y._node))),o||c._emit("stop",y._id))}return c},mute:function(n,o){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"mute",action:function(){c.mute(n,o)}}),c;if(typeof o>"u")if(typeof n=="boolean")c._muted=n;else return c._muted;for(var f=c._getSoundIds(o),m=0;m<f.length;m++){var y=c._soundById(f[m]);y&&(y._muted=n,y._interval&&c._stopFade(y._id),c._webAudio&&y._node?y._node.gain.setValueAtTime(n?0:y._volume,e.ctx.currentTime):y._node&&(y._node.muted=e._muted?!0:n),c._emit("mute",y._id))}return c},volume:function(){var n=this,o=arguments,c,f;if(o.length===0)return n._volume;if(o.length===1||o.length===2&&typeof o[1]>"u"){var m=n._getSoundIds(),y=m.indexOf(o[0]);y>=0?f=parseInt(o[0],10):c=parseFloat(o[0])}else o.length>=2&&(c=parseFloat(o[0]),f=parseInt(o[1],10));var p;if(typeof c<"u"&&c>=0&&c<=1){if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,o)}}),n;typeof f>"u"&&(n._volume=c),f=n._getSoundIds(f);for(var b=0;b<f.length;b++)p=n._soundById(f[b]),p&&(p._volume=c,o[2]||n._stopFade(f[b]),n._webAudio&&p._node&&!p._muted?p._node.gain.setValueAtTime(c,e.ctx.currentTime):p._node&&!p._muted&&(p._node.volume=c*e.volume()),n._emit("volume",p._id))}else return p=f?n._soundById(f):n._sounds[0],p?p._volume:0;return n},fade:function(n,o,c,f){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"fade",action:function(){m.fade(n,o,c,f)}}),m;n=Math.min(Math.max(0,parseFloat(n)),1),o=Math.min(Math.max(0,parseFloat(o)),1),c=parseFloat(c),m.volume(n,f);for(var y=m._getSoundIds(f),p=0;p<y.length;p++){var b=m._soundById(y[p]);if(b){if(f||m._stopFade(y[p]),m._webAudio&&!b._muted){var T=e.ctx.currentTime,S=T+c/1e3;b._volume=n,b._node.gain.setValueAtTime(n,T),b._node.gain.linearRampToValueAtTime(o,S)}m._startFadeInterval(b,n,o,c,y[p],typeof f>"u")}}return m},_startFadeInterval:function(n,o,c,f,m,y){var p=this,b=o,T=c-o,S=Math.abs(T/.01),R=Math.max(4,S>0?f/S:f),U=Date.now();n._fadeTo=c,n._interval=setInterval(function(){var M=(Date.now()-U)/f;U=Date.now(),b+=T*M,b=Math.round(b*100)/100,T<0?b=Math.max(c,b):b=Math.min(c,b),p._webAudio?n._volume=b:p.volume(b,n._id,!0),y&&(p._volume=b),(c<o&&b<=c||c>o&&b>=c)&&(clearInterval(n._interval),n._interval=null,n._fadeTo=null,p.volume(c,n._id),p._emit("fade",n._id))},R)},_stopFade:function(n){var o=this,c=o._soundById(n);return c&&c._interval&&(o._webAudio&&c._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(c._interval),c._interval=null,o.volume(c._fadeTo,n),c._fadeTo=null,o._emit("fade",n)),o},loop:function(){var n=this,o=arguments,c,f,m;if(o.length===0)return n._loop;if(o.length===1)if(typeof o[0]=="boolean")c=o[0],n._loop=c;else return m=n._soundById(parseInt(o[0],10)),m?m._loop:!1;else o.length===2&&(c=o[0],f=parseInt(o[1],10));for(var y=n._getSoundIds(f),p=0;p<y.length;p++)m=n._soundById(y[p]),m&&(m._loop=c,n._webAudio&&m._node&&m._node.bufferSource&&(m._node.bufferSource.loop=c,c&&(m._node.bufferSource.loopStart=m._start||0,m._node.bufferSource.loopEnd=m._stop,n.playing(y[p])&&(n.pause(y[p],!0),n.play(y[p],!0)))));return n},rate:function(){var n=this,o=arguments,c,f;if(o.length===0)f=n._sounds[0]._id;else if(o.length===1){var m=n._getSoundIds(),y=m.indexOf(o[0]);y>=0?f=parseInt(o[0],10):c=parseFloat(o[0])}else o.length===2&&(c=parseFloat(o[0]),f=parseInt(o[1],10));var p;if(typeof c=="number"){if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,o)}}),n;typeof f>"u"&&(n._rate=c),f=n._getSoundIds(f);for(var b=0;b<f.length;b++)if(p=n._soundById(f[b]),p){n.playing(f[b])&&(p._rateSeek=n.seek(f[b]),p._playStart=n._webAudio?e.ctx.currentTime:p._playStart),p._rate=c,n._webAudio&&p._node&&p._node.bufferSource?p._node.bufferSource.playbackRate.setValueAtTime(c,e.ctx.currentTime):p._node&&(p._node.playbackRate=c);var T=n.seek(f[b]),S=(n._sprite[p._sprite][0]+n._sprite[p._sprite][1])/1e3-T,R=S*1e3/Math.abs(p._rate);(n._endTimers[f[b]]||!p._paused)&&(n._clearTimer(f[b]),n._endTimers[f[b]]=setTimeout(n._ended.bind(n,p),R)),n._emit("rate",p._id)}}else return p=n._soundById(f),p?p._rate:n._rate;return n},seek:function(){var n=this,o=arguments,c,f;if(o.length===0)n._sounds.length&&(f=n._sounds[0]._id);else if(o.length===1){var m=n._getSoundIds(),y=m.indexOf(o[0]);y>=0?f=parseInt(o[0],10):n._sounds.length&&(f=n._sounds[0]._id,c=parseFloat(o[0]))}else o.length===2&&(c=parseFloat(o[0]),f=parseInt(o[1],10));if(typeof f>"u")return 0;if(typeof c=="number"&&(n._state!=="loaded"||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,o)}}),n;var p=n._soundById(f);if(p)if(typeof c=="number"&&c>=0){var b=n.playing(f);b&&n.pause(f,!0),p._seek=c,p._ended=!1,n._clearTimer(f),!n._webAudio&&p._node&&!isNaN(p._node.duration)&&(p._node.currentTime=c);var T=function(){b&&n.play(f,!0),n._emit("seek",f)};if(b&&!n._webAudio){var S=function(){n._playLock?setTimeout(S,0):T()};setTimeout(S,0)}else T()}else if(n._webAudio){var R=n.playing(f)?e.ctx.currentTime-p._playStart:0,U=p._rateSeek?p._rateSeek-p._seek:0;return p._seek+(U+R*Math.abs(p._rate))}else return p._node.currentTime;return n},playing:function(n){var o=this;if(typeof n=="number"){var c=o._soundById(n);return c?!c._paused:!1}for(var f=0;f<o._sounds.length;f++)if(!o._sounds[f]._paused)return!0;return!1},duration:function(n){var o=this,c=o._duration,f=o._soundById(n);return f&&(c=o._sprite[f._sprite][1]/1e3),c},state:function(){return this._state},unload:function(){for(var n=this,o=n._sounds,c=0;c<o.length;c++)o[c]._paused||n.stop(o[c]._id),n._webAudio||(n._clearSound(o[c]._node),o[c]._node.removeEventListener("error",o[c]._errorFn,!1),o[c]._node.removeEventListener(e._canPlayEvent,o[c]._loadFn,!1),o[c]._node.removeEventListener("ended",o[c]._endFn,!1),e._releaseHtml5Audio(o[c]._node)),delete o[c]._node,n._clearTimer(o[c]._id);var f=e._howls.indexOf(n);f>=0&&e._howls.splice(f,1);var m=!0;for(c=0;c<e._howls.length;c++)if(e._howls[c]._src===n._src||n._src.indexOf(e._howls[c]._src)>=0){m=!1;break}return s&&m&&delete s[n._src],e.noAudio=!1,n._state="unloaded",n._sounds=[],n=null,null},on:function(n,o,c,f){var m=this,y=m["_on"+n];return typeof o=="function"&&y.push(f?{id:c,fn:o,once:f}:{id:c,fn:o}),m},off:function(n,o,c){var f=this,m=f["_on"+n],y=0;if(typeof o=="number"&&(c=o,o=null),o||c)for(y=0;y<m.length;y++){var p=c===m[y].id;if(o===m[y].fn&&p||!o&&p){m.splice(y,1);break}}else if(n)f["_on"+n]=[];else{var b=Object.keys(f);for(y=0;y<b.length;y++)b[y].indexOf("_on")===0&&Array.isArray(f[b[y]])&&(f[b[y]]=[])}return f},once:function(n,o,c){var f=this;return f.on(n,o,c,1),f},_emit:function(n,o,c){for(var f=this,m=f["_on"+n],y=m.length-1;y>=0;y--)(!m[y].id||m[y].id===o||n==="load")&&(setTimeout(function(p){p.call(this,o,c)}.bind(f,m[y].fn),0),m[y].once&&f.off(n,m[y].fn,m[y].id));return f._loadQueue(n),f},_loadQueue:function(n){var o=this;if(o._queue.length>0){var c=o._queue[0];c.event===n&&(o._queue.shift(),o._loadQueue()),n||c.action()}return o},_ended:function(n){var o=this,c=n._sprite;if(!o._webAudio&&n._node&&!n._node.paused&&!n._node.ended&&n._node.currentTime<n._stop)return setTimeout(o._ended.bind(o,n),100),o;var f=!!(n._loop||o._sprite[c][2]);if(o._emit("end",n._id),!o._webAudio&&f&&o.stop(n._id,!0).play(n._id),o._webAudio&&f){o._emit("play",n._id),n._seek=n._start||0,n._rateSeek=0,n._playStart=e.ctx.currentTime;var m=(n._stop-n._start)*1e3/Math.abs(n._rate);o._endTimers[n._id]=setTimeout(o._ended.bind(o,n),m)}return o._webAudio&&!f&&(n._paused=!0,n._ended=!0,n._seek=n._start||0,n._rateSeek=0,o._clearTimer(n._id),o._cleanBuffer(n._node),e._autoSuspend()),!o._webAudio&&!f&&o.stop(n._id,!0),o},_clearTimer:function(n){var o=this;if(o._endTimers[n]){if(typeof o._endTimers[n]!="function")clearTimeout(o._endTimers[n]);else{var c=o._soundById(n);c&&c._node&&c._node.removeEventListener("ended",o._endTimers[n],!1)}delete o._endTimers[n]}return o},_soundById:function(n){for(var o=this,c=0;c<o._sounds.length;c++)if(n===o._sounds[c]._id)return o._sounds[c];return null},_inactiveSound:function(){var n=this;n._drain();for(var o=0;o<n._sounds.length;o++)if(n._sounds[o]._ended)return n._sounds[o].reset();return new i(n)},_drain:function(){var n=this,o=n._pool,c=0,f=0;if(!(n._sounds.length<o)){for(f=0;f<n._sounds.length;f++)n._sounds[f]._ended&&c++;for(f=n._sounds.length-1;f>=0;f--){if(c<=o)return;n._sounds[f]._ended&&(n._webAudio&&n._sounds[f]._node&&n._sounds[f]._node.disconnect(0),n._sounds.splice(f,1),c--)}}},_getSoundIds:function(n){var o=this;if(typeof n>"u"){for(var c=[],f=0;f<o._sounds.length;f++)c.push(o._sounds[f]._id);return c}else return[n]},_refreshBuffer:function(n){var o=this;return n._node.bufferSource=e.ctx.createBufferSource(),n._node.bufferSource.buffer=s[o._src],n._panner?n._node.bufferSource.connect(n._panner):n._node.bufferSource.connect(n._node),n._node.bufferSource.loop=n._loop,n._loop&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop||0),n._node.bufferSource.playbackRate.setValueAtTime(n._rate,e.ctx.currentTime),o},_cleanBuffer:function(n){var o=this,c=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&n.bufferSource&&(n.bufferSource.onended=null,n.bufferSource.disconnect(0),c))try{n.bufferSource.buffer=e._scratchBuffer}catch{}return n.bufferSource=null,o},_clearSound:function(n){var o=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);o||(n.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(n){this._parent=n,this.init()};i.prototype={init:function(){var n=this,o=n._parent;return n._muted=o._muted,n._loop=o._loop,n._volume=o._volume,n._rate=o._rate,n._seek=0,n._paused=!0,n._ended=!0,n._sprite="__default",n._id=++e._counter,o._sounds.push(n),n.create(),n},create:function(){var n=this,o=n._parent,c=e._muted||n._muted||n._parent._muted?0:n._volume;return o._webAudio?(n._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),n._node.gain.setValueAtTime(c,e.ctx.currentTime),n._node.paused=!0,n._node.connect(e.masterGain)):e.noAudio||(n._node=e._obtainHtml5Audio(),n._errorFn=n._errorListener.bind(n),n._node.addEventListener("error",n._errorFn,!1),n._loadFn=n._loadListener.bind(n),n._node.addEventListener(e._canPlayEvent,n._loadFn,!1),n._endFn=n._endListener.bind(n),n._node.addEventListener("ended",n._endFn,!1),n._node.src=o._src,n._node.preload=o._preload===!0?"auto":o._preload,n._node.volume=c*e.volume(),n._node.load()),n},reset:function(){var n=this,o=n._parent;return n._muted=o._muted,n._loop=o._loop,n._volume=o._volume,n._rate=o._rate,n._seek=0,n._rateSeek=0,n._paused=!0,n._ended=!0,n._sprite="__default",n._id=++e._counter,n},_errorListener:function(){var n=this;n._parent._emit("loaderror",n._id,n._node.error?n._node.error.code:0),n._node.removeEventListener("error",n._errorFn,!1)},_loadListener:function(){var n=this,o=n._parent;o._duration=Math.ceil(n._node.duration*10)/10,Object.keys(o._sprite).length===0&&(o._sprite={__default:[0,o._duration*1e3]}),o._state!=="loaded"&&(o._state="loaded",o._emit("load"),o._loadQueue()),n._node.removeEventListener(e._canPlayEvent,n._loadFn,!1)},_endListener:function(){var n=this,o=n._parent;o._duration===1/0&&(o._duration=Math.ceil(n._node.duration*10)/10,o._sprite.__default[1]===1/0&&(o._sprite.__default[1]=o._duration*1e3),o._ended(n)),n._node.removeEventListener("ended",n._endFn,!1)}};var s={},l=function(n){var o=n._src;if(s[o]){n._duration=s[o].duration,u(n);return}if(/^data:[^;]+;base64,/.test(o)){for(var c=atob(o.split(",")[1]),f=new Uint8Array(c.length),m=0;m<c.length;++m)f[m]=c.charCodeAt(m);d(f.buffer,n)}else{var y=new XMLHttpRequest;y.open(n._xhr.method,o,!0),y.withCredentials=n._xhr.withCredentials,y.responseType="arraybuffer",n._xhr.headers&&Object.keys(n._xhr.headers).forEach(function(p){y.setRequestHeader(p,n._xhr.headers[p])}),y.onload=function(){var p=(y.status+"")[0];if(p!=="0"&&p!=="2"&&p!=="3"){n._emit("loaderror",null,"Failed loading audio file with status: "+y.status+".");return}d(y.response,n)},y.onerror=function(){n._webAudio&&(n._html5=!0,n._webAudio=!1,n._sounds=[],delete s[o],n.load())},h(y)}},h=function(n){try{n.send()}catch{n.onerror()}},d=function(n,o){var c=function(){o._emit("loaderror",null,"Decoding audio data failed.")},f=function(m){m&&o._sounds.length>0?(s[o._src]=m,u(o,m)):c()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(n).then(f).catch(c):e.ctx.decodeAudioData(n,f,c)},u=function(n,o){o&&!n._duration&&(n._duration=o.duration),Object.keys(n._sprite).length===0&&(n._sprite={__default:[0,n._duration*1e3]}),n._state!=="loaded"&&(n._state="loaded",n._emit("load"),n._loadQueue())},_=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var n=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),o=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),c=o?parseInt(o[1],10):null;if(n&&c&&c<9){var f=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!f&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};a.Howler=e,a.Howl=r,typeof me<"u"?(me.HowlerGlobal=t,me.Howler=e,me.Howl=r,me.Sound=i):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=r,window.Sound=i)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var r=this;if(!r.ctx||!r.ctx.listener)return r;for(var i=r._howls.length-1;i>=0;i--)r._howls[i].stereo(e);return r},HowlerGlobal.prototype.pos=function(e,r,i){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(r=typeof r!="number"?s._pos[1]:r,i=typeof i!="number"?s._pos[2]:i,typeof e=="number")s._pos=[e,r,i],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(e,r,i,s,l,h){var d=this;if(!d.ctx||!d.ctx.listener)return d;var u=d._orientation;if(r=typeof r!="number"?u[1]:r,i=typeof i!="number"?u[2]:i,s=typeof s!="number"?u[3]:s,l=typeof l!="number"?u[4]:l,h=typeof h!="number"?u[5]:h,typeof e=="number")d._orientation=[e,r,i,s,l,h],typeof d.ctx.listener.forwardX<"u"?(d.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),d.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),d.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),d.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),d.ctx.listener.upY.setTargetAtTime(l,Howler.ctx.currentTime,.1),d.ctx.listener.upZ.setTargetAtTime(h,Howler.ctx.currentTime,.1)):d.ctx.listener.setOrientation(e,r,i,s,l,h);else return u;return d},Howl.prototype.init=function(e){return function(r){var i=this;return i._orientation=r.orientation||[1,0,0],i._stereo=r.stereo||null,i._pos=r.pos||null,i._pannerAttr={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:360,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:360,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:0,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:"inverse",maxDistance:typeof r.maxDistance<"u"?r.maxDistance:1e4,panningModel:typeof r.panningModel<"u"?r.panningModel:"HRTF",refDistance:typeof r.refDistance<"u"?r.refDistance:1,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:1},i._onstereo=r.onstereo?[{fn:r.onstereo}]:[],i._onpos=r.onpos?[{fn:r.onpos}]:[],i._onorientation=r.onorientation?[{fn:r.onorientation}]:[],e.call(this,r)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,r){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(e,r)}}),i;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof r>"u")if(typeof e=="number")i._stereo=e,i._pos=[e,0,0];else return i._stereo;for(var l=i._getSoundIds(r),h=0;h<l.length;h++){var d=i._soundById(l[h]);if(d)if(typeof e=="number")d._stereo=e,d._pos=[e,0,0],d._node&&(d._pannerAttr.panningModel="equalpower",(!d._panner||!d._panner.pan)&&t(d,s),s==="spatial"?typeof d._panner.positionX<"u"?(d._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),d._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),d._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):d._panner.setPosition(e,0,0):d._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),i._emit("stereo",d._id);else return d._stereo}return i},Howl.prototype.pos=function(e,r,i,s){var l=this;if(!l._webAudio)return l;if(l._state!=="loaded")return l._queue.push({event:"pos",action:function(){l.pos(e,r,i,s)}}),l;if(r=typeof r!="number"?0:r,i=typeof i!="number"?-.5:i,typeof s>"u")if(typeof e=="number")l._pos=[e,r,i];else return l._pos;for(var h=l._getSoundIds(s),d=0;d<h.length;d++){var u=l._soundById(h[d]);if(u)if(typeof e=="number")u._pos=[e,r,i],u._node&&((!u._panner||u._panner.pan)&&t(u,"spatial"),typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setPosition(e,r,i)),l._emit("pos",u._id);else return u._pos}return l},Howl.prototype.orientation=function(e,r,i,s){var l=this;if(!l._webAudio)return l;if(l._state!=="loaded")return l._queue.push({event:"orientation",action:function(){l.orientation(e,r,i,s)}}),l;if(r=typeof r!="number"?l._orientation[1]:r,i=typeof i!="number"?l._orientation[2]:i,typeof s>"u")if(typeof e=="number")l._orientation=[e,r,i];else return l._orientation;for(var h=l._getSoundIds(s),d=0;d<h.length;d++){var u=l._soundById(h[d]);if(u)if(typeof e=="number")u._orientation=[e,r,i],u._node&&(u._panner||(u._pos||(u._pos=l._pos||[0,0,-.5]),t(u,"spatial")),typeof u._panner.orientationX<"u"?(u._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setOrientation(e,r,i)),l._emit("orientation",u._id);else return u._orientation}return l},Howl.prototype.pannerAttr=function(){var e=this,r=arguments,i,s,l;if(!e._webAudio)return e;if(r.length===0)return e._pannerAttr;if(r.length===1)if(typeof r[0]=="object")i=r[0],typeof s>"u"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),e._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle<"u"?i.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle<"u"?i.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain<"u"?i.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel<"u"?i.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance<"u"?i.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof i.pannerAttr.refDistance<"u"?i.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor<"u"?i.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel<"u"?i.pannerAttr.panningModel:e._panningModel});else return l=e._soundById(parseInt(r[0],10)),l?l._pannerAttr:e._pannerAttr;else r.length===2&&(i=r[0],s=parseInt(r[1],10));for(var h=e._getSoundIds(s),d=0;d<h.length;d++)if(l=e._soundById(h[d]),l){var u=l._pannerAttr;u={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:u.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:u.coneOuterGain,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:u.distanceModel,maxDistance:typeof i.maxDistance<"u"?i.maxDistance:u.maxDistance,refDistance:typeof i.refDistance<"u"?i.refDistance:u.refDistance,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:u.rolloffFactor,panningModel:typeof i.panningModel<"u"?i.panningModel:u.panningModel};var _=l._panner;_?(_.coneInnerAngle=u.coneInnerAngle,_.coneOuterAngle=u.coneOuterAngle,_.coneOuterGain=u.coneOuterGain,_.distanceModel=u.distanceModel,_.maxDistance=u.maxDistance,_.refDistance=u.refDistance,_.rolloffFactor=u.rolloffFactor,_.panningModel=u.panningModel):(l._pos||(l._pos=e._pos||[0,0,-.5]),t(l,"spatial"))}return e},Sound.prototype.init=function(e){return function(){var r=this,i=r._parent;r._orientation=i._orientation,r._stereo=i._stereo,r._pos=i._pos,r._pannerAttr=i._pannerAttr,e.call(this),r._stereo?i.stereo(r._stereo):r._pos&&i.pos(r._pos[0],r._pos[1],r._pos[2],r._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var r=this,i=r._parent;return r._orientation=i._orientation,r._stereo=i._stereo,r._pos=i._pos,r._pannerAttr=i._pannerAttr,r._stereo?i.stereo(r._stereo):r._pos?i.pos(r._pos[0],r._pos[1],r._pos[2],r._id):r._panner&&(r._panner.disconnect(0),r._panner=void 0,i._refreshBuffer(r)),e.call(this)}}(Sound.prototype.reset);var t=function(e,r){r=r||"spatial",r==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()})(jt);var Qt=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const Yt=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...e)=>Qt(void 0,void 0,void 0,function*(){return yield(yield $e(()=>Promise.resolve().then(()=>je),void 0,import.meta.url)).fetch(...e)}):t=fetch,(...e)=>t(...e)};class et extends Error{constructor(t,e="FunctionsError",r){super(t),super.name=e,this.context=r}}class Zt extends et{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class er extends et{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class tr extends et{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var rr=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};class nr{constructor(t,{headers:e={},customFetch:r}={}){this.url=t,this.headers=e,this.fetch=Yt(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,e={}){var r;return rr(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:l}=e;let h={},d;l&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",d=l):typeof l=="string"?(h["Content-Type"]="text/plain",d=l):typeof FormData<"u"&&l instanceof FormData?d=l:(h["Content-Type"]="application/json",d=JSON.stringify(l)));const u=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),i),body:d}).catch(c=>{throw new Zt(c)}),_=u.headers.get("x-relay-error");if(_&&_==="true")throw new er(u);if(!u.ok)throw new tr(u);let n=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),o;return n==="application/json"?o=yield u.json():n==="application/octet-stream"?o=yield u.blob():n==="multipart/form-data"?o=yield u.formData():o=yield u.text(),{data:o,error:null}}catch(i){return{data:null,error:i}}})}}var Je={exports:{}};(function(a,t){var e=typeof self<"u"?self:me,r=function(){function s(){this.fetch=!1,this.DOMException=e.DOMException}return s.prototype=e,new s}();(function(s){(function(l){var h={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function d(v){return v&&DataView.prototype.isPrototypeOf(v)}if(h.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=ArrayBuffer.isView||function(v){return v&&u.indexOf(Object.prototype.toString.call(v))>-1};function n(v){if(typeof v!="string"&&(v=String(v)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(v))throw new TypeError("Invalid character in header field name");return v.toLowerCase()}function o(v){return typeof v!="string"&&(v=String(v)),v}function c(v){var g={next:function(){var k=v.shift();return{done:k===void 0,value:k}}};return h.iterable&&(g[Symbol.iterator]=function(){return g}),g}function f(v){this.map={},v instanceof f?v.forEach(function(g,k){this.append(k,g)},this):Array.isArray(v)?v.forEach(function(g){this.append(g[0],g[1])},this):v&&Object.getOwnPropertyNames(v).forEach(function(g){this.append(g,v[g])},this)}f.prototype.append=function(v,g){v=n(v),g=o(g);var k=this.map[v];this.map[v]=k?k+", "+g:g},f.prototype.delete=function(v){delete this.map[n(v)]},f.prototype.get=function(v){return v=n(v),this.has(v)?this.map[v]:null},f.prototype.has=function(v){return this.map.hasOwnProperty(n(v))},f.prototype.set=function(v,g){this.map[n(v)]=o(g)},f.prototype.forEach=function(v,g){for(var k in this.map)this.map.hasOwnProperty(k)&&v.call(g,this.map[k],k,this)},f.prototype.keys=function(){var v=[];return this.forEach(function(g,k){v.push(k)}),c(v)},f.prototype.values=function(){var v=[];return this.forEach(function(g){v.push(g)}),c(v)},f.prototype.entries=function(){var v=[];return this.forEach(function(g,k){v.push([k,g])}),c(v)},h.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);function m(v){if(v.bodyUsed)return Promise.reject(new TypeError("Already read"));v.bodyUsed=!0}function y(v){return new Promise(function(g,k){v.onload=function(){g(v.result)},v.onerror=function(){k(v.error)}})}function p(v){var g=new FileReader,k=y(g);return g.readAsArrayBuffer(v),k}function b(v){var g=new FileReader,k=y(g);return g.readAsText(v),k}function T(v){for(var g=new Uint8Array(v),k=new Array(g.length),N=0;N<g.length;N++)k[N]=String.fromCharCode(g[N]);return k.join("")}function S(v){if(v.slice)return v.slice(0);var g=new Uint8Array(v.byteLength);return g.set(new Uint8Array(v)),g.buffer}function R(){return this.bodyUsed=!1,this._initBody=function(v){this._bodyInit=v,v?typeof v=="string"?this._bodyText=v:h.blob&&Blob.prototype.isPrototypeOf(v)?this._bodyBlob=v:h.formData&&FormData.prototype.isPrototypeOf(v)?this._bodyFormData=v:h.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)?this._bodyText=v.toString():h.arrayBuffer&&h.blob&&d(v)?(this._bodyArrayBuffer=S(v.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):h.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(v)||_(v))?this._bodyArrayBuffer=S(v):this._bodyText=v=Object.prototype.toString.call(v):this._bodyText="",this.headers.get("content-type")||(typeof v=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):h.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},h.blob&&(this.blob=function(){var v=m(this);if(v)return v;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?m(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var v=m(this);if(v)return v;if(this._bodyBlob)return b(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(T(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},h.formData&&(this.formData=function(){return this.text().then(P)}),this.json=function(){return this.text().then(JSON.parse)},this}var U=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function M(v){var g=v.toUpperCase();return U.indexOf(g)>-1?g:v}function $(v,g){g=g||{};var k=g.body;if(v instanceof $){if(v.bodyUsed)throw new TypeError("Already read");this.url=v.url,this.credentials=v.credentials,g.headers||(this.headers=new f(v.headers)),this.method=v.method,this.mode=v.mode,this.signal=v.signal,!k&&v._bodyInit!=null&&(k=v._bodyInit,v.bodyUsed=!0)}else this.url=String(v);if(this.credentials=g.credentials||this.credentials||"same-origin",(g.headers||!this.headers)&&(this.headers=new f(g.headers)),this.method=M(g.method||this.method||"GET"),this.mode=g.mode||this.mode||null,this.signal=g.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&k)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(k)}$.prototype.clone=function(){return new $(this,{body:this._bodyInit})};function P(v){var g=new FormData;return v.trim().split("&").forEach(function(k){if(k){var N=k.split("="),H=N.shift().replace(/\+/g," "),C=N.join("=").replace(/\+/g," ");g.append(decodeURIComponent(H),decodeURIComponent(C))}}),g}function q(v){var g=new f,k=v.replace(/\r?\n[\t ]+/g," ");return k.split(/\r?\n/).forEach(function(N){var H=N.split(":"),C=H.shift().trim();if(C){var ce=H.join(":").trim();g.append(C,ce)}}),g}R.call($.prototype);function L(v,g){g||(g={}),this.type="default",this.status=g.status===void 0?200:g.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in g?g.statusText:"OK",this.headers=new f(g.headers),this.url=g.url||"",this._initBody(v)}R.call(L.prototype),L.prototype.clone=function(){return new L(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},L.error=function(){var v=new L(null,{status:0,statusText:""});return v.type="error",v};var X=[301,302,303,307,308];L.redirect=function(v,g){if(X.indexOf(g)===-1)throw new RangeError("Invalid status code");return new L(null,{status:g,headers:{location:v}})},l.DOMException=s.DOMException;try{new l.DOMException}catch{l.DOMException=function(g,k){this.message=g,this.name=k;var N=Error(g);this.stack=N.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function Q(v,g){return new Promise(function(k,N){var H=new $(v,g);if(H.signal&&H.signal.aborted)return N(new l.DOMException("Aborted","AbortError"));var C=new XMLHttpRequest;function ce(){C.abort()}C.onload=function(){var re={status:C.status,statusText:C.statusText,headers:q(C.getAllResponseHeaders()||"")};re.url="responseURL"in C?C.responseURL:re.headers.get("X-Request-URL");var ne="response"in C?C.response:C.responseText;k(new L(ne,re))},C.onerror=function(){N(new TypeError("Network request failed"))},C.ontimeout=function(){N(new TypeError("Network request failed"))},C.onabort=function(){N(new l.DOMException("Aborted","AbortError"))},C.open(H.method,H.url,!0),H.credentials==="include"?C.withCredentials=!0:H.credentials==="omit"&&(C.withCredentials=!1),"responseType"in C&&h.blob&&(C.responseType="blob"),H.headers.forEach(function(re,ne){C.setRequestHeader(ne,re)}),H.signal&&(H.signal.addEventListener("abort",ce),C.onreadystatechange=function(){C.readyState===4&&H.signal.removeEventListener("abort",ce)}),C.send(typeof H._bodyInit>"u"?null:H._bodyInit)})}return Q.polyfill=!0,s.fetch||(s.fetch=Q,s.Headers=f,s.Request=$,s.Response=L),l.Headers=f,l.Request=$,l.Response=L,l.fetch=Q,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;t=i.fetch,t.default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,a.exports=t})(Je,Je.exports);var tt=Je.exports;const rt=Xt(tt),je=zt({__proto__:null,default:rt},[tt]);class ir{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.allowEmpty=t.allowEmpty,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=rt:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(t,e){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var l,h,d;let u=null,_=null,n=null,o=s.status,c=s.statusText;if(s.ok){if(this.method!=="HEAD"){const p=await s.text();p===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?_=p:_=JSON.parse(p))}const m=(l=this.headers.Prefer)===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),y=(h=s.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");m&&y&&y.length>1&&(n=parseInt(y[1]))}else{const m=await s.text();try{u=JSON.parse(m),Array.isArray(u)&&s.status===404&&(_=[],u=null,o=200,c="OK")}catch{s.status===404&&m===""?(o=204,c="No Content"):u={message:m}}if(u&&this.allowEmpty&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("Results contain 0 rows"))&&(u=null,o=200,c="OK"),u&&this.shouldThrowOnError)throw u}return{error:u,data:_,count:n,status:o,statusText:c}});return this.shouldThrowOnError||(i=i.catch(s=>{var l,h,d;return{error:{message:`${(l=s==null?void 0:s.name)!==null&&l!==void 0?l:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(h=s==null?void 0:s.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=s==null?void 0:s.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,e)}}class sr extends ir{select(t){let e=!1;const r=(t??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:i}={}){const s=i?`${i}.order`:"order",l=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${l?`${l},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e}={}){const r=typeof e>"u"?"limit":`${e}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,e,{foreignTable:r}={}){const i=typeof r>"u"?"offset":`${r}.offset`,s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.headers.Accept="application/vnd.pgrst.object+json",this.allowEmpty=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:i=!1,wal:s=!1,format:l="text"}={}){const h=[t?"analyze":null,e?"verbose":null,r?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),d=this.headers.Accept;return this.headers.Accept=`application/vnd.pgrst.plan+${l}; for="${d}"; options=${h};`,l==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class ye extends sr{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){const r=e.map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const l=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${s}fts${l}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e}={}){const r=e?`${e}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}}class or{constructor(t,{headers:e={},schema:r,fetch:i}){this.url=t,this.headers=e,this.schema=r,this.fetch=i}select(t,{head:e=!1,count:r}={}){const i=e?"HEAD":"GET";let s=!1;const l=(t??"*").split("").map(h=>/\s/.test(h)&&!s?"":(h==='"'&&(s=!s),h)).join("");return this.url.searchParams.set("select",l),r&&(this.headers.Prefer=`count=${r}`),new ye({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:e,defaultToNull:r=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),e&&s.push(`count=${e}`),r||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const l=t.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(l.length>0){const h=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new ye({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:i,defaultToNull:s=!0}={}){const l="POST",h=[`resolution=${r?"ignore":"merge"}-duplicates`];if(e!==void 0&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&h.push(this.headers.Prefer),i&&h.push(`count=${i}`),s||h.push("missing=default"),this.headers.Prefer=h.join(","),Array.isArray(t)){const d=t.reduce((u,_)=>u.concat(Object.keys(_)),[]);if(d.length>0){const u=[...new Set(d)].map(_=>`"${_}"`);this.url.searchParams.set("columns",u.join(","))}}return new ye({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:e}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),e&&i.push(`count=${e}`),this.headers.Prefer=i.join(","),new ye({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const e="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new ye({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const ar="1.6.0",lr={"X-Client-Info":`postgrest-js/${ar}`};class cr{constructor(t,{headers:e={},schema:r,fetch:i}={}){this.url=t,this.headers=Object.assign(Object.assign({},lr),e),this.schema=r,this.fetch=i}from(t){const e=new URL(`${this.url}/${t}`);return new or(e,{headers:Object.assign({},this.headers),schema:this.schema,fetch:this.fetch})}rpc(t,e={},{head:r=!1,count:i}={}){let s;const l=new URL(`${this.url}/rpc/${t}`);let h;r?(s="HEAD",Object.entries(e).forEach(([u,_])=>{l.searchParams.append(u,`${_}`)})):(s="POST",h=e);const d=Object.assign({},this.headers);return i&&(d.Prefer=`count=${i}`),new ye({method:s,url:l,headers:d,schema:this.schema,body:h,fetch:this.fetch,allowEmpty:!1})}}var Fe,yt;function ur(){if(yt)return Fe;yt=1;var a=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return Fe=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return a()}try{return __global__||a()}finally{delete Object.prototype.__global__}}(),Fe}const dr="websocket",hr="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",fr=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],_r="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",pr=["Iaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],vr="1.0.34",mr={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},yr="https://github.com/theturtle32/WebSocket-Node",gr={node:">=4.0.0"},br={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},wr={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},Tr={verbose:!1},Ar={test:"tape test/unit/*.js",gulp:"gulp"},Sr="index",kr={lib:"./lib"},Er="lib/browser.js",Or="Apache-2.0",xr={name:dr,description:hr,keywords:fr,author:_r,contributors:pr,version:vr,repository:mr,homepage:yr,engines:gr,dependencies:br,devDependencies:wr,config:Tr,scripts:Ar,main:Sr,directories:kr,browser:Er,license:Or};var Ir=xr.version,he;if(typeof globalThis=="object")he=globalThis;else try{he=ur()}catch{}finally{if(!he&&typeof window<"u"&&(he=window),!he)throw new Error("Could not determine global this")}var ke=he.WebSocket||he.MozWebSocket,Pr=Ir;function Rt(a,t){var e;return t?e=new ke(a,t):e=new ke(a),e}ke&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(a){Object.defineProperty(Rt,a,{get:function(){return ke[a]}})});var $r={w3cwebsocket:ke?Rt:null,version:Pr};const jr="2.7.2",Rr={"X-Client-Info":`realtime-js/${jr}`},Cr="1.0.0",Ct=1e4,Dr=1e3;var Ae;(function(a){a[a.connecting=0]="connecting",a[a.open=1]="open",a[a.closing=2]="closing",a[a.closed=3]="closed"})(Ae||(Ae={}));var W;(function(a){a.closed="closed",a.errored="errored",a.joined="joined",a.joining="joining",a.leaving="leaving"})(W||(W={}));var Z;(function(a){a.close="phx_close",a.error="phx_error",a.join="phx_join",a.reply="phx_reply",a.leave="phx_leave",a.access_token="access_token"})(Z||(Z={}));var Ke;(function(a){a.websocket="websocket"})(Ke||(Ke={}));var fe;(function(a){a.Connecting="connecting",a.Open="open",a.Closing="closing",a.Closed="closed"})(fe||(fe={}));class Dt{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class Lr{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const e=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,e,r)}_decodeBroadcast(t,e,r){const i=e.getUint8(1),s=e.getUint8(2);let l=this.HEADER_LENGTH+2;const h=r.decode(t.slice(l,l+i));l=l+i;const d=r.decode(t.slice(l,l+s));l=l+s;const u=JSON.parse(r.decode(t.slice(l,t.byteLength)));return{ref:null,topic:h,event:d,payload:u}}}class Be{constructor(t,e,r={},i=Ct){this.channel=t,this.event=e,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null,this.rateLimited=!1}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){if(this._hasReceived("timeout"))return;this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()})==="rate limited"&&(this.rateLimited=!0)}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var r;return this._hasReceived(t)&&e((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var gt;(function(a){a.SYNC="sync",a.JOIN="join",a.LEAVE="leave"})(gt||(gt={}));class Se{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(e==null?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:s,onLeave:l,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Se.syncState(this.state,i,s,l),this.pendingDiffs.forEach(d=>{this.state=Se.syncDiff(this.state,d,s,l)}),this.pendingDiffs=[],h()}),this.channel._on(r.diff,{},i=>{const{onJoin:s,onLeave:l,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Se.syncDiff(this.state,i,s,l),h())}),this.onJoin((i,s,l)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:l})}),this.onLeave((i,s,l)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,r,i){const s=this.cloneDeep(t),l=this.transformState(e),h={},d={};return this.map(s,(u,_)=>{l[u]||(d[u]=_)}),this.map(l,(u,_)=>{const n=s[u];if(n){const o=_.map(y=>y.presence_ref),c=n.map(y=>y.presence_ref),f=_.filter(y=>c.indexOf(y.presence_ref)<0),m=n.filter(y=>o.indexOf(y.presence_ref)<0);f.length>0&&(h[u]=f),m.length>0&&(d[u]=m)}else h[u]=_}),this.syncDiff(s,{joins:h,leaves:d},r,i)}static syncDiff(t,e,r,i){const{joins:s,leaves:l}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(h,d)=>{var u;const _=(u=t[h])!==null&&u!==void 0?u:[];if(t[h]=this.cloneDeep(d),_.length>0){const n=t[h].map(c=>c.presence_ref),o=_.filter(c=>n.indexOf(c.presence_ref)<0);t[h].unshift(...o)}r(h,_,d)}),this.map(l,(h,d)=>{let u=t[h];if(!u)return;const _=d.map(n=>n.presence_ref);u=u.filter(n=>_.indexOf(n.presence_ref)<0),t[h]=u,i(h,u,d),u.length===0&&delete t[h]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(r=>e(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,r)=>{const i=t[r];return"metas"in i?e[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):e[r]=i,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var B;(function(a){a.abstime="abstime",a.bool="bool",a.date="date",a.daterange="daterange",a.float4="float4",a.float8="float8",a.int2="int2",a.int4="int4",a.int4range="int4range",a.int8="int8",a.int8range="int8range",a.json="json",a.jsonb="jsonb",a.money="money",a.numeric="numeric",a.oid="oid",a.reltime="reltime",a.text="text",a.time="time",a.timestamp="timestamp",a.timestamptz="timestamptz",a.timetz="timetz",a.tsrange="tsrange",a.tstzrange="tstzrange"})(B||(B={}));const bt=(a,t,e={})=>{var r;const i=(r=e.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((s,l)=>(s[l]=Fr(l,a,t,i),s),{})},Fr=(a,t,e,r)=>{const i=t.find(h=>h.name===a),s=i==null?void 0:i.type,l=e[a];return s&&!r.includes(s)?Lt(s,l):We(l)},Lt=(a,t)=>{if(a.charAt(0)==="_"){const e=a.slice(1,a.length);return Hr(t,e)}switch(a){case B.bool:return Br(t);case B.float4:case B.float8:case B.int2:case B.int4:case B.int8:case B.numeric:case B.oid:return Ur(t);case B.json:case B.jsonb:return Mr(t);case B.timestamp:return Nr(t);case B.abstime:case B.date:case B.daterange:case B.int4range:case B.int8range:case B.money:case B.reltime:case B.text:case B.time:case B.timestamptz:case B.timetz:case B.tsrange:case B.tstzrange:return We(t);default:return We(t)}},We=a=>a,Br=a=>{switch(a){case"t":return!0;case"f":return!1;default:return a}},Ur=a=>{if(typeof a=="string"){const t=parseFloat(a);if(!Number.isNaN(t))return t}return a},Mr=a=>{if(typeof a=="string")try{return JSON.parse(a)}catch(t){return console.log(`JSON parse error: ${t}`),a}return a},Hr=(a,t)=>{if(typeof a!="string")return a;const e=a.length-1,r=a[e];if(a[0]==="{"&&r==="}"){let s;const l=a.slice(1,e);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(h=>Lt(t,h))}return a},Nr=a=>typeof a=="string"?a.replace(" ","T"):a;var wt=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})},Tt;(function(a){a.ALL="*",a.INSERT="INSERT",a.UPDATE="UPDATE",a.DELETE="DELETE"})(Tt||(Tt={}));var At;(function(a){a.BROADCAST="broadcast",a.PRESENCE="presence",a.POSTGRES_CHANGES="postgres_changes"})(At||(At={}));var St;(function(a){a.SUBSCRIBED="SUBSCRIBED",a.TIMED_OUT="TIMED_OUT",a.CLOSED="CLOSED",a.CHANNEL_ERROR="CHANNEL_ERROR"})(St||(St={}));class nt{constructor(t,e={config:{}},r){this.topic=t,this.params=e,this.socket=r,this.bindings={},this.state=W.closed,this.joinedOnce=!1,this.pushBuffer=[],this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},e.config),this.timeout=this.socket.timeout,this.joinPush=new Be(this,Z.join,this.params,this.timeout),this.rejoinTimer=new Dt(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=W.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=W.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=W.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=W.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Z.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new Se(this)}subscribe(t,e=this.timeout){var r,i;if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:l}}=this.params;this._onError(u=>t&&t("CHANNEL_ERROR",u)),this._onClose(()=>t&&t("CLOSED"));const h={},d={broadcast:s,presence:l,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&i!==void 0?i:[]};this.socket.accessToken&&(h.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:d},h)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",({postgres_changes:u})=>{var _;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){t&&t("SUBSCRIBED");return}else{const n=this.bindings.postgres_changes,o=(_=n==null?void 0:n.length)!==null&&_!==void 0?_:0,c=[];for(let f=0;f<o;f++){const m=n[f],{filter:{event:y,schema:p,table:b,filter:T}}=m,S=u&&u[f];if(S&&S.event===y&&S.schema===p&&S.table===b&&S.filter===T)c.push(Object.assign(Object.assign({},m),{id:S.id}));else{this.unsubscribe(),t&&t("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=c,t&&t("SUBSCRIBED");return}}).receive("error",u=>{t&&t("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t&&t("TIMED_OUT")})}return this}presenceState(){return this.presence.state}track(t,e={}){return wt(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)})}untrack(t={}){return wt(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,e,r){return this._on(t,e,r)}send(t,e={}){return new Promise(r=>{var i,s,l;const h=this._push(t.type,t,e.timeout||this.timeout);h.rateLimited&&r("rate limited"),t.type==="broadcast"&&!(!((l=(s=(i=this.params)===null||i===void 0?void 0:i.config)===null||s===void 0?void 0:s.broadcast)===null||l===void 0)&&l.ack)&&r("ok"),h.receive("ok",()=>r("ok")),h.receive("timeout",()=>r("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=W.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Z.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const i=new Be(this,Z.leave,{},t);i.receive("ok",()=>{e(),r("ok")}).receive("timeout",()=>{e(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}_push(t,e,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Be(this,t,e,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,e,r){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,r){var i,s;const l=t.toLocaleLowerCase(),{close:h,error:d,leave:u,join:_}=Z;if(r&&[h,d,u,_].indexOf(l)>=0&&r!==this._joinRef())return;let o=this._onMessage(l,e,r);if(e&&!o)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(c=>{var f,m,y;return((f=c.filter)===null||f===void 0?void 0:f.event)==="*"||((y=(m=c.filter)===null||m===void 0?void 0:m.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===l}).map(c=>c.callback(o,r)):(s=this.bindings[l])===null||s===void 0||s.filter(c=>{var f,m,y,p,b,T;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in c){const S=c.id,R=(f=c.filter)===null||f===void 0?void 0:f.event;return S&&((m=e.ids)===null||m===void 0?void 0:m.includes(S))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===((y=e.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const S=(b=(p=c==null?void 0:c.filter)===null||p===void 0?void 0:p.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return S==="*"||S===((T=e==null?void 0:e.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return c.type.toLocaleLowerCase()===l}).map(c=>{if(typeof o=="object"&&"ids"in o){const f=o.data,{schema:m,table:y,commit_timestamp:p,type:b,errors:T}=f;o=Object.assign(Object.assign({},{schema:m,table:y,commit_timestamp:p,eventType:b,new:{},old:{},errors:T}),this._getPayloadRecords(f))}c.callback(o,r)})}_isClosed(){return this.state===W.closed}_isJoined(){return this.state===W.joined}_isJoining(){return this.state===W.joining}_isLeaving(){return this.state===W.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,r){const i=t.toLocaleLowerCase(),s={type:i,filter:e,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,e){const r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&nt.isEqual(i.filter,e))}),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Z.close,{},t)}_onError(t){this._on(Z.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=W.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=bt(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=bt(t.columns,t.old_record)),e}}var Ue=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const Gr=()=>{};class Vr{constructor(t,e){var r;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=Rr,this.params={},this.timeout=Ct,this.transport=$r.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Gr,this.conn=null,this.sendBuffer=[],this.serializer=new Lr,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.eventsPerSecondLimitMs=100,this.inThrottle=!1,this.endPoint=`${t}/${Ke.websocket}`,e!=null&&e.params&&(this.params=e.params),e!=null&&e.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e!=null&&e.timeout&&(this.timeout=e.timeout),e!=null&&e.logger&&(this.logger=e.logger),e!=null&&e.transport&&(this.transport=e.transport),e!=null&&e.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);const i=(r=e==null?void 0:e.params)===null||r===void 0?void 0:r.eventsPerSecond;i&&(this.eventsPerSecondLimitMs=Math.floor(1e3/i)),this.reconnectAfterMs=e!=null&&e.reconnectAfterMs?e.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=e!=null&&e.encode?e.encode:(s,l)=>l(JSON.stringify(s)),this.decode=e!=null&&e.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Dt(()=>Ue(this,void 0,void 0,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t)))}disconnect(t,e){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(t){return Ue(this,void 0,void 0,function*(){const e=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),e})}removeAllChannels(){return Ue(this,void 0,void 0,function*(){const t=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),t})}log(t,e,r){this.logger(t,e,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ae.connecting:return fe.Connecting;case Ae.open:return fe.Open;case Ae.closing:return fe.Closing;default:return fe.Closed}}isConnected(){return this.connectionState()===fe.Open}channel(t,e={config:{}}){this.isConnected()||this.connect();const r=new nt(`realtime:${t}`,e,this);return this.channels.push(r),r}push(t){const{topic:e,event:r,payload:i,ref:s}=t;let l=()=>{this.encode(t,h=>{var d;(d=this.conn)===null||d===void 0||d.send(h)})};if(this.log("push",`${e} ${r} (${s})`,i),this.isConnected())if(["broadcast","presence","postgres_changes"].includes(r)){if(this._throttle(l)())return"rate limited"}else l();else this.sendBuffer.push(l)}setAuth(t){this.accessToken=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(Z.access_token,{access_token:t})})}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e._joinRef()!==t._joinRef())}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Cr}))}_onConnMessage(t){this.decode(t.data,e=>{let{topic:r,event:i,payload:s,ref:l}=e;(l&&l===this.pendingHeartbeatRef||i===(s==null?void 0:s.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${i} ${l&&"("+l+")"||""}`,s),this.channels.filter(h=>h._isMember(r)).forEach(h=>h._trigger(i,s,l)),this.stateChangeCallbacks.message.forEach(h=>h(e))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Z.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;const r=t.match(/\?/)?"&":"?",i=new URLSearchParams(e);return`${t}${r}${i}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(Dr,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_throttle(t,e=this.eventsPerSecondLimitMs){return()=>this.inThrottle?!0:(t(),e>0&&(this.inThrottle=!0,setTimeout(()=>{this.inThrottle=!1},e)),!1)}}class it extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function J(a){return typeof a=="object"&&a!==null&&"__isStorageError"in a}class qr extends it{constructor(t,e){super(t),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class kt extends it{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}var Ft=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const Bt=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...e)=>Ft(void 0,void 0,void 0,function*(){return yield(yield $e(()=>Promise.resolve().then(()=>je),void 0,import.meta.url)).fetch(...e)}):t=fetch,(...e)=>t(...e)},Jr=()=>Ft(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield $e(()=>Promise.resolve().then(()=>je),void 0,import.meta.url)).Response:Response});var ge=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const Me=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),Kr=(a,t)=>ge(void 0,void 0,void 0,function*(){const e=yield Jr();a instanceof e?a.json().then(r=>{t(new qr(Me(r),a.status||500))}).catch(r=>{t(new kt(Me(r),r))}):t(new kt(Me(a),a))}),Wr=(a,t,e,r)=>{const i={method:a,headers:(t==null?void 0:t.headers)||{}};return a==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),e))};function Re(a,t,e,r,i,s){return ge(this,void 0,void 0,function*(){return new Promise((l,h)=>{a(e,Wr(t,r,i,s)).then(d=>{if(!d.ok)throw d;return r!=null&&r.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>Kr(d,h))})})}function ze(a,t,e,r){return ge(this,void 0,void 0,function*(){return Re(a,"GET",t,e,r)})}function oe(a,t,e,r,i){return ge(this,void 0,void 0,function*(){return Re(a,"POST",t,r,i,e)})}function zr(a,t,e,r,i){return ge(this,void 0,void 0,function*(){return Re(a,"PUT",t,r,i,e)})}function Ut(a,t,e,r,i){return ge(this,void 0,void 0,function*(){return Re(a,"DELETE",t,r,i,e)})}var Y=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const Xr={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Et={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Qr{constructor(t,e={},r,i){this.url=t,this.headers=e,this.bucketId=r,this.fetch=Bt(i)}uploadOrUpdate(t,e,r,i){return Y(this,void 0,void 0,function*(){try{let s;const l=Object.assign(Object.assign({},Et),i),h=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",l.cacheControl)):(s=r,h["cache-control"]=`max-age=${l.cacheControl}`,h["content-type"]=l.contentType);const d=this._removeEmptyFolders(e),u=this._getFinalPath(d),_=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:s,headers:h},l!=null&&l.duplex?{duplex:l.duplex}:{}));return _.ok?{data:{path:d},error:null}:{data:null,error:yield _.json()}}catch(s){if(J(s))return{data:null,error:s};throw s}})}upload(t,e,r){return Y(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,r)})}uploadToSignedUrl(t,e,r,i){return Y(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),l=this._getFinalPath(s),h=new URL(this.url+`/object/upload/sign/${l}`);h.searchParams.set("token",e);try{let d;const u=Object.assign({upsert:Et.upsert},i),_=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",u.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",u.cacheControl)):(d=r,_["cache-control"]=`max-age=${u.cacheControl}`,_["content-type"]=u.contentType);const n=yield this.fetch(h.toString(),{method:"PUT",body:d,headers:_});return n.ok?{data:{path:s},error:null}:{data:null,error:yield n.json()}}catch(d){if(J(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(t){return Y(this,void 0,void 0,function*(){try{let e=this._getFinalPath(t);const r=yield oe(this.fetch,`${this.url}/object/upload/sign/${e}`,{},{headers:this.headers}),i=new URL(this.url+r.url),s=i.searchParams.get("token");if(!s)throw new it("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:s},error:null}}catch(e){if(J(e))return{data:null,error:e};throw e}})}update(t,e,r){return Y(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,r)})}move(t,e){return Y(this,void 0,void 0,function*(){try{return{data:yield oe(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e},{headers:this.headers}),error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}})}copy(t,e){return Y(this,void 0,void 0,function*(){try{return{data:{path:(yield oe(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e},{headers:this.headers})).Key},error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}})}createSignedUrl(t,e,r){return Y(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield oe(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:e},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${l}`)},{data:s,error:null}}catch(i){if(J(i))return{data:null,error:i};throw i}})}createSignedUrls(t,e,r){return Y(this,void 0,void 0,function*(){try{const i=yield oe(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${s}`):null})),error:null}}catch(i){if(J(i))return{data:null,error:i};throw i}})}download(t,e){return Y(this,void 0,void 0,function*(){const i=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),l=s?`?${s}`:"";try{const h=this._getFinalPath(t);return{data:yield(yield ze(this.fetch,`${this.url}/${i}/${h}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(h){if(J(h))return{data:null,error:h};throw h}})}getPublicUrl(t,e){const r=this._getFinalPath(t),i=[],s=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&i.push(s);const h=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});d!==""&&i.push(d);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${r}${u}`)}}}remove(t){return Y(this,void 0,void 0,function*(){try{return{data:yield Ut(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(J(e))return{data:null,error:e};throw e}})}list(t,e,r){return Y(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Xr),e),{prefix:t||""});return{data:yield oe(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(J(i))return{data:null,error:i};throw i}})}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const Yr="2.5.1",Zr={"X-Client-Info":`storage-js/${Yr}`};var ve=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};class en{constructor(t,e={},r){this.url=t,this.headers=Object.assign(Object.assign({},Zr),e),this.fetch=Bt(r)}listBuckets(){return ve(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(J(t))return{data:null,error:t};throw t}})}getBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(J(e))return{data:null,error:e};throw e}})}createBucket(t,e={public:!1}){return ve(this,void 0,void 0,function*(){try{return{data:yield oe(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}})}updateBucket(t,e){return ve(this,void 0,void 0,function*(){try{return{data:yield zr(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}})}emptyBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:yield oe(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(J(e))return{data:null,error:e};throw e}})}deleteBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:yield Ut(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(J(e))return{data:null,error:e};throw e}})}}class tn extends en{constructor(t,e={},r){super(t,e,r)}from(t){return new Qr(this.url,this.headers,t,this.fetch)}}const rn="2.21.0",nn={"X-Client-Info":`supabase-js/${rn}`};var sn=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const on=a=>{let t;return a?t=a:typeof fetch>"u"?t=rt:t=fetch,(...e)=>t(...e)},an=()=>typeof Headers>"u"?tt.Headers:Headers,ln=(a,t,e)=>{const r=on(e),i=an();return(s,l)=>sn(void 0,void 0,void 0,function*(){var h;const d=(h=yield t())!==null&&h!==void 0?h:a;let u=new i(l==null?void 0:l.headers);return u.has("apikey")||u.set("apikey",a),u.has("Authorization")||u.set("Authorization",`Bearer ${d}`),r(s,Object.assign(Object.assign({},l),{headers:u}))})};function cn(a){return a.replace(/\/$/,"")}function un(a,t){const{db:e,auth:r,realtime:i,global:s}=a,{db:l,auth:h,realtime:d,global:u}=t;return{db:Object.assign(Object.assign({},l),e),auth:Object.assign(Object.assign({},h),r),realtime:Object.assign(Object.assign({},d),i),global:Object.assign(Object.assign({},u),s)}}var pe=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};function dn(a){return Math.round(Date.now()/1e3)+a}function hn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){const t=Math.random()*16|0;return(a=="x"?t:t&3|8).toString(16)})}const se=()=>typeof document<"u",ue={tested:!1,writable:!1},He=()=>{if(!se())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ue.tested)return ue.writable;const a=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(a,a),globalThis.localStorage.removeItem(a),ue.tested=!0,ue.writable=!0}catch{ue.tested=!0,ue.writable=!1}return ue.writable};function K(a,t){var e;t||(t=((e=window==null?void 0:window.location)===null||e===void 0?void 0:e.href)||""),a=a.replace(/[\[\]]/g,"\\$&");const r=new RegExp("[?&#]"+a+"(=([^&#]*)|&|#|$)"),i=r.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}const Mt=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...e)=>pe(void 0,void 0,void 0,function*(){return yield(yield $e(()=>Promise.resolve().then(()=>je),void 0,import.meta.url)).fetch(...e)}):t=fetch,(...e)=>t(...e)},fn=a=>typeof a=="object"&&a!==null&&"status"in a&&"ok"in a&&"json"in a&&typeof a.json=="function",be=(a,t,e)=>pe(void 0,void 0,void 0,function*(){yield a.setItem(t,JSON.stringify(e))}),Oe=(a,t)=>pe(void 0,void 0,void 0,function*(){const e=yield a.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}}),Ne=(a,t)=>pe(void 0,void 0,void 0,function*(){yield a.removeItem(t)});function _n(a){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let e="",r,i,s,l,h,d,u,_=0;for(a=a.replace("-","+").replace("_","/");_<a.length;)l=t.indexOf(a.charAt(_++)),h=t.indexOf(a.charAt(_++)),d=t.indexOf(a.charAt(_++)),u=t.indexOf(a.charAt(_++)),r=l<<2|h>>4,i=(h&15)<<4|d>>2,s=(d&3)<<6|u,e=e+String.fromCharCode(r),d!=64&&i!=0&&(e=e+String.fromCharCode(i)),u!=64&&s!=0&&(e=e+String.fromCharCode(s));return e}class Ce{constructor(){this.promise=new Ce.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}Ce.promiseConstructor=Promise;function Ot(a){const t=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,e=a.split(".");if(e.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!t.test(e[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=e[1];return JSON.parse(_n(r))}function pn(a){return new Promise(t=>{setTimeout(()=>t(null),a)})}function vn(a,t){return new Promise((r,i)=>{pe(this,void 0,void 0,function*(){for(let s=0;s<1/0;s++)try{const l=yield a(s);if(!t(s,null,l)){r(l);return}}catch(l){if(!t(s,l)){i(l);return}}})})}function mn(a){return("0"+a.toString(16)).substr(-2)}function xe(){const t=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=e.length;let i="";for(let s=0;s<56;s++)i+=e.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(t),Array.from(t,mn).join("")}function yn(a){return pe(this,void 0,void 0,function*(){const e=new TextEncoder().encode(a),r=yield crypto.subtle.digest("SHA-256",e),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")})}function gn(a){return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function Ie(a){return pe(this,void 0,void 0,function*(){if(typeof crypto>"u")return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),a;const t=yield yn(a);return gn(t)})}class st extends Error{constructor(t,e){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e}}function D(a){return typeof a=="object"&&a!==null&&"__isAuthError"in a}class bn extends st{constructor(t,e){super(t,e),this.name="AuthApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function wn(a){return D(a)&&a.name==="AuthApiError"}class Ht extends st{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class Ee extends st{constructor(t,e,r){super(t),this.name=e,this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class we extends Ee{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class Ge extends Ee{constructor(t){super(t,"AuthInvalidCredentialsError",400)}}class te extends Ee{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ve extends Ee{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Xe extends Ee{constructor(t,e){super(t,"AuthRetryableFetchError",e)}}var ot=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})},Tn=globalThis&&globalThis.__rest||function(a,t){var e={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&t.indexOf(r)<0&&(e[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(a);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(a,r[i])&&(e[r[i]]=a[r[i]]);return e};const Pe=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),An=(a,t)=>ot(void 0,void 0,void 0,function*(){const e=[502,503,504];fn(a)?e.includes(a.status)?t(new Xe(Pe(a),a.status)):a.json().then(r=>{t(new bn(Pe(r),a.status||500))}).catch(r=>{t(new Ht(Pe(r),r))}):t(new Xe(Pe(a),0))}),Sn=(a,t,e,r)=>{const i={method:a,headers:(t==null?void 0:t.headers)||{}};return a==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),e))};function F(a,t,e,r){var i;return ot(this,void 0,void 0,function*(){const s=Object.assign({},r==null?void 0:r.headers);r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const l=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(l.redirect_to=r.redirectTo);const h=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=yield kn(a,t,e+h,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(d):{data:Object.assign({},d),error:null}})}function kn(a,t,e,r,i,s){return ot(this,void 0,void 0,function*(){return new Promise((l,h)=>{a(e,Sn(t,r,i,s)).then(d=>{if(!d.ok)throw d;return r!=null&&r.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>An(d,h))})})}function ie(a){var t;let e=null;In(a)&&(e=Object.assign({},a),e.expires_at=dn(a.expires_in));const r=(t=a.user)!==null&&t!==void 0?t:a;return{data:{session:e,user:r},error:null}}function _e(a){var t;return{data:{user:(t=a.user)!==null&&t!==void 0?t:a},error:null}}function En(a){return{data:a,error:null}}function On(a){const{action_link:t,email_otp:e,hashed_token:r,redirect_to:i,verification_type:s}=a,l=Tn(a,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:t,email_otp:e,hashed_token:r,redirect_to:i,verification_type:s},d=Object.assign({},l);return{data:{properties:h,user:d},error:null}}function xn(a){return a}function In(a){return a.access_token&&a.refresh_token&&a.expires_in}var ee=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})},Pn=globalThis&&globalThis.__rest||function(a,t){var e={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&t.indexOf(r)<0&&(e[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(a);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(a,r[i])&&(e[r[i]]=a[r[i]]);return e};class $n{constructor({url:t="",headers:e={},fetch:r}){this.url=t,this.headers=e,this.fetch=Mt(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(t){return ee(this,void 0,void 0,function*(){try{return yield F(this.fetch,"POST",`${this.url}/logout`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(e){if(D(e))return{data:null,error:e};throw e}})}inviteUserByEmail(t,e={}){return ee(this,void 0,void 0,function*(){try{return yield F(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:_e})}catch(r){if(D(r))return{data:{user:null},error:r};throw r}})}generateLink(t){return ee(this,void 0,void 0,function*(){try{const{options:e}=t,r=Pn(t,["options"]),i=Object.assign(Object.assign({},r),e);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),yield F(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:On,redirectTo:e==null?void 0:e.redirectTo})}catch(e){if(D(e))return{data:{properties:null,user:null},error:e};throw e}})}createUser(t){return ee(this,void 0,void 0,function*(){try{return yield F(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:_e})}catch(e){if(D(e))return{data:{user:null},error:e};throw e}})}listUsers(t){var e,r,i,s,l,h,d;return ee(this,void 0,void 0,function*(){try{const u={nextPage:null,lastPage:0,total:0},_=yield F(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(e=t==null?void 0:t.page)===null||e===void 0?void 0:e.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:xn});if(_.error)throw _.error;const n=yield _.json(),o=(l=_.headers.get("x-total-count"))!==null&&l!==void 0?l:0,c=(d=(h=_.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&d!==void 0?d:[];return c.length>0&&(c.forEach(f=>{const m=parseInt(f.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(f.split(";")[1].split("=")[1]);u[`${y}Page`]=m}),u.total=parseInt(o)),{data:Object.assign(Object.assign({},n),u),error:null}}catch(u){if(D(u))return{data:{users:[]},error:u};throw u}})}getUserById(t){return ee(this,void 0,void 0,function*(){try{return yield F(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:_e})}catch(e){if(D(e))return{data:{user:null},error:e};throw e}})}updateUserById(t,e){return ee(this,void 0,void 0,function*(){try{return yield F(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:_e})}catch(r){if(D(r))return{data:{user:null},error:r};throw r}})}deleteUser(t,e=!1){return ee(this,void 0,void 0,function*(){try{return yield F(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:_e})}catch(r){if(D(r))return{data:{user:null},error:r};throw r}})}_listFactors(t){return ee(this,void 0,void 0,function*(){try{const{data:e,error:r}=yield F(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:e,error:r}}catch(e){if(D(e))return{data:null,error:e};throw e}})}_deleteFactor(t){return ee(this,void 0,void 0,function*(){try{return{data:yield F(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(D(e))return{data:null,error:e};throw e}})}}const jn="2.24.0",Rn="http://localhost:9999",Cn="supabase.auth.token",Dn={"X-Client-Info":`gotrue-js/${jn}`},Ln=10,Fn={getItem:a=>He()?globalThis.localStorage.getItem(a):null,setItem:(a,t)=>{He()&&globalThis.localStorage.setItem(a,t)},removeItem:a=>{He()&&globalThis.localStorage.removeItem(a)}};function Bn(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var O=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};Bn();const Un={url:Rn,storageKey:Cn,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Dn,flowType:"implicit"},qe=30*1e3,Mn=3;class Hn{constructor(t){var e;this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.broadcastChannel=null;const r=Object.assign(Object.assign({},Un),t);if(this.inMemorySession=null,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.persistSession=r.persistSession,this.storage=r.storage||Fn,this.admin=new $n({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Mt(r.fetch),this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},se()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(e=this.broadcastChannel)===null||e===void 0||e.addEventListener("message",i=>{this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}initialize(){return this.initializePromise||(this.initializePromise=this._initialize()),this.initializePromise}_initialize(){return O(this,void 0,void 0,function*(){if(this.initializePromise)return this.initializePromise;try{const t=yield this._isPKCEFlow();if(this.detectSessionInUrl&&this._isImplicitGrantFlow()||t){const{data:e,error:r}=yield this._getSessionFromUrl(t);if(r)return yield this._removeSession(),{error:r};const{session:i,redirectType:s}=e;return yield this._saveSession(i),setTimeout(()=>{s==="recovery"?this._notifyAllSubscribers("PASSWORD_RECOVERY",i):this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(t){return D(t)?{error:t}:{error:new Ht("Unexpected error during initialization",t)}}finally{yield this._handleVisibilityChange()}})}signUp(t){var e,r,i;return O(this,void 0,void 0,function*(){try{yield this._removeSession();let s;if("email"in t){const{email:_,password:n,options:o}=t;let c=null,f=null;if(this.flowType==="pkce"){const m=xe();yield be(this.storage,`${this.storageKey}-code-verifier`,m),c=yield Ie(m),f=m===c?"plain":"s256"}s=yield F(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:o==null?void 0:o.emailRedirectTo,body:{email:_,password:n,data:(e=o==null?void 0:o.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken},code_challenge:c,code_challenge_method:f},xform:ie})}else if("phone"in t){const{phone:_,password:n,options:o}=t;s=yield F(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:n,data:(r=o==null?void 0:o.data)!==null&&r!==void 0?r:{},channel:(i=o==null?void 0:o.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:ie})}else throw new Ge("You must provide either an email or phone number and a password");const{data:l,error:h}=s;if(h||!l)return{data:{user:null,session:null},error:h};const d=l.session,u=l.user;return l.session&&(yield this._saveSession(l.session),this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:u,session:d},error:null}}catch(s){if(D(s))return{data:{user:null,session:null},error:s};throw s}})}signInWithPassword(t){return O(this,void 0,void 0,function*(){try{yield this._removeSession();let e;if("email"in t){const{email:s,password:l,options:h}=t;e=yield F(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ie})}else if("phone"in t){const{phone:s,password:l,options:h}=t;e=yield F(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ie})}else throw new Ge("You must provide either an email or phone number and a password");const{data:r,error:i}=e;return i||!r?{data:{user:null,session:null},error:i}:(r.session&&(yield this._saveSession(r.session),this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:r,error:i})}catch(e){if(D(e))return{data:{user:null,session:null},error:e};throw e}})}signInWithOAuth(t){var e,r,i,s;return O(this,void 0,void 0,function*(){return yield this._removeSession(),yield this._handleProviderSignIn(t.provider,{redirectTo:(e=t.options)===null||e===void 0?void 0:e.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})})}exchangeCodeForSession(t){return O(this,void 0,void 0,function*(){const e=yield Oe(this.storage,`${this.storageKey}-code-verifier`),{data:r,error:i}=yield F(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:e},xform:ie});return yield Ne(this.storage,`${this.storageKey}-code-verifier`),i||!r?{data:{user:null,session:null},error:i}:(r.session&&(yield this._saveSession(r.session),this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:r,error:i})})}signInWithIdToken(t){return O(this,void 0,void 0,function*(){yield this._removeSession();try{const{options:e,provider:r,token:i,nonce:s}=t,l=yield F(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,nonce:s,gotrue_meta_security:{captcha_token:e==null?void 0:e.captchaToken}},xform:ie}),{data:h,error:d}=l;return d||!h?{data:{user:null,session:null},error:d}:(h.session&&(yield this._saveSession(h.session),this._notifyAllSubscribers("SIGNED_IN",h.session)),{data:h,error:d})}catch(e){if(D(e))return{data:{user:null,session:null},error:e};throw e}})}signInWithOtp(t){var e,r,i,s,l;return O(this,void 0,void 0,function*(){try{if(yield this._removeSession(),"email"in t){const{email:h,options:d}=t;let u=null,_=null;if(this.flowType==="pkce"){const o=xe();yield be(this.storage,`${this.storageKey}-code-verifier`,o),u=yield Ie(o),_=o===u?"plain":"s256"}const{error:n}=yield F(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(e=d==null?void 0:d.data)!==null&&e!==void 0?e:{},create_user:(r=d==null?void 0:d.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:u,code_challenge_method:_},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:n}}if("phone"in t){const{phone:h,options:d}=t,{error:u}=yield F(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(i=d==null?void 0:d.data)!==null&&i!==void 0?i:{},create_user:(s=d==null?void 0:d.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(l=d==null?void 0:d.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null},error:u}}throw new Ge("You must provide either an email or phone number.")}catch(h){if(D(h))return{data:{user:null,session:null},error:h};throw h}})}verifyOtp(t){var e,r;return O(this,void 0,void 0,function*(){try{yield this._removeSession();const{data:i,error:s}=yield F(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:(e=t.options)===null||e===void 0?void 0:e.captchaToken}}),redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,xform:ie});if(s)throw s;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,h=i.user;return l!=null&&l.access_token&&(yield this._saveSession(l),this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:h,session:l},error:null}}catch(i){if(D(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithSSO(t){var e,r,i;return O(this,void 0,void 0,function*(){try{return yield this._removeSession(),yield F(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(e=t.options)===null||e===void 0?void 0:e.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0}),headers:this.headers,xform:En})}catch(s){if(D(s))return{data:null,error:s};throw s}})}getSession(){return O(this,void 0,void 0,function*(){yield this.initializePromise;let t=null;if(this.persistSession){const s=yield Oe(this.storage,this.storageKey);s!==null&&(this._isValidSession(s)?t=s:yield this._removeSession())}else t=this.inMemorySession;if(!t)return{data:{session:null},error:null};if(!(t.expires_at?t.expires_at<=Date.now()/1e3:!1))return{data:{session:t},error:null};const{session:r,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:r},error:null}})}getUser(t){var e,r;return O(this,void 0,void 0,function*(){try{if(!t){const{data:i,error:s}=yield this.getSession();if(s)throw s;t=(r=(e=i.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:void 0}return yield F(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:_e})}catch(i){if(D(i))return{data:{user:null},error:i};throw i}})}updateUser(t,e={}){return O(this,void 0,void 0,function*(){try{const{data:r,error:i}=yield this.getSession();if(i)throw i;if(!r.session)throw new we;const s=r.session,{data:l,error:h}=yield F(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e==null?void 0:e.emailRedirectTo,body:t,jwt:s.access_token,xform:_e});if(h)throw h;return s.user=l.user,yield this._saveSession(s),this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}}catch(r){if(D(r))return{data:{user:null},error:r};throw r}})}_decodeJWT(t){return Ot(t)}setSession(t){return O(this,void 0,void 0,function*(){try{if(!t.access_token||!t.refresh_token)throw new we;const e=Date.now()/1e3;let r=e,i=!0,s=null;const l=Ot(t.access_token);if(l.exp&&(r=l.exp,i=r<=e),i){const{session:h,error:d}=yield this._callRefreshToken(t.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!h)return{data:{user:null,session:null},error:null};s=h}else{const{data:h,error:d}=yield this.getUser(t.access_token);if(d)throw d;s={access_token:t.access_token,refresh_token:t.refresh_token,user:h.user,token_type:"bearer",expires_in:r-e,expires_at:r},yield this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(e){if(D(e))return{data:{session:null,user:null},error:e};throw e}})}refreshSession(t){var e;return O(this,void 0,void 0,function*(){try{if(!t){const{data:s,error:l}=yield this.getSession();if(l)throw l;t=(e=s.session)!==null&&e!==void 0?e:void 0}if(!(t!=null&&t.refresh_token))throw new we;const{session:r,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}catch(r){if(D(r))return{data:{user:null,session:null},error:r};throw r}})}_getSessionFromUrl(t){return O(this,void 0,void 0,function*(){try{if(!se())throw new te("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new te("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!t)throw new Ve("Not a valid PKCE flow url.");if(t){const y=K("code");if(!y)throw new Ve("No code detected.");const{data:p,error:b}=yield this.exchangeCodeForSession(y);if(b)throw b;if(!p.session)throw new Ve("No session detected.");return{data:{session:p.session,redirectType:null},error:null}}const e=K("error_description");if(e){const y=K("error_code");if(!y)throw new te("No error_code detected.");const p=K("error");throw p?new te(e,{error:p,code:y}):new te("No error detected.")}const r=K("provider_token"),i=K("provider_refresh_token"),s=K("access_token");if(!s)throw new te("No access_token detected.");const l=K("expires_in");if(!l)throw new te("No expires_in detected.");const h=K("refresh_token");if(!h)throw new te("No refresh_token detected.");const d=K("token_type");if(!d)throw new te("No token_type detected.");const _=Math.round(Date.now()/1e3)+parseInt(l),{data:n,error:o}=yield this.getUser(s);if(o)throw o;const c=n.user,f={provider_token:r,provider_refresh_token:i,access_token:s,expires_in:parseInt(l),expires_at:_,refresh_token:h,token_type:d,user:c},m=K("type");return window.location.hash="",{data:{session:f,redirectType:m},error:null}}catch(e){if(D(e))return{data:{session:null,redirectType:null},error:e};throw e}})}_isImplicitGrantFlow(){return se()&&(!!K("access_token")||!!K("error_description"))}_isPKCEFlow(){return O(this,void 0,void 0,function*(){const t=yield Oe(this.storage,`${this.storageKey}-code-verifier`);return se()&&!!K("code")&&!!t})}signOut(){var t;return O(this,void 0,void 0,function*(){const{data:e,error:r}=yield this.getSession();if(r)return{error:r};const i=(t=e.session)===null||t===void 0?void 0:t.access_token;if(i){const{error:s}=yield this.admin.signOut(i);if(s&&!(wn(s)&&(s.status===404||s.status===401)))return{error:s}}return yield this._removeSession(),yield Ne(this.storage,`${this.storageKey}-code-verifier`),this._notifyAllSubscribers("SIGNED_OUT",null),{error:null}})}onAuthStateChange(t){const e=hn(),r={id:e,callback:t,unsubscribe:()=>{this.stateChangeEmitters.delete(e)}};return this.stateChangeEmitters.set(e,r),this.emitInitialSession(e),{data:{subscription:r}}}emitInitialSession(t){var e,r;return O(this,void 0,void 0,function*(){try{const{data:{session:i},error:s}=yield this.getSession();if(s)throw s;(e=this.stateChangeEmitters.get(t))===null||e===void 0||e.callback("INITIAL_SESSION",i)}catch(i){(r=this.stateChangeEmitters.get(t))===null||r===void 0||r.callback("INITIAL_SESSION",null),console.error(i)}})}resetPasswordForEmail(t,e={}){return O(this,void 0,void 0,function*(){let r=null,i=null;if(this.flowType==="pkce"){const s=xe();yield be(this.storage,`${this.storageKey}-code-verifier`,s),r=yield Ie(s),i=s===r?"plain":"s256"}try{return yield F(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(s){if(D(s))return{data:null,error:s};throw s}})}_refreshAccessToken(t){return O(this,void 0,void 0,function*(){try{const e=Date.now();return yield vn(r=>O(this,void 0,void 0,function*(){return yield pn(r*200),yield F(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ie})}),(r,i,s)=>s&&s.error&&s.error instanceof Xe&&Date.now()+(r+1)*200-e<qe)}catch(e){if(D(e))return{data:{session:null,user:null},error:e};throw e}})}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}_handleProviderSignIn(t,e){return O(this,void 0,void 0,function*(){const r=yield this._getUrlForProvider(t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return se()&&!e.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}})}_recoverAndRefresh(){var t;return O(this,void 0,void 0,function*(){try{const e=yield Oe(this.storage,this.storageKey);if(!this._isValidSession(e)){e!==null&&(yield this._removeSession());return}const r=Math.round(Date.now()/1e3);if(((t=e.expires_at)!==null&&t!==void 0?t:1/0)<r+Ln)if(this.autoRefreshToken&&e.refresh_token){const{error:i}=yield this._callRefreshToken(e.refresh_token);i&&(console.log(i.message),yield this._removeSession())}else yield this._removeSession();else this.persistSession&&(yield this._saveSession(e)),this._notifyAllSubscribers("SIGNED_IN",e)}catch(e){console.error(e);return}})}_callRefreshToken(t){var e,r;return O(this,void 0,void 0,function*(){if(this.refreshingDeferred)return this.refreshingDeferred.promise;try{if(this.refreshingDeferred=new Ce,!t)throw new we;const{data:i,error:s}=yield this._refreshAccessToken(t);if(s)throw s;if(!i.session)throw new we;yield this._saveSession(i.session),this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(D(i)){const s={session:null,error:i};return(e=this.refreshingDeferred)===null||e===void 0||e.resolve(s),s}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null}})}_notifyAllSubscribers(t,e,r=!0){this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:e}),this.stateChangeEmitters.forEach(i=>i.callback(t,e))}_saveSession(t){return O(this,void 0,void 0,function*(){this.persistSession||(this.inMemorySession=t),this.persistSession&&t.expires_at&&(yield this._persistSession(t))})}_persistSession(t){return be(this.storage,this.storageKey,t)}_removeSession(){return O(this,void 0,void 0,function*(){this.persistSession?yield Ne(this.storage,this.storageKey):this.inMemorySession=null})}_removeVisibilityChangedCallback(){const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&se()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(e){console.error("removing visibilitychange callback failed",e)}}_startAutoRefresh(){return O(this,void 0,void 0,function*(){yield this._stopAutoRefresh();const t=setInterval(()=>this._autoRefreshTokenTick(),qe);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),yield this._autoRefreshTokenTick()})}_stopAutoRefresh(){return O(this,void 0,void 0,function*(){const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)})}startAutoRefresh(){return O(this,void 0,void 0,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return O(this,void 0,void 0,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return O(this,void 0,void 0,function*(){const t=Date.now();try{const{data:{session:e}}=yield this.getSession();if(!e||!e.refresh_token||!e.expires_at)return;Math.floor((e.expires_at*1e3-t)/qe)<Mn&&(yield this._callRefreshToken(e.refresh_token))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}})}_handleVisibilityChange(){return O(this,void 0,void 0,function*(){if(!se()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>O(this,void 0,void 0,function*(){return yield this._onVisibilityChanged(!1)}),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})}_onVisibilityChanged(t){return O(this,void 0,void 0,function*(){document.visibilityState==="visible"?(t||(yield this.initializePromise,yield this._recoverAndRefresh()),this.autoRefreshToken&&this._startAutoRefresh()):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(t,e){return O(this,void 0,void 0,function*(){const r=[`provider=${encodeURIComponent(t)}`];if(e!=null&&e.redirectTo&&r.push(`redirect_to=${encodeURIComponent(e.redirectTo)}`),e!=null&&e.scopes&&r.push(`scopes=${encodeURIComponent(e.scopes)}`),this.flowType==="pkce"){const i=xe();yield be(this.storage,`${this.storageKey}-code-verifier`,i);const s=yield Ie(i),l=i===s?"plain":"s256",h=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});r.push(h.toString())}if(e!=null&&e.queryParams){const i=new URLSearchParams(e.queryParams);r.push(i.toString())}return`${this.url}/authorize?${r.join("&")}`})}_unenroll(t){var e;return O(this,void 0,void 0,function*(){try{const{data:r,error:i}=yield this.getSession();return i?{data:null,error:i}:yield F(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(e=r==null?void 0:r.session)===null||e===void 0?void 0:e.access_token})}catch(r){if(D(r))return{data:null,error:r};throw r}})}_enroll(t){var e,r;return O(this,void 0,void 0,function*(){try{const{data:i,error:s}=yield this.getSession();if(s)return{data:null,error:s};const{data:l,error:h}=yield F(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:t.friendlyName,factor_type:t.factorType,issuer:t.issuer},headers:this.headers,jwt:(e=i==null?void 0:i.session)===null||e===void 0?void 0:e.access_token});return h?{data:null,error:h}:(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})}catch(i){if(D(i))return{data:null,error:i};throw i}})}_verify(t){var e;return O(this,void 0,void 0,function*(){try{const{data:r,error:i}=yield this.getSession();if(i)return{data:null,error:i};const{data:s,error:l}=yield F(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(e=r==null?void 0:r.session)===null||e===void 0?void 0:e.access_token});return l?{data:null,error:l}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:l})}catch(r){if(D(r))return{data:null,error:r};throw r}})}_challenge(t){var e;return O(this,void 0,void 0,function*(){try{const{data:r,error:i}=yield this.getSession();return i?{data:null,error:i}:yield F(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{headers:this.headers,jwt:(e=r==null?void 0:r.session)===null||e===void 0?void 0:e.access_token})}catch(r){if(D(r))return{data:null,error:r};throw r}})}_challengeAndVerify(t){return O(this,void 0,void 0,function*(){const{data:e,error:r}=yield this._challenge({factorId:t.factorId});return r?{data:null,error:r}:yield this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})})}_listFactors(){return O(this,void 0,void 0,function*(){const{data:{user:t},error:e}=yield this.getUser();if(e)return{data:null,error:e};const r=(t==null?void 0:t.factors)||[],i=r.filter(s=>s.factor_type==="totp"&&s.status==="verified");return{data:{all:r,totp:i},error:null}})}_getAuthenticatorAssuranceLevel(){var t,e;return O(this,void 0,void 0,function*(){const{data:{session:r},error:i}=yield this.getSession();if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const s=this._decodeJWT(r.access_token);let l=null;s.aal&&(l=s.aal);let h=l;((e=(t=r.user.factors)===null||t===void 0?void 0:t.filter(_=>_.status==="verified"))!==null&&e!==void 0?e:[]).length>0&&(h="aal2");const u=s.amr||[];return{data:{currentLevel:l,nextLevel:h,currentAuthenticationMethods:u},error:null}})}}class Nn extends Hn{constructor(t){super(t)}}var Gn=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const Vn={headers:nn},qn={schema:"public"},Jn={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Kn={};class Wn{constructor(t,e,r){var i,s,l,h,d,u,_,n;if(this.supabaseUrl=t,this.supabaseKey=e,!t)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const o=cn(t);if(this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,o.match(/(supabase\.co)|(supabase\.in)/)){const p=o.split(".");this.functionsUrl=`${p[0]}.functions.${p[1]}.${p[2]}`}else this.functionsUrl=`${o}/functions/v1`;const f=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,m={db:qn,realtime:Kn,auth:Object.assign(Object.assign({},Jn),{storageKey:f}),global:Vn},y=un(r??{},m);this.storageKey=(s=(i=y.auth)===null||i===void 0?void 0:i.storageKey)!==null&&s!==void 0?s:"",this.headers=(h=(l=y.global)===null||l===void 0?void 0:l.headers)!==null&&h!==void 0?h:{},this.auth=this._initSupabaseAuthClient((d=y.auth)!==null&&d!==void 0?d:{},this.headers,(u=y.global)===null||u===void 0?void 0:u.fetch),this.fetch=ln(e,this._getAccessToken.bind(this),(_=y.global)===null||_===void 0?void 0:_.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},y.realtime)),this.rest=new cr(`${o}/rest/v1`,{headers:this.headers,schema:(n=y.db)===null||n===void 0?void 0:n.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new nr(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new tn(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}rpc(t,e={},r){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,e;return Gn(this,void 0,void 0,function*(){const{data:r}=yield this.auth.getSession();return(e=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:i,storageKey:s,flowType:l},h,d){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Nn({url:this.authUrl,headers:Object.assign(Object.assign({},u),h),storageKey:s,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:i,flowType:l,fetch:d})}_initRealtimeClient(t){return new Vr(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,r)=>{this._handleTokenChanged(e,r==null?void 0:r.access_token,"CLIENT")})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==e?(this.realtime.setAuth(e??null),this.changedAccessToken=e):t==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const zn=(a,t,e)=>new Wn(a,t,e),Xn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml6bXRzd2F2c3ZobGlveml3YnN1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODAwNTQwMDMsImV4cCI6MTk5NTYzMDAwM30.gDfwu3GFqh1SDk3vPQqNuHUeL2BRQLr2gE2mab_o-oU",Qn="https://izmtswavsvhlioziwbsu.supabase.co";zn(Qn,Xn);function xt(a){let t,e,r,i,s;return{c(){t=x("div"),e=x("div"),r=x("a"),i=x("img"),this.h()},l(l){t=I(l,"DIV",{class:!0});var h=j(t);e=I(h,"DIV",{tabindex:!0,class:!0});var d=j(e);r=I(d,"A",{href:!0});var u=j(r);i=I(u,"IMG",{src:!0,alt:!0,class:!0}),u.forEach(E),d.forEach(E),h.forEach(E),this.h()},h(){de(i.src,s="/back.png")||w(i,"src",s),w(i,"alt","back button"),w(i,"class","h-6 w-6"),w(r,"href","/library"),w(e,"tabindex","0"),w(e,"class","btn btn-ghost btn-circle"),w(t,"class","flex items-center")},m(l,h){z(l,t,h),A(t,e),A(e,r),A(r,i)},d(l){l&&E(t)}}}function It(a){let t,e;return{c(){t=x("a"),e=ae("Maverick White Reading Software"),this.h()},l(r){t=I(r,"A",{class:!0});var i=j(t);e=le(i,"Maverick White Reading Software"),i.forEach(E),this.h()},h(){w(t,"class","text-2xl pb-1 poppins pt-2 mx-auto")},m(r,i){z(r,t,i),A(t,e)},d(r){r&&E(t)}}}function Pt(a){let t,e,r,i,s,l,h,d,u=a[5]?"Pause":"Start",_,n,o,c,f,m,y,p,b,T,S,R,U,M,$,P,q,L,X,Q;return{c(){t=x("div"),e=G(),r=x("div"),i=x("div"),s=x("a"),l=ae("Stopwatch:"),h=G(),d=x("button"),_=ae(u),n=G(),o=x("button"),c=ae("Reset"),f=G(),m=x("div"),y=x("div"),p=ae(a[4]),b=G(),T=x("div"),S=G(),R=x("div"),U=x("center"),M=x("p"),$=ae("Progress:"),P=G(),q=x("div"),L=x("div"),this.h()},l(v){t=I(v,"DIV",{class:!0}),j(t).forEach(E),e=V(v),r=I(v,"DIV",{class:!0});var g=j(r);i=I(g,"DIV",{});var k=j(i);s=I(k,"A",{class:!0});var N=j(s);l=le(N,"Stopwatch:"),N.forEach(E),h=V(k),d=I(k,"BUTTON",{class:!0});var H=j(d);_=le(H,u),H.forEach(E),n=V(k),o=I(k,"BUTTON",{class:!0});var C=j(o);c=le(C,"Reset"),C.forEach(E),k.forEach(E),f=V(g),m=I(g,"DIV",{class:!0});var ce=j(m);y=I(ce,"DIV",{class:!0});var re=j(y);p=le(re,a[4]),re.forEach(E),ce.forEach(E),g.forEach(E),b=V(v),T=I(v,"DIV",{class:!0}),j(T).forEach(E),S=V(v),R=I(v,"DIV",{class:!0});var ne=j(R);U=I(ne,"CENTER",{});var at=j(U);M=I(at,"P",{class:!0});var lt=j(M);$=le(lt,"Progress:"),lt.forEach(E),at.forEach(E),P=V(ne),q=I(ne,"DIV",{class:!0});var ct=j(q);L=I(ct,"DIV",{class:!0,style:!0}),j(L).forEach(E),ct.forEach(E),ne.forEach(E),this.h()},h(){w(t,"class","divider divider-horizontal"),w(s,"class","poppins text-xl pr-4"),w(d,"class","bg-gray-100 text-black font-bold rounded-full poppins py-2 px-4 rounded timer-button svelte-1vdmm9a"),w(o,"class","bg-gray-100 text-black rounded-full font-bold poppins py-2 px-5 rounded timer-button pr-10 svelte-1vdmm9a"),w(y,"class","text-xl rounded-full font-medium text-center text-black p-3 rounded bg-gray-100"),w(m,"class","pr-1"),w(r,"class","flex items-center gap-2"),w(T,"class","divider divider-horizontal"),w(M,"class","poppins text-base pb-3"),w(L,"class","progress svelte-1vdmm9a"),dt(L,"width",a[6]+"%"),w(q,"class","progress-bar rounded-full svelte-1vdmm9a"),w(R,"class","w-48")},m(v,g){z(v,t,g),z(v,e,g),z(v,r,g),A(r,i),A(i,s),A(s,l),A(i,h),A(i,d),A(d,_),A(i,n),A(i,o),A(o,c),A(r,f),A(r,m),A(m,y),A(y,p),z(v,b,g),z(v,T,g),z(v,S,g),z(v,R,g),A(R,U),A(U,M),A(M,$),A(R,P),A(R,q),A(q,L),X||(Q=[ht(d,"click",a[12]),ht(o,"click",a[10])],X=!0)},p(v,g){g&32&&u!==(u=v[5]?"Pause":"Start")&&ft(_,u),g&16&&ft(p,v[4]),g&64&&dt(L,"width",v[6]+"%")},d(v){v&&E(t),v&&E(e),v&&E(r),v&&E(b),v&&E(T),v&&E(S),v&&E(R),X=!1,Gt(Q)}}}function $t(a){let t,e,r,i;return{c(){t=x("div"),e=x("a"),r=x("img"),this.h()},l(s){t=I(s,"DIV",{class:!0});var l=j(t);e=I(l,"A",{href:!0});var h=j(e);r=I(h,"IMG",{src:!0,alt:!0,class:!0}),h.forEach(E),l.forEach(E),this.h()},h(){de(r.src,i="/profile.png")||w(r,"src",i),w(r,"alt","profile"),w(r,"class","rounded-full"),w(e,"href","/profile"),w(t,"class","avatar w-12 btn btn-ghost btn-circle")},m(s,l){z(s,t,l),A(t,e),A(e,r)},d(s){s&&E(t)}}}function Yn(a){let t,e,r,i,s,l,h=!a[7]&!a[1]&!a[2]&!a[3]&&xt(),d=!a[0]&&It(),u=a[0]&&Pt(a),_=!a[1]&!a[0]&!a[2]&!a[3]&&$t();return{c(){t=x("div"),e=x("div"),r=x("nav"),h&&h.c(),i=G(),d&&d.c(),s=G(),u&&u.c(),l=G(),_&&_.c(),this.h()},l(n){t=I(n,"DIV",{class:!0});var o=j(t);e=I(o,"DIV",{class:!0});var c=j(e);r=I(c,"NAV",{class:!0});var f=j(r);h&&h.l(f),i=V(f),d&&d.l(f),s=V(f),u&&u.l(f),l=V(f),_&&_.l(f),f.forEach(E),c.forEach(E),o.forEach(E),this.h()},h(){w(r,"class","flex justify-between overflow-x-auto"),w(e,"class","container mx-auto px-5 py-2"),w(t,"class","fixed inset-x-0 top-0 z-50 bg-white")},m(n,o){z(n,t,o),A(t,e),A(e,r),h&&h.m(r,null),A(r,i),d&&d.m(r,null),A(r,s),u&&u.m(r,null),A(r,l),_&&_.m(r,null)},p(n,[o]){!n[7]&!n[1]&!n[2]&!n[3]?h||(h=xt(),h.c(),h.m(r,i)):h&&(h.d(1),h=null),n[0]?d&&(d.d(1),d=null):d||(d=It(),d.c(),d.m(r,s)),n[0]?u?u.p(n,o):(u=Pt(n),u.c(),u.m(r,l)):u&&(u.d(1),u=null),!n[1]&!n[0]&!n[2]&!n[3]?_||(_=$t(),_.c(),_.m(r,null)):_&&(_.d(1),_=null)},i:Te,o:Te,d(n){n&&E(t),h&&h.d(),d&&d.d(),u&&u.d(),_&&_.d()}}}function Zn(a,t,e){let r,i;Nt(a,Wt,$=>e(11,i=$));var s,l,h,d;let u,_="0:00",n=!1,o,c=0,f;const m=()=>{f=new jt.Howl({src:"/mixkit-classic-alarm-995.wav"}),f.play()},y=()=>{f.stop()},p=()=>{e(5,n=!0),o=Date.now()-c,u=setInterval(()=>{c=Date.now()-o;const $=Math.floor(c/6e4),P=Math.floor(c%6e4/1e3);e(4,_=`${$}:${P.toString().padStart(2,"0")}`)},1e3)},b=()=>{clearInterval(u),e(5,n=!1),c=Date.now()-o},T=()=>{clearInterval(u),e(5,n=!1),e(4,_="0:00"),c=0};ut(()=>{m(),y()});let S=0;ut(()=>{window.addEventListener("scroll",R),e(6,S=localStorage.getItem("scrollPercentage")||0)});function R(){const $=document.documentElement.scrollTop,P=document.documentElement.scrollHeight-document.documentElement.clientHeight;e(6,S=Math.floor($/P*100)),localStorage.setItem("scrollPercentage",S),U()}function U(){const $=document.getElementById("scrubber");$&&$.value&&S&&($.value=S)}const M=()=>{n?b():p()};return a.$$.update=()=>{a.$$.dirty&2048&&e(0,s=i.url.pathname.indexOf("book/")>0),a.$$.dirty&2048&&i.url.pathname.indexOf("audiobook/")>0,a.$$.dirty&2048&&e(1,l=i.url.pathname=="/"),a.$$.dirty&2048&&e(3,d=i.url.pathname=="/signin"),a.$$.dirty&2048&&e(7,r=i.url.pathname=="/library"),a.$$.dirty&2048&&e(2,h=i.url.pathname.indexOf("setup/")>0)},[s,l,h,d,_,n,S,r,p,b,T,i,M]}class ei extends Qe{constructor(t){super(),Ye(this,t,Zn,Yn,Ze,{})}}function ti(a){let t,e,r,i,s,l,h,d,u,_,n,o,c,f,m,y,p,b,T,S,R,U,M,$,P;return{c(){t=x("footer"),e=x("div"),r=x("img"),s=G(),l=x("a"),h=ae("Maverick White Reading 2023 Beta"),d=G(),u=x("div"),_=x("a"),n=x("img"),c=G(),f=x("a"),m=x("img"),p=G(),b=x("a"),T=x("img"),R=G(),U=x("div"),M=x("a"),$=x("img"),this.h()},l(q){t=I(q,"FOOTER",{class:!0});var L=j(t);e=I(L,"DIV",{class:!0});var X=j(e);r=I(X,"IMG",{src:!0,width:!0}),s=V(X),l=I(X,"A",{class:!0});var Q=j(l);h=le(Q,"Maverick White Reading 2023 Beta"),Q.forEach(E),X.forEach(E),d=V(L),u=I(L,"DIV",{class:!0});var v=j(u);_=I(v,"A",{target:!0,href:!0});var g=j(_);n=I(g,"IMG",{src:!0,class:!0,alt:!0,width:!0}),g.forEach(E),c=V(v),f=I(v,"A",{target:!0,href:!0});var k=j(f);m=I(k,"IMG",{src:!0,class:!0,alt:!0,width:!0}),k.forEach(E),p=V(v),b=I(v,"A",{target:!0,href:!0});var N=j(b);T=I(N,"IMG",{src:!0,class:!0,alt:!0,width:!0}),N.forEach(E),R=V(v),U=I(v,"DIV",{class:!0});var H=j(U);M=I(H,"A",{target:!0,href:!0});var C=j(M);$=I(C,"IMG",{src:!0,class:!0,alt:!0,width:!0}),C.forEach(E),H.forEach(E),v.forEach(E),L.forEach(E),this.h()},h(){de(r.src,i="/blacklogo.png")||w(r,"src",i),w(r,"width","120"),w(l,"class","poppins text-xl text-black"),w(e,"class","items-center grid-flow-col"),de(n.src,o="/youtube.svg")||w(n,"src",o),w(n,"class","btn p-2 btn-square hover:bg-red-400 btn-outline"),w(n,"alt","Youtube"),w(n,"width","60"),w(_,"target","_blank"),w(_,"href","https://www.youtube.com/channel/UCFX6Qz84JDNXvfCegXOq3aA"),de(m.src,y="/mail.png")||w(m,"src",y),w(m,"class","py-3 p-2 btn hover:bg-purple-400 btn-square btn-outline"),w(m,"alt","Contact Us"),w(m,"width","60"),w(f,"target","_blank"),w(f,"href","mailto:maverick.white.books@gmail.com?subject="),de(T.src,S="/merch.png")||w(T,"src",S),w(T,"class","btn p-2 hover:bg-blue-400 btn-square btn-outline"),w(T,"alt","Merch"),w(T,"width","55"),w(b,"target","_blank"),w(b,"href","https://www.zazzle.com/store/maverick_merch/products"),de($.src,P="/donate.png")||w($,"src",P),w($,"class","btn p-2 hover:bg-green-300 btn-square btn-outline"),w($,"alt","Donate"),w($,"width","55"),w(M,"target","_blank"),w(M,"href","https://donate.stripe.com/test_bIYcQI4aK1YGcHCaEJ"),w(U,"class","pr-10 pb-2"),w(u,"class","grid-flow-col gap-4 md:place-self-center md:justify-self-end"),w(t,"class","footer rounded-full items-center bg-white p-4 m-0 mt-40 text-neutral-content")},m(q,L){z(q,t,L),A(t,e),A(e,r),A(e,s),A(e,l),A(l,h),A(t,d),A(t,u),A(u,_),A(_,n),A(u,c),A(u,f),A(f,m),A(u,p),A(u,b),A(b,T),A(u,R),A(u,U),A(U,M),A(M,$)},p:Te,i:Te,o:Te,d(q){q&&E(t)}}}class ri extends Qe{constructor(t){super(),Ye(this,t,null,ti,Ze,{})}}function ni(a){let t,e,r,i,s,l,h,d,u;e=new ei({});const _=a[1].default,n=Vt(_,a,a[0],null);return d=new ri({}),{c(){t=x("div"),_t(e.$$.fragment),r=G(),i=x("div"),s=ae(""),l=G(),n&&n.c(),h=G(),_t(d.$$.fragment),this.h()},l(o){t=I(o,"DIV",{class:!0});var c=j(t);pt(e.$$.fragment,c),r=V(c),i=I(c,"DIV",{class:!0});var f=j(i);s=le(f,""),f.forEach(E),l=V(c),n&&n.l(c),h=V(c),pt(d.$$.fragment,c),c.forEach(E),this.h()},h(){w(i,"class","h-20"),w(t,"class","max-w-screen mx-auto overflow-hidden")},m(o,c){z(o,t,c),vt(e,t,null),A(t,r),A(t,i),A(i,s),A(t,l),n&&n.m(t,null),A(t,h),vt(d,t,null),u=!0},p(o,[c]){n&&n.p&&(!u||c&1)&&qt(n,_,o,o[0],u?Kt(_,o[0],c,null):Jt(o[0]),null)},i(o){u||(De(e.$$.fragment,o),De(n,o),De(d.$$.fragment,o),u=!0)},o(o){Le(e.$$.fragment,o),Le(n,o),Le(d.$$.fragment,o),u=!1},d(o){o&&E(t),mt(e),n&&n.d(o),mt(d)}}}function ii(a,t,e){let{$$slots:r={},$$scope:i}=t;return a.$$set=s=>{"$$scope"in s&&e(0,i=s.$$scope)},[i,r]}class li extends Qe{constructor(t){super(),Ye(this,t,ii,ni,Ze,{})}}export{li as default};
