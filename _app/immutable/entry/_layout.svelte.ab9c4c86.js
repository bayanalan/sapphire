import{S as ut,i as dt,s as ht,k as x,a as H,l as I,m as j,c as N,h as T,n as S,b as K,C as w,D as ke,E as dr,o as Ct,F as Be,q as Q,r as Y,p as Dt,G as Ke,u as Lt,H as hr,I as fr,y as Ft,z as Bt,A as Ut,J as _r,K as pr,L as vr,g as ze,d as We,B as Mt}from"../chunks/index.232fda3f.js";import{p as mr}from"../chunks/stores.8aa2de2b.js";import{_ as Ue}from"../chunks/preload-helper.41c905a7.js";function yr(a,t){for(var e=0;e<t.length;e++){const r=t[e];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in a)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(a,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}))}var ge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gr(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var tr={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(a){(function(){var t=function(){this.init()};t.prototype={init:function(){var n=this||e;return n._counter=1e3,n._html5AudioPool=[],n.html5PoolSize=10,n._codecs={},n._howls=[],n._muted=!1,n._volume=1,n._canPlayEvent="canplaythrough",n._navigator=typeof window<"u"&&window.navigator?window.navigator:null,n.masterGain=null,n.noAudio=!1,n.usingWebAudio=!0,n.autoSuspend=!0,n.ctx=null,n.autoUnlock=!0,n._setup(),n},volume:function(n){var o=this||e;if(n=parseFloat(n),o.ctx||_(),typeof n<"u"&&n>=0&&n<=1){if(o._volume=n,o._muted)return o;o.usingWebAudio&&o.masterGain.gain.setValueAtTime(n,e.ctx.currentTime);for(var c=0;c<o._howls.length;c++)if(!o._howls[c]._webAudio)for(var f=o._howls[c]._getSoundIds(),m=0;m<f.length;m++){var v=o._howls[c]._soundById(f[m]);v&&v._node&&(v._node.volume=v._volume*n)}return o}return o._volume},mute:function(n){var o=this||e;o.ctx||_(),o._muted=n,o.usingWebAudio&&o.masterGain.gain.setValueAtTime(n?0:o._volume,e.ctx.currentTime);for(var c=0;c<o._howls.length;c++)if(!o._howls[c]._webAudio)for(var f=o._howls[c]._getSoundIds(),m=0;m<f.length;m++){var v=o._howls[c]._soundById(f[m]);v&&v._node&&(v._node.muted=n?!0:v._muted)}return o},stop:function(){for(var n=this||e,o=0;o<n._howls.length;o++)n._howls[o].stop();return n},unload:function(){for(var n=this||e,o=n._howls.length-1;o>=0;o--)n._howls[o].unload();return n.usingWebAudio&&n.ctx&&typeof n.ctx.close<"u"&&(n.ctx.close(),n.ctx=null,_()),n},codecs:function(n){return(this||e)._codecs[n.replace(/^x-/,"")]},_setup:function(){var n=this||e;if(n.state=n.ctx&&n.ctx.state||"suspended",n._autoSuspend(),!n.usingWebAudio)if(typeof Audio<"u")try{var o=new Audio;typeof o.oncanplaythrough>"u"&&(n._canPlayEvent="canplay")}catch{n.noAudio=!0}else n.noAudio=!0;try{var o=new Audio;o.muted&&(n.noAudio=!0)}catch{}return n.noAudio||n._setupCodecs(),n},_setupCodecs:function(){var n=this||e,o=null;try{o=typeof Audio<"u"?new Audio:null}catch{return n}if(!o||typeof o.canPlayType!="function")return n;var c=o.canPlayType("audio/mpeg;").replace(/^no$/,""),f=n._navigator?n._navigator.userAgent:"",m=f.match(/OPR\/([0-6].)/g),v=m&&parseInt(m[0].split("/")[1],10)<33,p=f.indexOf("Safari")!==-1&&f.indexOf("Chrome")===-1,b=f.match(/Version\/(.*?) /),A=p&&b&&parseInt(b[1],10)<15;return n._codecs={mp3:!!(!v&&(c||o.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!c,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(o.canPlayType('audio/wav; codecs="1"')||o.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!o.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(o.canPlayType("audio/x-m4b;")||o.canPlayType("audio/m4b;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!A&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!A&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(o.canPlayType("audio/x-flac;")||o.canPlayType("audio/flac;")).replace(/^no$/,"")},n},_unlockAudio:function(){var n=this||e;if(!(n._audioUnlocked||!n.ctx)){n._audioUnlocked=!1,n.autoUnlock=!1,!n._mobileUnloaded&&n.ctx.sampleRate!==44100&&(n._mobileUnloaded=!0,n.unload()),n._scratchBuffer=n.ctx.createBuffer(1,1,22050);var o=function(c){for(;n._html5AudioPool.length<n.html5PoolSize;)try{var f=new Audio;f._unlocked=!0,n._releaseHtml5Audio(f)}catch{n.noAudio=!0;break}for(var m=0;m<n._howls.length;m++)if(!n._howls[m]._webAudio)for(var v=n._howls[m]._getSoundIds(),p=0;p<v.length;p++){var b=n._howls[m]._soundById(v[p]);b&&b._node&&!b._node._unlocked&&(b._node._unlocked=!0,b._node.load())}n._autoResume();var A=n.ctx.createBufferSource();A.buffer=n._scratchBuffer,A.connect(n.ctx.destination),typeof A.start>"u"?A.noteOn(0):A.start(0),typeof n.ctx.resume=="function"&&n.ctx.resume(),A.onended=function(){A.disconnect(0),n._audioUnlocked=!0,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0),document.removeEventListener("click",o,!0),document.removeEventListener("keydown",o,!0);for(var k=0;k<n._howls.length;k++)n._howls[k]._emit("unlock")}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),document.addEventListener("click",o,!0),document.addEventListener("keydown",o,!0),n}},_obtainHtml5Audio:function(){var n=this||e;if(n._html5AudioPool.length)return n._html5AudioPool.pop();var o=new Audio().play();return o&&typeof Promise<"u"&&(o instanceof Promise||typeof o.then=="function")&&o.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(n){var o=this||e;return n._unlocked&&o._html5AudioPool.push(n),o},_autoSuspend:function(){var n=this;if(!(!n.autoSuspend||!n.ctx||typeof n.ctx.suspend>"u"||!e.usingWebAudio)){for(var o=0;o<n._howls.length;o++)if(n._howls[o]._webAudio){for(var c=0;c<n._howls[o]._sounds.length;c++)if(!n._howls[o]._sounds[c]._paused)return n}return n._suspendTimer&&clearTimeout(n._suspendTimer),n._suspendTimer=setTimeout(function(){if(n.autoSuspend){n._suspendTimer=null,n.state="suspending";var f=function(){n.state="suspended",n._resumeAfterSuspend&&(delete n._resumeAfterSuspend,n._autoResume())};n.ctx.suspend().then(f,f)}},3e4),n}},_autoResume:function(){var n=this;if(!(!n.ctx||typeof n.ctx.resume>"u"||!e.usingWebAudio))return n.state==="running"&&n.ctx.state!=="interrupted"&&n._suspendTimer?(clearTimeout(n._suspendTimer),n._suspendTimer=null):n.state==="suspended"||n.state==="running"&&n.ctx.state==="interrupted"?(n.ctx.resume().then(function(){n.state="running";for(var o=0;o<n._howls.length;o++)n._howls[o]._emit("resume")}),n._suspendTimer&&(clearTimeout(n._suspendTimer),n._suspendTimer=null)):n.state==="suspending"&&(n._resumeAfterSuspend=!0),n}};var e=new t,r=function(n){var o=this;if(!n.src||n.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}o.init(n)};r.prototype={init:function(n){var o=this;return e.ctx||_(),o._autoplay=n.autoplay||!1,o._format=typeof n.format!="string"?n.format:[n.format],o._html5=n.html5||!1,o._muted=n.mute||!1,o._loop=n.loop||!1,o._pool=n.pool||5,o._preload=typeof n.preload=="boolean"||n.preload==="metadata"?n.preload:!0,o._rate=n.rate||1,o._sprite=n.sprite||{},o._src=typeof n.src!="string"?n.src:[n.src],o._volume=n.volume!==void 0?n.volume:1,o._xhr={method:n.xhr&&n.xhr.method?n.xhr.method:"GET",headers:n.xhr&&n.xhr.headers?n.xhr.headers:null,withCredentials:n.xhr&&n.xhr.withCredentials?n.xhr.withCredentials:!1},o._duration=0,o._state="unloaded",o._sounds=[],o._endTimers={},o._queue=[],o._playLock=!1,o._onend=n.onend?[{fn:n.onend}]:[],o._onfade=n.onfade?[{fn:n.onfade}]:[],o._onload=n.onload?[{fn:n.onload}]:[],o._onloaderror=n.onloaderror?[{fn:n.onloaderror}]:[],o._onplayerror=n.onplayerror?[{fn:n.onplayerror}]:[],o._onpause=n.onpause?[{fn:n.onpause}]:[],o._onplay=n.onplay?[{fn:n.onplay}]:[],o._onstop=n.onstop?[{fn:n.onstop}]:[],o._onmute=n.onmute?[{fn:n.onmute}]:[],o._onvolume=n.onvolume?[{fn:n.onvolume}]:[],o._onrate=n.onrate?[{fn:n.onrate}]:[],o._onseek=n.onseek?[{fn:n.onseek}]:[],o._onunlock=n.onunlock?[{fn:n.onunlock}]:[],o._onresume=[],o._webAudio=e.usingWebAudio&&!o._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(o),o._autoplay&&o._queue.push({event:"play",action:function(){o.play()}}),o._preload&&o._preload!=="none"&&o.load(),o},load:function(){var n=this,o=null;if(e.noAudio){n._emit("loaderror",null,"No audio support.");return}typeof n._src=="string"&&(n._src=[n._src]);for(var c=0;c<n._src.length;c++){var f,m;if(n._format&&n._format[c])f=n._format[c];else{if(m=n._src[c],typeof m!="string"){n._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}f=/^data:audio\/([^;,]+);/i.exec(m),f||(f=/\.([^.]+)$/.exec(m.split("?",1)[0])),f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),f&&e.codecs(f)){o=n._src[c];break}}if(!o){n._emit("loaderror",null,"No codec support for selected audio sources.");return}return n._src=o,n._state="loading",window.location.protocol==="https:"&&o.slice(0,5)==="http:"&&(n._html5=!0,n._webAudio=!1),new i(n),n._webAudio&&l(n),n},play:function(n,o){var c=this,f=null;if(typeof n=="number")f=n,n=null;else{if(typeof n=="string"&&c._state==="loaded"&&!c._sprite[n])return null;if(typeof n>"u"&&(n="__default",!c._playLock)){for(var m=0,v=0;v<c._sounds.length;v++)c._sounds[v]._paused&&!c._sounds[v]._ended&&(m++,f=c._sounds[v]._id);m===1?n=null:f=null}}var p=f?c._soundById(f):c._inactiveSound();if(!p)return null;if(f&&!n&&(n=p._sprite||"__default"),c._state!=="loaded"){p._sprite=n,p._ended=!1;var b=p._id;return c._queue.push({event:"play",action:function(){c.play(b)}}),b}if(f&&!p._paused)return o||c._loadQueue("play"),p._id;c._webAudio&&e._autoResume();var A=Math.max(0,p._seek>0?p._seek:c._sprite[n][0]/1e3),k=Math.max(0,(c._sprite[n][0]+c._sprite[n][1])/1e3-A),L=k*1e3/Math.abs(p._rate),G=c._sprite[n][0]/1e3,q=(c._sprite[n][0]+c._sprite[n][1])/1e3;p._sprite=n,p._ended=!1;var R=function(){p._paused=!1,p._seek=A,p._start=G,p._stop=q,p._loop=!!(p._loop||c._sprite[n][2])};if(A>=q){c._ended(p);return}var P=p._node;if(c._webAudio){var W=function(){c._playLock=!1,R(),c._refreshBuffer(p);var y=p._muted||c._muted?0:p._volume;P.gain.setValueAtTime(y,e.ctx.currentTime),p._playStart=e.ctx.currentTime,typeof P.bufferSource.start>"u"?p._loop?P.bufferSource.noteGrainOn(0,A,86400):P.bufferSource.noteGrainOn(0,A,k):p._loop?P.bufferSource.start(0,A,86400):P.bufferSource.start(0,A,k),L!==1/0&&(c._endTimers[p._id]=setTimeout(c._ended.bind(c,p),L)),o||setTimeout(function(){c._emit("play",p._id),c._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?W():(c._playLock=!0,c.once("resume",W),c._clearTimer(p._id))}else{var V=function(){P.currentTime=A,P.muted=p._muted||c._muted||e._muted||P.muted,P.volume=p._volume*e.volume(),P.playbackRate=p._rate;try{var y=P.play();if(y&&typeof Promise<"u"&&(y instanceof Promise||typeof y.then=="function")?(c._playLock=!0,R(),y.then(function(){c._playLock=!1,P._unlocked=!0,o?c._loadQueue():c._emit("play",p._id)}).catch(function(){c._playLock=!1,c._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),p._ended=!0,p._paused=!0})):o||(c._playLock=!1,R(),c._emit("play",p._id)),P.playbackRate=p._rate,P.paused){c._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}n!=="__default"||p._loop?c._endTimers[p._id]=setTimeout(c._ended.bind(c,p),L):(c._endTimers[p._id]=function(){c._ended(p),P.removeEventListener("ended",c._endTimers[p._id],!1)},P.addEventListener("ended",c._endTimers[p._id],!1))}catch(g){c._emit("playerror",p._id,g)}};P.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(P.src=c._src,P.load());var Z=window&&window.ejecta||!P.readyState&&e._navigator.isCocoonJS;if(P.readyState>=3||Z)V();else{c._playLock=!0,c._state="loading";var ee=function(){c._state="loaded",V(),P.removeEventListener(e._canPlayEvent,ee,!1)};P.addEventListener(e._canPlayEvent,ee,!1),c._clearTimer(p._id)}}return p._id},pause:function(n){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"pause",action:function(){o.pause(n)}}),o;for(var c=o._getSoundIds(n),f=0;f<c.length;f++){o._clearTimer(c[f]);var m=o._soundById(c[f]);if(m&&!m._paused&&(m._seek=o.seek(c[f]),m._rateSeek=0,m._paused=!0,o._stopFade(c[f]),m._node))if(o._webAudio){if(!m._node.bufferSource)continue;typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),o._cleanBuffer(m._node)}else(!isNaN(m._node.duration)||m._node.duration===1/0)&&m._node.pause();arguments[1]||o._emit("pause",m?m._id:null)}return o},stop:function(n,o){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"stop",action:function(){c.stop(n)}}),c;for(var f=c._getSoundIds(n),m=0;m<f.length;m++){c._clearTimer(f[m]);var v=c._soundById(f[m]);v&&(v._seek=v._start||0,v._rateSeek=0,v._paused=!0,v._ended=!0,c._stopFade(f[m]),v._node&&(c._webAudio?v._node.bufferSource&&(typeof v._node.bufferSource.stop>"u"?v._node.bufferSource.noteOff(0):v._node.bufferSource.stop(0),c._cleanBuffer(v._node)):(!isNaN(v._node.duration)||v._node.duration===1/0)&&(v._node.currentTime=v._start||0,v._node.pause(),v._node.duration===1/0&&c._clearSound(v._node))),o||c._emit("stop",v._id))}return c},mute:function(n,o){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"mute",action:function(){c.mute(n,o)}}),c;if(typeof o>"u")if(typeof n=="boolean")c._muted=n;else return c._muted;for(var f=c._getSoundIds(o),m=0;m<f.length;m++){var v=c._soundById(f[m]);v&&(v._muted=n,v._interval&&c._stopFade(v._id),c._webAudio&&v._node?v._node.gain.setValueAtTime(n?0:v._volume,e.ctx.currentTime):v._node&&(v._node.muted=e._muted?!0:n),c._emit("mute",v._id))}return c},volume:function(){var n=this,o=arguments,c,f;if(o.length===0)return n._volume;if(o.length===1||o.length===2&&typeof o[1]>"u"){var m=n._getSoundIds(),v=m.indexOf(o[0]);v>=0?f=parseInt(o[0],10):c=parseFloat(o[0])}else o.length>=2&&(c=parseFloat(o[0]),f=parseInt(o[1],10));var p;if(typeof c<"u"&&c>=0&&c<=1){if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,o)}}),n;typeof f>"u"&&(n._volume=c),f=n._getSoundIds(f);for(var b=0;b<f.length;b++)p=n._soundById(f[b]),p&&(p._volume=c,o[2]||n._stopFade(f[b]),n._webAudio&&p._node&&!p._muted?p._node.gain.setValueAtTime(c,e.ctx.currentTime):p._node&&!p._muted&&(p._node.volume=c*e.volume()),n._emit("volume",p._id))}else return p=f?n._soundById(f):n._sounds[0],p?p._volume:0;return n},fade:function(n,o,c,f){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"fade",action:function(){m.fade(n,o,c,f)}}),m;n=Math.min(Math.max(0,parseFloat(n)),1),o=Math.min(Math.max(0,parseFloat(o)),1),c=parseFloat(c),m.volume(n,f);for(var v=m._getSoundIds(f),p=0;p<v.length;p++){var b=m._soundById(v[p]);if(b){if(f||m._stopFade(v[p]),m._webAudio&&!b._muted){var A=e.ctx.currentTime,k=A+c/1e3;b._volume=n,b._node.gain.setValueAtTime(n,A),b._node.gain.linearRampToValueAtTime(o,k)}m._startFadeInterval(b,n,o,c,v[p],typeof f>"u")}}return m},_startFadeInterval:function(n,o,c,f,m,v){var p=this,b=o,A=c-o,k=Math.abs(A/.01),L=Math.max(4,k>0?f/k:f),G=Date.now();n._fadeTo=c,n._interval=setInterval(function(){var q=(Date.now()-G)/f;G=Date.now(),b+=A*q,b=Math.round(b*100)/100,A<0?b=Math.max(c,b):b=Math.min(c,b),p._webAudio?n._volume=b:p.volume(b,n._id,!0),v&&(p._volume=b),(c<o&&b<=c||c>o&&b>=c)&&(clearInterval(n._interval),n._interval=null,n._fadeTo=null,p.volume(c,n._id),p._emit("fade",n._id))},L)},_stopFade:function(n){var o=this,c=o._soundById(n);return c&&c._interval&&(o._webAudio&&c._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(c._interval),c._interval=null,o.volume(c._fadeTo,n),c._fadeTo=null,o._emit("fade",n)),o},loop:function(){var n=this,o=arguments,c,f,m;if(o.length===0)return n._loop;if(o.length===1)if(typeof o[0]=="boolean")c=o[0],n._loop=c;else return m=n._soundById(parseInt(o[0],10)),m?m._loop:!1;else o.length===2&&(c=o[0],f=parseInt(o[1],10));for(var v=n._getSoundIds(f),p=0;p<v.length;p++)m=n._soundById(v[p]),m&&(m._loop=c,n._webAudio&&m._node&&m._node.bufferSource&&(m._node.bufferSource.loop=c,c&&(m._node.bufferSource.loopStart=m._start||0,m._node.bufferSource.loopEnd=m._stop,n.playing(v[p])&&(n.pause(v[p],!0),n.play(v[p],!0)))));return n},rate:function(){var n=this,o=arguments,c,f;if(o.length===0)f=n._sounds[0]._id;else if(o.length===1){var m=n._getSoundIds(),v=m.indexOf(o[0]);v>=0?f=parseInt(o[0],10):c=parseFloat(o[0])}else o.length===2&&(c=parseFloat(o[0]),f=parseInt(o[1],10));var p;if(typeof c=="number"){if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,o)}}),n;typeof f>"u"&&(n._rate=c),f=n._getSoundIds(f);for(var b=0;b<f.length;b++)if(p=n._soundById(f[b]),p){n.playing(f[b])&&(p._rateSeek=n.seek(f[b]),p._playStart=n._webAudio?e.ctx.currentTime:p._playStart),p._rate=c,n._webAudio&&p._node&&p._node.bufferSource?p._node.bufferSource.playbackRate.setValueAtTime(c,e.ctx.currentTime):p._node&&(p._node.playbackRate=c);var A=n.seek(f[b]),k=(n._sprite[p._sprite][0]+n._sprite[p._sprite][1])/1e3-A,L=k*1e3/Math.abs(p._rate);(n._endTimers[f[b]]||!p._paused)&&(n._clearTimer(f[b]),n._endTimers[f[b]]=setTimeout(n._ended.bind(n,p),L)),n._emit("rate",p._id)}}else return p=n._soundById(f),p?p._rate:n._rate;return n},seek:function(){var n=this,o=arguments,c,f;if(o.length===0)n._sounds.length&&(f=n._sounds[0]._id);else if(o.length===1){var m=n._getSoundIds(),v=m.indexOf(o[0]);v>=0?f=parseInt(o[0],10):n._sounds.length&&(f=n._sounds[0]._id,c=parseFloat(o[0]))}else o.length===2&&(c=parseFloat(o[0]),f=parseInt(o[1],10));if(typeof f>"u")return 0;if(typeof c=="number"&&(n._state!=="loaded"||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,o)}}),n;var p=n._soundById(f);if(p)if(typeof c=="number"&&c>=0){var b=n.playing(f);b&&n.pause(f,!0),p._seek=c,p._ended=!1,n._clearTimer(f),!n._webAudio&&p._node&&!isNaN(p._node.duration)&&(p._node.currentTime=c);var A=function(){b&&n.play(f,!0),n._emit("seek",f)};if(b&&!n._webAudio){var k=function(){n._playLock?setTimeout(k,0):A()};setTimeout(k,0)}else A()}else if(n._webAudio){var L=n.playing(f)?e.ctx.currentTime-p._playStart:0,G=p._rateSeek?p._rateSeek-p._seek:0;return p._seek+(G+L*Math.abs(p._rate))}else return p._node.currentTime;return n},playing:function(n){var o=this;if(typeof n=="number"){var c=o._soundById(n);return c?!c._paused:!1}for(var f=0;f<o._sounds.length;f++)if(!o._sounds[f]._paused)return!0;return!1},duration:function(n){var o=this,c=o._duration,f=o._soundById(n);return f&&(c=o._sprite[f._sprite][1]/1e3),c},state:function(){return this._state},unload:function(){for(var n=this,o=n._sounds,c=0;c<o.length;c++)o[c]._paused||n.stop(o[c]._id),n._webAudio||(n._clearSound(o[c]._node),o[c]._node.removeEventListener("error",o[c]._errorFn,!1),o[c]._node.removeEventListener(e._canPlayEvent,o[c]._loadFn,!1),o[c]._node.removeEventListener("ended",o[c]._endFn,!1),e._releaseHtml5Audio(o[c]._node)),delete o[c]._node,n._clearTimer(o[c]._id);var f=e._howls.indexOf(n);f>=0&&e._howls.splice(f,1);var m=!0;for(c=0;c<e._howls.length;c++)if(e._howls[c]._src===n._src||n._src.indexOf(e._howls[c]._src)>=0){m=!1;break}return s&&m&&delete s[n._src],e.noAudio=!1,n._state="unloaded",n._sounds=[],n=null,null},on:function(n,o,c,f){var m=this,v=m["_on"+n];return typeof o=="function"&&v.push(f?{id:c,fn:o,once:f}:{id:c,fn:o}),m},off:function(n,o,c){var f=this,m=f["_on"+n],v=0;if(typeof o=="number"&&(c=o,o=null),o||c)for(v=0;v<m.length;v++){var p=c===m[v].id;if(o===m[v].fn&&p||!o&&p){m.splice(v,1);break}}else if(n)f["_on"+n]=[];else{var b=Object.keys(f);for(v=0;v<b.length;v++)b[v].indexOf("_on")===0&&Array.isArray(f[b[v]])&&(f[b[v]]=[])}return f},once:function(n,o,c){var f=this;return f.on(n,o,c,1),f},_emit:function(n,o,c){for(var f=this,m=f["_on"+n],v=m.length-1;v>=0;v--)(!m[v].id||m[v].id===o||n==="load")&&(setTimeout(function(p){p.call(this,o,c)}.bind(f,m[v].fn),0),m[v].once&&f.off(n,m[v].fn,m[v].id));return f._loadQueue(n),f},_loadQueue:function(n){var o=this;if(o._queue.length>0){var c=o._queue[0];c.event===n&&(o._queue.shift(),o._loadQueue()),n||c.action()}return o},_ended:function(n){var o=this,c=n._sprite;if(!o._webAudio&&n._node&&!n._node.paused&&!n._node.ended&&n._node.currentTime<n._stop)return setTimeout(o._ended.bind(o,n),100),o;var f=!!(n._loop||o._sprite[c][2]);if(o._emit("end",n._id),!o._webAudio&&f&&o.stop(n._id,!0).play(n._id),o._webAudio&&f){o._emit("play",n._id),n._seek=n._start||0,n._rateSeek=0,n._playStart=e.ctx.currentTime;var m=(n._stop-n._start)*1e3/Math.abs(n._rate);o._endTimers[n._id]=setTimeout(o._ended.bind(o,n),m)}return o._webAudio&&!f&&(n._paused=!0,n._ended=!0,n._seek=n._start||0,n._rateSeek=0,o._clearTimer(n._id),o._cleanBuffer(n._node),e._autoSuspend()),!o._webAudio&&!f&&o.stop(n._id,!0),o},_clearTimer:function(n){var o=this;if(o._endTimers[n]){if(typeof o._endTimers[n]!="function")clearTimeout(o._endTimers[n]);else{var c=o._soundById(n);c&&c._node&&c._node.removeEventListener("ended",o._endTimers[n],!1)}delete o._endTimers[n]}return o},_soundById:function(n){for(var o=this,c=0;c<o._sounds.length;c++)if(n===o._sounds[c]._id)return o._sounds[c];return null},_inactiveSound:function(){var n=this;n._drain();for(var o=0;o<n._sounds.length;o++)if(n._sounds[o]._ended)return n._sounds[o].reset();return new i(n)},_drain:function(){var n=this,o=n._pool,c=0,f=0;if(!(n._sounds.length<o)){for(f=0;f<n._sounds.length;f++)n._sounds[f]._ended&&c++;for(f=n._sounds.length-1;f>=0;f--){if(c<=o)return;n._sounds[f]._ended&&(n._webAudio&&n._sounds[f]._node&&n._sounds[f]._node.disconnect(0),n._sounds.splice(f,1),c--)}}},_getSoundIds:function(n){var o=this;if(typeof n>"u"){for(var c=[],f=0;f<o._sounds.length;f++)c.push(o._sounds[f]._id);return c}else return[n]},_refreshBuffer:function(n){var o=this;return n._node.bufferSource=e.ctx.createBufferSource(),n._node.bufferSource.buffer=s[o._src],n._panner?n._node.bufferSource.connect(n._panner):n._node.bufferSource.connect(n._node),n._node.bufferSource.loop=n._loop,n._loop&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop||0),n._node.bufferSource.playbackRate.setValueAtTime(n._rate,e.ctx.currentTime),o},_cleanBuffer:function(n){var o=this,c=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&n.bufferSource&&(n.bufferSource.onended=null,n.bufferSource.disconnect(0),c))try{n.bufferSource.buffer=e._scratchBuffer}catch{}return n.bufferSource=null,o},_clearSound:function(n){var o=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);o||(n.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(n){this._parent=n,this.init()};i.prototype={init:function(){var n=this,o=n._parent;return n._muted=o._muted,n._loop=o._loop,n._volume=o._volume,n._rate=o._rate,n._seek=0,n._paused=!0,n._ended=!0,n._sprite="__default",n._id=++e._counter,o._sounds.push(n),n.create(),n},create:function(){var n=this,o=n._parent,c=e._muted||n._muted||n._parent._muted?0:n._volume;return o._webAudio?(n._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),n._node.gain.setValueAtTime(c,e.ctx.currentTime),n._node.paused=!0,n._node.connect(e.masterGain)):e.noAudio||(n._node=e._obtainHtml5Audio(),n._errorFn=n._errorListener.bind(n),n._node.addEventListener("error",n._errorFn,!1),n._loadFn=n._loadListener.bind(n),n._node.addEventListener(e._canPlayEvent,n._loadFn,!1),n._endFn=n._endListener.bind(n),n._node.addEventListener("ended",n._endFn,!1),n._node.src=o._src,n._node.preload=o._preload===!0?"auto":o._preload,n._node.volume=c*e.volume(),n._node.load()),n},reset:function(){var n=this,o=n._parent;return n._muted=o._muted,n._loop=o._loop,n._volume=o._volume,n._rate=o._rate,n._seek=0,n._rateSeek=0,n._paused=!0,n._ended=!0,n._sprite="__default",n._id=++e._counter,n},_errorListener:function(){var n=this;n._parent._emit("loaderror",n._id,n._node.error?n._node.error.code:0),n._node.removeEventListener("error",n._errorFn,!1)},_loadListener:function(){var n=this,o=n._parent;o._duration=Math.ceil(n._node.duration*10)/10,Object.keys(o._sprite).length===0&&(o._sprite={__default:[0,o._duration*1e3]}),o._state!=="loaded"&&(o._state="loaded",o._emit("load"),o._loadQueue()),n._node.removeEventListener(e._canPlayEvent,n._loadFn,!1)},_endListener:function(){var n=this,o=n._parent;o._duration===1/0&&(o._duration=Math.ceil(n._node.duration*10)/10,o._sprite.__default[1]===1/0&&(o._sprite.__default[1]=o._duration*1e3),o._ended(n)),n._node.removeEventListener("ended",n._endFn,!1)}};var s={},l=function(n){var o=n._src;if(s[o]){n._duration=s[o].duration,u(n);return}if(/^data:[^;]+;base64,/.test(o)){for(var c=atob(o.split(",")[1]),f=new Uint8Array(c.length),m=0;m<c.length;++m)f[m]=c.charCodeAt(m);h(f.buffer,n)}else{var v=new XMLHttpRequest;v.open(n._xhr.method,o,!0),v.withCredentials=n._xhr.withCredentials,v.responseType="arraybuffer",n._xhr.headers&&Object.keys(n._xhr.headers).forEach(function(p){v.setRequestHeader(p,n._xhr.headers[p])}),v.onload=function(){var p=(v.status+"")[0];if(p!=="0"&&p!=="2"&&p!=="3"){n._emit("loaderror",null,"Failed loading audio file with status: "+v.status+".");return}h(v.response,n)},v.onerror=function(){n._webAudio&&(n._html5=!0,n._webAudio=!1,n._sounds=[],delete s[o],n.load())},d(v)}},d=function(n){try{n.send()}catch{n.onerror()}},h=function(n,o){var c=function(){o._emit("loaderror",null,"Decoding audio data failed.")},f=function(m){m&&o._sounds.length>0?(s[o._src]=m,u(o,m)):c()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(n).then(f).catch(c):e.ctx.decodeAudioData(n,f,c)},u=function(n,o){o&&!n._duration&&(n._duration=o.duration),Object.keys(n._sprite).length===0&&(n._sprite={__default:[0,n._duration*1e3]}),n._state!=="loaded"&&(n._state="loaded",n._emit("load"),n._loadQueue())},_=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var n=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),o=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),c=o?parseInt(o[1],10):null;if(n&&c&&c<9){var f=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!f&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};a.Howler=e,a.Howl=r,typeof ge<"u"?(ge.HowlerGlobal=t,ge.Howler=e,ge.Howl=r,ge.Sound=i):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=r,window.Sound=i)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var r=this;if(!r.ctx||!r.ctx.listener)return r;for(var i=r._howls.length-1;i>=0;i--)r._howls[i].stereo(e);return r},HowlerGlobal.prototype.pos=function(e,r,i){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(r=typeof r!="number"?s._pos[1]:r,i=typeof i!="number"?s._pos[2]:i,typeof e=="number")s._pos=[e,r,i],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(e,r,i,s,l,d){var h=this;if(!h.ctx||!h.ctx.listener)return h;var u=h._orientation;if(r=typeof r!="number"?u[1]:r,i=typeof i!="number"?u[2]:i,s=typeof s!="number"?u[3]:s,l=typeof l!="number"?u[4]:l,d=typeof d!="number"?u[5]:d,typeof e=="number")h._orientation=[e,r,i,s,l,d],typeof h.ctx.listener.forwardX<"u"?(h.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),h.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),h.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),h.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),h.ctx.listener.upY.setTargetAtTime(l,Howler.ctx.currentTime,.1),h.ctx.listener.upZ.setTargetAtTime(d,Howler.ctx.currentTime,.1)):h.ctx.listener.setOrientation(e,r,i,s,l,d);else return u;return h},Howl.prototype.init=function(e){return function(r){var i=this;return i._orientation=r.orientation||[1,0,0],i._stereo=r.stereo||null,i._pos=r.pos||null,i._pannerAttr={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:360,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:360,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:0,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:"inverse",maxDistance:typeof r.maxDistance<"u"?r.maxDistance:1e4,panningModel:typeof r.panningModel<"u"?r.panningModel:"HRTF",refDistance:typeof r.refDistance<"u"?r.refDistance:1,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:1},i._onstereo=r.onstereo?[{fn:r.onstereo}]:[],i._onpos=r.onpos?[{fn:r.onpos}]:[],i._onorientation=r.onorientation?[{fn:r.onorientation}]:[],e.call(this,r)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,r){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(e,r)}}),i;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof r>"u")if(typeof e=="number")i._stereo=e,i._pos=[e,0,0];else return i._stereo;for(var l=i._getSoundIds(r),d=0;d<l.length;d++){var h=i._soundById(l[d]);if(h)if(typeof e=="number")h._stereo=e,h._pos=[e,0,0],h._node&&(h._pannerAttr.panningModel="equalpower",(!h._panner||!h._panner.pan)&&t(h,s),s==="spatial"?typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):h._panner.setPosition(e,0,0):h._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),i._emit("stereo",h._id);else return h._stereo}return i},Howl.prototype.pos=function(e,r,i,s){var l=this;if(!l._webAudio)return l;if(l._state!=="loaded")return l._queue.push({event:"pos",action:function(){l.pos(e,r,i,s)}}),l;if(r=typeof r!="number"?0:r,i=typeof i!="number"?-.5:i,typeof s>"u")if(typeof e=="number")l._pos=[e,r,i];else return l._pos;for(var d=l._getSoundIds(s),h=0;h<d.length;h++){var u=l._soundById(d[h]);if(u)if(typeof e=="number")u._pos=[e,r,i],u._node&&((!u._panner||u._panner.pan)&&t(u,"spatial"),typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setPosition(e,r,i)),l._emit("pos",u._id);else return u._pos}return l},Howl.prototype.orientation=function(e,r,i,s){var l=this;if(!l._webAudio)return l;if(l._state!=="loaded")return l._queue.push({event:"orientation",action:function(){l.orientation(e,r,i,s)}}),l;if(r=typeof r!="number"?l._orientation[1]:r,i=typeof i!="number"?l._orientation[2]:i,typeof s>"u")if(typeof e=="number")l._orientation=[e,r,i];else return l._orientation;for(var d=l._getSoundIds(s),h=0;h<d.length;h++){var u=l._soundById(d[h]);if(u)if(typeof e=="number")u._orientation=[e,r,i],u._node&&(u._panner||(u._pos||(u._pos=l._pos||[0,0,-.5]),t(u,"spatial")),typeof u._panner.orientationX<"u"?(u._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setOrientation(e,r,i)),l._emit("orientation",u._id);else return u._orientation}return l},Howl.prototype.pannerAttr=function(){var e=this,r=arguments,i,s,l;if(!e._webAudio)return e;if(r.length===0)return e._pannerAttr;if(r.length===1)if(typeof r[0]=="object")i=r[0],typeof s>"u"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),e._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle<"u"?i.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle<"u"?i.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain<"u"?i.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel<"u"?i.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance<"u"?i.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof i.pannerAttr.refDistance<"u"?i.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor<"u"?i.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel<"u"?i.pannerAttr.panningModel:e._panningModel});else return l=e._soundById(parseInt(r[0],10)),l?l._pannerAttr:e._pannerAttr;else r.length===2&&(i=r[0],s=parseInt(r[1],10));for(var d=e._getSoundIds(s),h=0;h<d.length;h++)if(l=e._soundById(d[h]),l){var u=l._pannerAttr;u={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:u.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:u.coneOuterGain,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:u.distanceModel,maxDistance:typeof i.maxDistance<"u"?i.maxDistance:u.maxDistance,refDistance:typeof i.refDistance<"u"?i.refDistance:u.refDistance,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:u.rolloffFactor,panningModel:typeof i.panningModel<"u"?i.panningModel:u.panningModel};var _=l._panner;_?(_.coneInnerAngle=u.coneInnerAngle,_.coneOuterAngle=u.coneOuterAngle,_.coneOuterGain=u.coneOuterGain,_.distanceModel=u.distanceModel,_.maxDistance=u.maxDistance,_.refDistance=u.refDistance,_.rolloffFactor=u.rolloffFactor,_.panningModel=u.panningModel):(l._pos||(l._pos=e._pos||[0,0,-.5]),t(l,"spatial"))}return e},Sound.prototype.init=function(e){return function(){var r=this,i=r._parent;r._orientation=i._orientation,r._stereo=i._stereo,r._pos=i._pos,r._pannerAttr=i._pannerAttr,e.call(this),r._stereo?i.stereo(r._stereo):r._pos&&i.pos(r._pos[0],r._pos[1],r._pos[2],r._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var r=this,i=r._parent;return r._orientation=i._orientation,r._stereo=i._stereo,r._pos=i._pos,r._pannerAttr=i._pannerAttr,r._stereo?i.stereo(r._stereo):r._pos?i.pos(r._pos[0],r._pos[1],r._pos[2],r._id):r._panner&&(r._panner.disconnect(0),r._panner=void 0,i._refreshBuffer(r)),e.call(this)}}(Sound.prototype.reset);var t=function(e,r){r=r||"spatial",r==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()})(tr);var br=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})};const wr=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...e)=>br(void 0,void 0,void 0,function*(){return yield(yield Ue(()=>Promise.resolve().then(()=>Me),void 0,import.meta.url)).fetch(...e)}):t=fetch,(...e)=>t(...e)};class ft extends Error{constructor(t,e="FunctionsError",r){super(t),super.name=e,this.context=r}}class Tr extends ft{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Ar extends ft{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Sr extends ft{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var kr=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})};class Er{constructor(t,{headers:e={},customFetch:r}={}){this.url=t,this.headers=e,this.fetch=wr(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,e={}){var r;return kr(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:l}=e;let d={},h;l&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",h=l):typeof l=="string"?(d["Content-Type"]="text/plain",h=l):typeof FormData<"u"&&l instanceof FormData?h=l:(d["Content-Type"]="application/json",h=JSON.stringify(l)));const u=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),i),body:h}).catch(c=>{throw new Tr(c)}),_=u.headers.get("x-relay-error");if(_&&_==="true")throw new Ar(u);if(!u.ok)throw new Sr(u);let n=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),o;return n==="application/json"?o=yield u.json():n==="application/octet-stream"?o=yield u.blob():n==="multipart/form-data"?o=yield u.formData():o=yield u.text(),{data:o,error:null}}catch(i){return{data:null,error:i}}})}}var st={exports:{}};(function(a,t){var e=typeof self<"u"?self:ge,r=function(){function s(){this.fetch=!1,this.DOMException=e.DOMException}return s.prototype=e,new s}();(function(s){(function(l){var d={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function h(y){return y&&DataView.prototype.isPrototypeOf(y)}if(d.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=ArrayBuffer.isView||function(y){return y&&u.indexOf(Object.prototype.toString.call(y))>-1};function n(y){if(typeof y!="string"&&(y=String(y)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(y))throw new TypeError("Invalid character in header field name");return y.toLowerCase()}function o(y){return typeof y!="string"&&(y=String(y)),y}function c(y){var g={next:function(){var E=y.shift();return{done:E===void 0,value:E}}};return d.iterable&&(g[Symbol.iterator]=function(){return g}),g}function f(y){this.map={},y instanceof f?y.forEach(function(g,E){this.append(E,g)},this):Array.isArray(y)?y.forEach(function(g){this.append(g[0],g[1])},this):y&&Object.getOwnPropertyNames(y).forEach(function(g){this.append(g,y[g])},this)}f.prototype.append=function(y,g){y=n(y),g=o(g);var E=this.map[y];this.map[y]=E?E+", "+g:g},f.prototype.delete=function(y){delete this.map[n(y)]},f.prototype.get=function(y){return y=n(y),this.has(y)?this.map[y]:null},f.prototype.has=function(y){return this.map.hasOwnProperty(n(y))},f.prototype.set=function(y,g){this.map[n(y)]=o(g)},f.prototype.forEach=function(y,g){for(var E in this.map)this.map.hasOwnProperty(E)&&y.call(g,this.map[E],E,this)},f.prototype.keys=function(){var y=[];return this.forEach(function(g,E){y.push(E)}),c(y)},f.prototype.values=function(){var y=[];return this.forEach(function(g){y.push(g)}),c(y)},f.prototype.entries=function(){var y=[];return this.forEach(function(g,E){y.push([E,g])}),c(y)},d.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);function m(y){if(y.bodyUsed)return Promise.reject(new TypeError("Already read"));y.bodyUsed=!0}function v(y){return new Promise(function(g,E){y.onload=function(){g(y.result)},y.onerror=function(){E(y.error)}})}function p(y){var g=new FileReader,E=v(g);return g.readAsArrayBuffer(y),E}function b(y){var g=new FileReader,E=v(g);return g.readAsText(y),E}function A(y){for(var g=new Uint8Array(y),E=new Array(g.length),U=0;U<g.length;U++)E[U]=String.fromCharCode(g[U]);return E.join("")}function k(y){if(y.slice)return y.slice(0);var g=new Uint8Array(y.byteLength);return g.set(new Uint8Array(y)),g.buffer}function L(){return this.bodyUsed=!1,this._initBody=function(y){this._bodyInit=y,y?typeof y=="string"?this._bodyText=y:d.blob&&Blob.prototype.isPrototypeOf(y)?this._bodyBlob=y:d.formData&&FormData.prototype.isPrototypeOf(y)?this._bodyFormData=y:d.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)?this._bodyText=y.toString():d.arrayBuffer&&d.blob&&h(y)?(this._bodyArrayBuffer=k(y.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):d.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(y)||_(y))?this._bodyArrayBuffer=k(y):this._bodyText=y=Object.prototype.toString.call(y):this._bodyText="",this.headers.get("content-type")||(typeof y=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):d.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d.blob&&(this.blob=function(){var y=m(this);if(y)return y;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?m(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var y=m(this);if(y)return y;if(this._bodyBlob)return b(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(A(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},d.formData&&(this.formData=function(){return this.text().then(P)}),this.json=function(){return this.text().then(JSON.parse)},this}var G=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function q(y){var g=y.toUpperCase();return G.indexOf(g)>-1?g:y}function R(y,g){g=g||{};var E=g.body;if(y instanceof R){if(y.bodyUsed)throw new TypeError("Already read");this.url=y.url,this.credentials=y.credentials,g.headers||(this.headers=new f(y.headers)),this.method=y.method,this.mode=y.mode,this.signal=y.signal,!E&&y._bodyInit!=null&&(E=y._bodyInit,y.bodyUsed=!0)}else this.url=String(y);if(this.credentials=g.credentials||this.credentials||"same-origin",(g.headers||!this.headers)&&(this.headers=new f(g.headers)),this.method=q(g.method||this.method||"GET"),this.mode=g.mode||this.mode||null,this.signal=g.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&E)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(E)}R.prototype.clone=function(){return new R(this,{body:this._bodyInit})};function P(y){var g=new FormData;return y.trim().split("&").forEach(function(E){if(E){var U=E.split("="),J=U.shift().replace(/\+/g," "),C=U.join("=").replace(/\+/g," ");g.append(decodeURIComponent(J),decodeURIComponent(C))}}),g}function W(y){var g=new f,E=y.replace(/\r?\n[\t ]+/g," ");return E.split(/\r?\n/).forEach(function(U){var J=U.split(":"),C=J.shift().trim();if(C){var te=J.join(":").trim();g.append(C,te)}}),g}L.call(R.prototype);function V(y,g){g||(g={}),this.type="default",this.status=g.status===void 0?200:g.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in g?g.statusText:"OK",this.headers=new f(g.headers),this.url=g.url||"",this._initBody(y)}L.call(V.prototype),V.prototype.clone=function(){return new V(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},V.error=function(){var y=new V(null,{status:0,statusText:""});return y.type="error",y};var Z=[301,302,303,307,308];V.redirect=function(y,g){if(Z.indexOf(g)===-1)throw new RangeError("Invalid status code");return new V(null,{status:g,headers:{location:y}})},l.DOMException=s.DOMException;try{new l.DOMException}catch{l.DOMException=function(g,E){this.message=g,this.name=E;var U=Error(g);this.stack=U.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function ee(y,g){return new Promise(function(E,U){var J=new R(y,g);if(J.signal&&J.signal.aborted)return U(new l.DOMException("Aborted","AbortError"));var C=new XMLHttpRequest;function te(){C.abort()}C.onload=function(){var ie={status:C.status,statusText:C.statusText,headers:W(C.getAllResponseHeaders()||"")};ie.url="responseURL"in C?C.responseURL:ie.headers.get("X-Request-URL");var oe="response"in C?C.response:C.responseText;E(new V(oe,ie))},C.onerror=function(){U(new TypeError("Network request failed"))},C.ontimeout=function(){U(new TypeError("Network request failed"))},C.onabort=function(){U(new l.DOMException("Aborted","AbortError"))},C.open(J.method,J.url,!0),J.credentials==="include"?C.withCredentials=!0:J.credentials==="omit"&&(C.withCredentials=!1),"responseType"in C&&d.blob&&(C.responseType="blob"),J.headers.forEach(function(ie,oe){C.setRequestHeader(oe,ie)}),J.signal&&(J.signal.addEventListener("abort",te),C.onreadystatechange=function(){C.readyState===4&&J.signal.removeEventListener("abort",te)}),C.send(typeof J._bodyInit>"u"?null:J._bodyInit)})}return ee.polyfill=!0,s.fetch||(s.fetch=ee,s.Headers=f,s.Request=R,s.Response=V),l.Headers=f,l.Request=R,l.Response=V,l.fetch=ee,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;t=i.fetch,t.default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,a.exports=t})(st,st.exports);var _t=st.exports;const pt=gr(_t),Me=yr({__proto__:null,default:pt},[_t]);class Or{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.allowEmpty=t.allowEmpty,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=pt:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(t,e){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var l,d,h;let u=null,_=null,n=null,o=s.status,c=s.statusText;if(s.ok){if(this.method!=="HEAD"){const p=await s.text();p===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?_=p:_=JSON.parse(p))}const m=(l=this.headers.Prefer)===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),v=(d=s.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");m&&v&&v.length>1&&(n=parseInt(v[1]))}else{const m=await s.text();try{u=JSON.parse(m),Array.isArray(u)&&s.status===404&&(_=[],u=null,o=200,c="OK")}catch{s.status===404&&m===""?(o=204,c="No Content"):u={message:m}}if(u&&this.allowEmpty&&(!((h=u==null?void 0:u.details)===null||h===void 0)&&h.includes("Results contain 0 rows"))&&(u=null,o=200,c="OK"),u&&this.shouldThrowOnError)throw u}return{error:u,data:_,count:n,status:o,statusText:c}});return this.shouldThrowOnError||(i=i.catch(s=>{var l,d,h;return{error:{message:`${(l=s==null?void 0:s.name)!==null&&l!==void 0?l:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(d=s==null?void 0:s.stack)!==null&&d!==void 0?d:""}`,hint:"",code:`${(h=s==null?void 0:s.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,e)}}class xr extends Or{select(t){let e=!1;const r=(t??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:i}={}){const s=i?`${i}.order`:"order",l=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${l?`${l},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e}={}){const r=typeof e>"u"?"limit":`${e}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,e,{foreignTable:r}={}){const i=typeof r>"u"?"offset":`${r}.offset`,s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.headers.Accept="application/vnd.pgrst.object+json",this.allowEmpty=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:i=!1,wal:s=!1,format:l="text"}={}){const d=[t?"analyze":null,e?"verbose":null,r?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=this.headers.Accept;return this.headers.Accept=`application/vnd.pgrst.plan+${l}; for="${h}"; options=${d};`,l==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class be extends xr{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){const r=e.map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const l=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${s}fts${l}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e}={}){const r=e?`${e}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}}class Ir{constructor(t,{headers:e={},schema:r,fetch:i}){this.url=t,this.headers=e,this.schema=r,this.fetch=i}select(t,{head:e=!1,count:r}={}){const i=e?"HEAD":"GET";let s=!1;const l=(t??"*").split("").map(d=>/\s/.test(d)&&!s?"":(d==='"'&&(s=!s),d)).join("");return this.url.searchParams.set("select",l),r&&(this.headers.Prefer=`count=${r}`),new be({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:e,defaultToNull:r=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),e&&s.push(`count=${e}`),r||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const l=t.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(l.length>0){const d=[...new Set(l)].map(h=>`"${h}"`);this.url.searchParams.set("columns",d.join(","))}}return new be({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:i,defaultToNull:s=!0}={}){const l="POST",d=[`resolution=${r?"ignore":"merge"}-duplicates`];if(e!==void 0&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&d.push(this.headers.Prefer),i&&d.push(`count=${i}`),s||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(t)){const h=t.reduce((u,_)=>u.concat(Object.keys(_)),[]);if(h.length>0){const u=[...new Set(h)].map(_=>`"${_}"`);this.url.searchParams.set("columns",u.join(","))}}return new be({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:e}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),e&&i.push(`count=${e}`),this.headers.Prefer=i.join(","),new be({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const e="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new be({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const Pr="1.6.0",$r={"X-Client-Info":`postgrest-js/${Pr}`};class jr{constructor(t,{headers:e={},schema:r,fetch:i}={}){this.url=t,this.headers=Object.assign(Object.assign({},$r),e),this.schema=r,this.fetch=i}from(t){const e=new URL(`${this.url}/${t}`);return new Ir(e,{headers:Object.assign({},this.headers),schema:this.schema,fetch:this.fetch})}rpc(t,e={},{head:r=!1,count:i}={}){let s;const l=new URL(`${this.url}/rpc/${t}`);let d;r?(s="HEAD",Object.entries(e).forEach(([u,_])=>{l.searchParams.append(u,`${_}`)})):(s="POST",d=e);const h=Object.assign({},this.headers);return i&&(h.Prefer=`count=${i}`),new be({method:s,url:l,headers:h,schema:this.schema,body:d,fetch:this.fetch,allowEmpty:!1})}}var Xe,Ht;function Rr(){if(Ht)return Xe;Ht=1;var a=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return Xe=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return a()}try{return __global__||a()}finally{delete Object.prototype.__global__}}(),Xe}const Cr="websocket",Dr="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",Lr=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],Fr="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",Br=["Iñaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],Ur="1.0.34",Mr={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},Hr="https://github.com/theturtle32/WebSocket-Node",Nr={node:">=4.0.0"},Gr={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},Vr={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},qr={verbose:!1},Jr={test:"tape test/unit/*.js",gulp:"gulp"},Kr="index",zr={lib:"./lib"},Wr="lib/browser.js",Xr="Apache-2.0",Qr={name:Cr,description:Dr,keywords:Lr,author:Fr,contributors:Br,version:Ur,repository:Mr,homepage:Hr,engines:Nr,dependencies:Gr,devDependencies:Vr,config:qr,scripts:Jr,main:Kr,directories:zr,browser:Wr,license:Xr};var Yr=Qr.version,fe;if(typeof globalThis=="object")fe=globalThis;else try{fe=Rr()}catch{}finally{if(!fe&&typeof window<"u"&&(fe=window),!fe)throw new Error("Could not determine global this")}var xe=fe.WebSocket||fe.MozWebSocket,Zr=Yr;function rr(a,t){var e;return t?e=new xe(a,t):e=new xe(a),e}xe&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(a){Object.defineProperty(rr,a,{get:function(){return xe[a]}})});var en={w3cwebsocket:xe?rr:null,version:Zr};const tn="2.7.2",rn={"X-Client-Info":`realtime-js/${tn}`},nn="1.0.0",nr=1e4,sn=1e3;var Ee;(function(a){a[a.connecting=0]="connecting",a[a.open=1]="open",a[a.closing=2]="closing",a[a.closed=3]="closed"})(Ee||(Ee={}));var re;(function(a){a.closed="closed",a.errored="errored",a.joined="joined",a.joining="joining",a.leaving="leaving"})(re||(re={}));var se;(function(a){a.close="phx_close",a.error="phx_error",a.join="phx_join",a.reply="phx_reply",a.leave="phx_leave",a.access_token="access_token"})(se||(se={}));var ot;(function(a){a.websocket="websocket"})(ot||(ot={}));var _e;(function(a){a.Connecting="connecting",a.Open="open",a.Closing="closing",a.Closed="closed"})(_e||(_e={}));class ir{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class on{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const e=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,e,r)}_decodeBroadcast(t,e,r){const i=e.getUint8(1),s=e.getUint8(2);let l=this.HEADER_LENGTH+2;const d=r.decode(t.slice(l,l+i));l=l+i;const h=r.decode(t.slice(l,l+s));l=l+s;const u=JSON.parse(r.decode(t.slice(l,t.byteLength)));return{ref:null,topic:d,event:h,payload:u}}}class Qe{constructor(t,e,r={},i=nr){this.channel=t,this.event=e,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null,this.rateLimited=!1}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){if(this._hasReceived("timeout"))return;this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()})==="rate limited"&&(this.rateLimited=!0)}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var r;return this._hasReceived(t)&&e((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Nt;(function(a){a.SYNC="sync",a.JOIN="join",a.LEAVE="leave"})(Nt||(Nt={}));class Oe{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(e==null?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:s,onLeave:l,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Oe.syncState(this.state,i,s,l),this.pendingDiffs.forEach(h=>{this.state=Oe.syncDiff(this.state,h,s,l)}),this.pendingDiffs=[],d()}),this.channel._on(r.diff,{},i=>{const{onJoin:s,onLeave:l,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Oe.syncDiff(this.state,i,s,l),d())}),this.onJoin((i,s,l)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:l})}),this.onLeave((i,s,l)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,r,i){const s=this.cloneDeep(t),l=this.transformState(e),d={},h={};return this.map(s,(u,_)=>{l[u]||(h[u]=_)}),this.map(l,(u,_)=>{const n=s[u];if(n){const o=_.map(v=>v.presence_ref),c=n.map(v=>v.presence_ref),f=_.filter(v=>c.indexOf(v.presence_ref)<0),m=n.filter(v=>o.indexOf(v.presence_ref)<0);f.length>0&&(d[u]=f),m.length>0&&(h[u]=m)}else d[u]=_}),this.syncDiff(s,{joins:d,leaves:h},r,i)}static syncDiff(t,e,r,i){const{joins:s,leaves:l}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(d,h)=>{var u;const _=(u=t[d])!==null&&u!==void 0?u:[];if(t[d]=this.cloneDeep(h),_.length>0){const n=t[d].map(c=>c.presence_ref),o=_.filter(c=>n.indexOf(c.presence_ref)<0);t[d].unshift(...o)}r(d,_,h)}),this.map(l,(d,h)=>{let u=t[d];if(!u)return;const _=h.map(n=>n.presence_ref);u=u.filter(n=>_.indexOf(n.presence_ref)<0),t[d]=u,i(d,u,h),u.length===0&&delete t[d]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(r=>e(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,r)=>{const i=t[r];return"metas"in i?e[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):e[r]=i,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var B;(function(a){a.abstime="abstime",a.bool="bool",a.date="date",a.daterange="daterange",a.float4="float4",a.float8="float8",a.int2="int2",a.int4="int4",a.int4range="int4range",a.int8="int8",a.int8range="int8range",a.json="json",a.jsonb="jsonb",a.money="money",a.numeric="numeric",a.oid="oid",a.reltime="reltime",a.text="text",a.time="time",a.timestamp="timestamp",a.timestamptz="timestamptz",a.timetz="timetz",a.tsrange="tsrange",a.tstzrange="tstzrange"})(B||(B={}));const Gt=(a,t,e={})=>{var r;const i=(r=e.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((s,l)=>(s[l]=an(l,a,t,i),s),{})},an=(a,t,e,r)=>{const i=t.find(d=>d.name===a),s=i==null?void 0:i.type,l=e[a];return s&&!r.includes(s)?sr(s,l):at(l)},sr=(a,t)=>{if(a.charAt(0)==="_"){const e=a.slice(1,a.length);return dn(t,e)}switch(a){case B.bool:return ln(t);case B.float4:case B.float8:case B.int2:case B.int4:case B.int8:case B.numeric:case B.oid:return cn(t);case B.json:case B.jsonb:return un(t);case B.timestamp:return hn(t);case B.abstime:case B.date:case B.daterange:case B.int4range:case B.int8range:case B.money:case B.reltime:case B.text:case B.time:case B.timestamptz:case B.timetz:case B.tsrange:case B.tstzrange:return at(t);default:return at(t)}},at=a=>a,ln=a=>{switch(a){case"t":return!0;case"f":return!1;default:return a}},cn=a=>{if(typeof a=="string"){const t=parseFloat(a);if(!Number.isNaN(t))return t}return a},un=a=>{if(typeof a=="string")try{return JSON.parse(a)}catch(t){return console.log(`JSON parse error: ${t}`),a}return a},dn=(a,t)=>{if(typeof a!="string")return a;const e=a.length-1,r=a[e];if(a[0]==="{"&&r==="}"){let s;const l=a.slice(1,e);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(d=>sr(t,d))}return a},hn=a=>typeof a=="string"?a.replace(" ","T"):a;var Vt=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})},qt;(function(a){a.ALL="*",a.INSERT="INSERT",a.UPDATE="UPDATE",a.DELETE="DELETE"})(qt||(qt={}));var Jt;(function(a){a.BROADCAST="broadcast",a.PRESENCE="presence",a.POSTGRES_CHANGES="postgres_changes"})(Jt||(Jt={}));var Kt;(function(a){a.SUBSCRIBED="SUBSCRIBED",a.TIMED_OUT="TIMED_OUT",a.CLOSED="CLOSED",a.CHANNEL_ERROR="CHANNEL_ERROR"})(Kt||(Kt={}));class vt{constructor(t,e={config:{}},r){this.topic=t,this.params=e,this.socket=r,this.bindings={},this.state=re.closed,this.joinedOnce=!1,this.pushBuffer=[],this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},e.config),this.timeout=this.socket.timeout,this.joinPush=new Qe(this,se.join,this.params,this.timeout),this.rejoinTimer=new ir(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=re.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=re.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=re.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=re.errored,this.rejoinTimer.scheduleTimeout())}),this._on(se.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new Oe(this)}subscribe(t,e=this.timeout){var r,i;if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:l}}=this.params;this._onError(u=>t&&t("CHANNEL_ERROR",u)),this._onClose(()=>t&&t("CLOSED"));const d={},h={broadcast:s,presence:l,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&i!==void 0?i:[]};this.socket.accessToken&&(d.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",({postgres_changes:u})=>{var _;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){t&&t("SUBSCRIBED");return}else{const n=this.bindings.postgres_changes,o=(_=n==null?void 0:n.length)!==null&&_!==void 0?_:0,c=[];for(let f=0;f<o;f++){const m=n[f],{filter:{event:v,schema:p,table:b,filter:A}}=m,k=u&&u[f];if(k&&k.event===v&&k.schema===p&&k.table===b&&k.filter===A)c.push(Object.assign(Object.assign({},m),{id:k.id}));else{this.unsubscribe(),t&&t("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=c,t&&t("SUBSCRIBED");return}}).receive("error",u=>{t&&t("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t&&t("TIMED_OUT")})}return this}presenceState(){return this.presence.state}track(t,e={}){return Vt(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)})}untrack(t={}){return Vt(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,e,r){return this._on(t,e,r)}send(t,e={}){return new Promise(r=>{var i,s,l;const d=this._push(t.type,t,e.timeout||this.timeout);d.rateLimited&&r("rate limited"),t.type==="broadcast"&&!(!((l=(s=(i=this.params)===null||i===void 0?void 0:i.config)===null||s===void 0?void 0:s.broadcast)===null||l===void 0)&&l.ack)&&r("ok"),d.receive("ok",()=>r("ok")),d.receive("timeout",()=>r("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=re.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(se.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const i=new Qe(this,se.leave,{},t);i.receive("ok",()=>{e(),r("ok")}).receive("timeout",()=>{e(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}_push(t,e,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Qe(this,t,e,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,e,r){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,r){var i,s;const l=t.toLocaleLowerCase(),{close:d,error:h,leave:u,join:_}=se;if(r&&[d,h,u,_].indexOf(l)>=0&&r!==this._joinRef())return;let o=this._onMessage(l,e,r);if(e&&!o)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(c=>{var f,m,v;return((f=c.filter)===null||f===void 0?void 0:f.event)==="*"||((v=(m=c.filter)===null||m===void 0?void 0:m.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===l}).map(c=>c.callback(o,r)):(s=this.bindings[l])===null||s===void 0||s.filter(c=>{var f,m,v,p,b,A;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in c){const k=c.id,L=(f=c.filter)===null||f===void 0?void 0:f.event;return k&&((m=e.ids)===null||m===void 0?void 0:m.includes(k))&&(L==="*"||(L==null?void 0:L.toLocaleLowerCase())===((v=e.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const k=(b=(p=c==null?void 0:c.filter)===null||p===void 0?void 0:p.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return k==="*"||k===((A=e==null?void 0:e.event)===null||A===void 0?void 0:A.toLocaleLowerCase())}else return c.type.toLocaleLowerCase()===l}).map(c=>{if(typeof o=="object"&&"ids"in o){const f=o.data,{schema:m,table:v,commit_timestamp:p,type:b,errors:A}=f;o=Object.assign(Object.assign({},{schema:m,table:v,commit_timestamp:p,eventType:b,new:{},old:{},errors:A}),this._getPayloadRecords(f))}c.callback(o,r)})}_isClosed(){return this.state===re.closed}_isJoined(){return this.state===re.joined}_isJoining(){return this.state===re.joining}_isLeaving(){return this.state===re.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,r){const i=t.toLocaleLowerCase(),s={type:i,filter:e,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,e){const r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&vt.isEqual(i.filter,e))}),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(se.close,{},t)}_onError(t){this._on(se.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=re.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=Gt(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=Gt(t.columns,t.old_record)),e}}var Ye=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})};const fn=()=>{};class _n{constructor(t,e){var r;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=rn,this.params={},this.timeout=nr,this.transport=en.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=fn,this.conn=null,this.sendBuffer=[],this.serializer=new on,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.eventsPerSecondLimitMs=100,this.inThrottle=!1,this.endPoint=`${t}/${ot.websocket}`,e!=null&&e.params&&(this.params=e.params),e!=null&&e.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e!=null&&e.timeout&&(this.timeout=e.timeout),e!=null&&e.logger&&(this.logger=e.logger),e!=null&&e.transport&&(this.transport=e.transport),e!=null&&e.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);const i=(r=e==null?void 0:e.params)===null||r===void 0?void 0:r.eventsPerSecond;i&&(this.eventsPerSecondLimitMs=Math.floor(1e3/i)),this.reconnectAfterMs=e!=null&&e.reconnectAfterMs?e.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=e!=null&&e.encode?e.encode:(s,l)=>l(JSON.stringify(s)),this.decode=e!=null&&e.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ir(()=>Ye(this,void 0,void 0,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t)))}disconnect(t,e){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(t){return Ye(this,void 0,void 0,function*(){const e=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),e})}removeAllChannels(){return Ye(this,void 0,void 0,function*(){const t=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),t})}log(t,e,r){this.logger(t,e,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ee.connecting:return _e.Connecting;case Ee.open:return _e.Open;case Ee.closing:return _e.Closing;default:return _e.Closed}}isConnected(){return this.connectionState()===_e.Open}channel(t,e={config:{}}){this.isConnected()||this.connect();const r=new vt(`realtime:${t}`,e,this);return this.channels.push(r),r}push(t){const{topic:e,event:r,payload:i,ref:s}=t;let l=()=>{this.encode(t,d=>{var h;(h=this.conn)===null||h===void 0||h.send(d)})};if(this.log("push",`${e} ${r} (${s})`,i),this.isConnected())if(["broadcast","presence","postgres_changes"].includes(r)){if(this._throttle(l)())return"rate limited"}else l();else this.sendBuffer.push(l)}setAuth(t){this.accessToken=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(se.access_token,{access_token:t})})}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e._joinRef()!==t._joinRef())}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:nn}))}_onConnMessage(t){this.decode(t.data,e=>{let{topic:r,event:i,payload:s,ref:l}=e;(l&&l===this.pendingHeartbeatRef||i===(s==null?void 0:s.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${i} ${l&&"("+l+")"||""}`,s),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(i,s,l)),this.stateChangeCallbacks.message.forEach(d=>d(e))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(se.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;const r=t.match(/\?/)?"&":"?",i=new URLSearchParams(e);return`${t}${r}${i}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(sn,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_throttle(t,e=this.eventsPerSecondLimitMs){return()=>this.inThrottle?!0:(t(),e>0&&(this.inThrottle=!0,setTimeout(()=>{this.inThrottle=!1},e)),!1)}}class mt extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function z(a){return typeof a=="object"&&a!==null&&"__isStorageError"in a}class pn extends mt{constructor(t,e){super(t),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class zt extends mt{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}var or=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})};const ar=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...e)=>or(void 0,void 0,void 0,function*(){return yield(yield Ue(()=>Promise.resolve().then(()=>Me),void 0,import.meta.url)).fetch(...e)}):t=fetch,(...e)=>t(...e)},vn=()=>or(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ue(()=>Promise.resolve().then(()=>Me),void 0,import.meta.url)).Response:Response});var we=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})};const Ze=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),mn=(a,t)=>we(void 0,void 0,void 0,function*(){const e=yield vn();a instanceof e?a.json().then(r=>{t(new pn(Ze(r),a.status||500))}).catch(r=>{t(new zt(Ze(r),r))}):t(new zt(Ze(a),a))}),yn=(a,t,e,r)=>{const i={method:a,headers:(t==null?void 0:t.headers)||{}};return a==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),e))};function He(a,t,e,r,i,s){return we(this,void 0,void 0,function*(){return new Promise((l,d)=>{a(e,yn(t,r,i,s)).then(h=>{if(!h.ok)throw h;return r!=null&&r.noResolveJson?h:h.json()}).then(h=>l(h)).catch(h=>mn(h,d))})})}function lt(a,t,e,r){return we(this,void 0,void 0,function*(){return He(a,"GET",t,e,r)})}function de(a,t,e,r,i){return we(this,void 0,void 0,function*(){return He(a,"POST",t,r,i,e)})}function gn(a,t,e,r,i){return we(this,void 0,void 0,function*(){return He(a,"PUT",t,r,i,e)})}function lr(a,t,e,r,i){return we(this,void 0,void 0,function*(){return He(a,"DELETE",t,r,i,e)})}var ne=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})};const bn={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Wt={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class wn{constructor(t,e={},r,i){this.url=t,this.headers=e,this.bucketId=r,this.fetch=ar(i)}uploadOrUpdate(t,e,r,i){return ne(this,void 0,void 0,function*(){try{let s;const l=Object.assign(Object.assign({},Wt),i),d=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",l.cacheControl)):(s=r,d["cache-control"]=`max-age=${l.cacheControl}`,d["content-type"]=l.contentType);const h=this._removeEmptyFolders(e),u=this._getFinalPath(h),_=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:s,headers:d},l!=null&&l.duplex?{duplex:l.duplex}:{}));return _.ok?{data:{path:h},error:null}:{data:null,error:yield _.json()}}catch(s){if(z(s))return{data:null,error:s};throw s}})}upload(t,e,r){return ne(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,r)})}uploadToSignedUrl(t,e,r,i){return ne(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),l=this._getFinalPath(s),d=new URL(this.url+`/object/upload/sign/${l}`);d.searchParams.set("token",e);try{let h;const u=Object.assign({upsert:Wt.upsert},i),_=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(h=new FormData,h.append("cacheControl",u.cacheControl),h.append("",r)):typeof FormData<"u"&&r instanceof FormData?(h=r,h.append("cacheControl",u.cacheControl)):(h=r,_["cache-control"]=`max-age=${u.cacheControl}`,_["content-type"]=u.contentType);const n=yield this.fetch(d.toString(),{method:"PUT",body:h,headers:_});return n.ok?{data:{path:s},error:null}:{data:null,error:yield n.json()}}catch(h){if(z(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(t){return ne(this,void 0,void 0,function*(){try{let e=this._getFinalPath(t);const r=yield de(this.fetch,`${this.url}/object/upload/sign/${e}`,{},{headers:this.headers}),i=new URL(this.url+r.url),s=i.searchParams.get("token");if(!s)throw new mt("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:s},error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}update(t,e,r){return ne(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,r)})}move(t,e){return ne(this,void 0,void 0,function*(){try{return{data:yield de(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e},{headers:this.headers}),error:null}}catch(r){if(z(r))return{data:null,error:r};throw r}})}copy(t,e){return ne(this,void 0,void 0,function*(){try{return{data:{path:(yield de(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e},{headers:this.headers})).Key},error:null}}catch(r){if(z(r))return{data:null,error:r};throw r}})}createSignedUrl(t,e,r){return ne(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield de(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:e},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${l}`)},{data:s,error:null}}catch(i){if(z(i))return{data:null,error:i};throw i}})}createSignedUrls(t,e,r){return ne(this,void 0,void 0,function*(){try{const i=yield de(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${s}`):null})),error:null}}catch(i){if(z(i))return{data:null,error:i};throw i}})}download(t,e){return ne(this,void 0,void 0,function*(){const i=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),l=s?`?${s}`:"";try{const d=this._getFinalPath(t);return{data:yield(yield lt(this.fetch,`${this.url}/${i}/${d}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(d){if(z(d))return{data:null,error:d};throw d}})}getPublicUrl(t,e){const r=this._getFinalPath(t),i=[],s=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&i.push(s);const d=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",h=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});h!==""&&i.push(h);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${r}${u}`)}}}remove(t){return ne(this,void 0,void 0,function*(){try{return{data:yield lr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}list(t,e,r){return ne(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},bn),e),{prefix:t||""});return{data:yield de(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(z(i))return{data:null,error:i};throw i}})}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const Tn="2.5.1",An={"X-Client-Info":`storage-js/${Tn}`};var ye=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})};class Sn{constructor(t,e={},r){this.url=t,this.headers=Object.assign(Object.assign({},An),e),this.fetch=ar(r)}listBuckets(){return ye(this,void 0,void 0,function*(){try{return{data:yield lt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(z(t))return{data:null,error:t};throw t}})}getBucket(t){return ye(this,void 0,void 0,function*(){try{return{data:yield lt(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}createBucket(t,e={public:!1}){return ye(this,void 0,void 0,function*(){try{return{data:yield de(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(z(r))return{data:null,error:r};throw r}})}updateBucket(t,e){return ye(this,void 0,void 0,function*(){try{return{data:yield gn(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(z(r))return{data:null,error:r};throw r}})}emptyBucket(t){return ye(this,void 0,void 0,function*(){try{return{data:yield de(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}deleteBucket(t){return ye(this,void 0,void 0,function*(){try{return{data:yield lr(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}}class kn extends Sn{constructor(t,e={},r){super(t,e,r)}from(t){return new wn(this.url,this.headers,t,this.fetch)}}const En="2.21.0",On={"X-Client-Info":`supabase-js/${En}`};var xn=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})};const In=a=>{let t;return a?t=a:typeof fetch>"u"?t=pt:t=fetch,(...e)=>t(...e)},Pn=()=>typeof Headers>"u"?_t.Headers:Headers,$n=(a,t,e)=>{const r=In(e),i=Pn();return(s,l)=>xn(void 0,void 0,void 0,function*(){var d;const h=(d=yield t())!==null&&d!==void 0?d:a;let u=new i(l==null?void 0:l.headers);return u.has("apikey")||u.set("apikey",a),u.has("Authorization")||u.set("Authorization",`Bearer ${h}`),r(s,Object.assign(Object.assign({},l),{headers:u}))})};function jn(a){return a.replace(/\/$/,"")}function Rn(a,t){const{db:e,auth:r,realtime:i,global:s}=a,{db:l,auth:d,realtime:h,global:u}=t;return{db:Object.assign(Object.assign({},l),e),auth:Object.assign(Object.assign({},d),r),realtime:Object.assign(Object.assign({},h),i),global:Object.assign(Object.assign({},u),s)}}var ve=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})};function Cn(a){return Math.round(Date.now()/1e3)+a}function Dn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){const t=Math.random()*16|0;return(a=="x"?t:t&3|8).toString(16)})}const ue=()=>typeof document<"u",he={tested:!1,writable:!1},et=()=>{if(!ue())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(he.tested)return he.writable;const a=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(a,a),globalThis.localStorage.removeItem(a),he.tested=!0,he.writable=!0}catch{he.tested=!0,he.writable=!1}return he.writable};function X(a,t){var e;t||(t=((e=window==null?void 0:window.location)===null||e===void 0?void 0:e.href)||""),a=a.replace(/[\[\]]/g,"\\$&");const r=new RegExp("[?&#]"+a+"(=([^&#]*)|&|#|$)"),i=r.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}const cr=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...e)=>ve(void 0,void 0,void 0,function*(){return yield(yield Ue(()=>Promise.resolve().then(()=>Me),void 0,import.meta.url)).fetch(...e)}):t=fetch,(...e)=>t(...e)},Ln=a=>typeof a=="object"&&a!==null&&"status"in a&&"ok"in a&&"json"in a&&typeof a.json=="function",Ae=(a,t,e)=>ve(void 0,void 0,void 0,function*(){yield a.setItem(t,JSON.stringify(e))}),Ce=(a,t)=>ve(void 0,void 0,void 0,function*(){const e=yield a.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}}),tt=(a,t)=>ve(void 0,void 0,void 0,function*(){yield a.removeItem(t)});function Fn(a){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let e="",r,i,s,l,d,h,u,_=0;for(a=a.replace("-","+").replace("_","/");_<a.length;)l=t.indexOf(a.charAt(_++)),d=t.indexOf(a.charAt(_++)),h=t.indexOf(a.charAt(_++)),u=t.indexOf(a.charAt(_++)),r=l<<2|d>>4,i=(d&15)<<4|h>>2,s=(h&3)<<6|u,e=e+String.fromCharCode(r),h!=64&&i!=0&&(e=e+String.fromCharCode(i)),u!=64&&s!=0&&(e=e+String.fromCharCode(s));return e}class Ne{constructor(){this.promise=new Ne.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}Ne.promiseConstructor=Promise;function Xt(a){const t=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,e=a.split(".");if(e.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!t.test(e[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=e[1];return JSON.parse(Fn(r))}function Bn(a){return new Promise(t=>{setTimeout(()=>t(null),a)})}function Un(a,t){return new Promise((r,i)=>{ve(this,void 0,void 0,function*(){for(let s=0;s<1/0;s++)try{const l=yield a(s);if(!t(s,null,l)){r(l);return}}catch(l){if(!t(s,l)){i(l);return}}})})}function Mn(a){return("0"+a.toString(16)).substr(-2)}function De(){const t=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=e.length;let i="";for(let s=0;s<56;s++)i+=e.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(t),Array.from(t,Mn).join("")}function Hn(a){return ve(this,void 0,void 0,function*(){const e=new TextEncoder().encode(a),r=yield crypto.subtle.digest("SHA-256",e),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")})}function Nn(a){return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function Le(a){return ve(this,void 0,void 0,function*(){if(typeof crypto>"u")return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),a;const t=yield Hn(a);return Nn(t)})}class yt extends Error{constructor(t,e){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e}}function D(a){return typeof a=="object"&&a!==null&&"__isAuthError"in a}class Gn extends yt{constructor(t,e){super(t,e),this.name="AuthApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function Vn(a){return D(a)&&a.name==="AuthApiError"}class ur extends yt{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class Ie extends yt{constructor(t,e,r){super(t),this.name=e,this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Se extends Ie{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class rt extends Ie{constructor(t){super(t,"AuthInvalidCredentialsError",400)}}class le extends Ie{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class nt extends Ie{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ct extends Ie{constructor(t,e){super(t,"AuthRetryableFetchError",e)}}var gt=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})},qn=globalThis&&globalThis.__rest||function(a,t){var e={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&t.indexOf(r)<0&&(e[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(a);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(a,r[i])&&(e[r[i]]=a[r[i]]);return e};const Fe=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),Jn=(a,t)=>gt(void 0,void 0,void 0,function*(){const e=[502,503,504];Ln(a)?e.includes(a.status)?t(new ct(Fe(a),a.status)):a.json().then(r=>{t(new Gn(Fe(r),a.status||500))}).catch(r=>{t(new ur(Fe(r),r))}):t(new ct(Fe(a),0))}),Kn=(a,t,e,r)=>{const i={method:a,headers:(t==null?void 0:t.headers)||{}};return a==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),e))};function F(a,t,e,r){var i;return gt(this,void 0,void 0,function*(){const s=Object.assign({},r==null?void 0:r.headers);r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const l=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(l.redirect_to=r.redirectTo);const d=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",h=yield zn(a,t,e+d,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(h):{data:Object.assign({},h),error:null}})}function zn(a,t,e,r,i,s){return gt(this,void 0,void 0,function*(){return new Promise((l,d)=>{a(e,Kn(t,r,i,s)).then(h=>{if(!h.ok)throw h;return r!=null&&r.noResolveJson?h:h.json()}).then(h=>l(h)).catch(h=>Jn(h,d))})})}function ce(a){var t;let e=null;Yn(a)&&(e=Object.assign({},a),e.expires_at=Cn(a.expires_in));const r=(t=a.user)!==null&&t!==void 0?t:a;return{data:{session:e,user:r},error:null}}function pe(a){var t;return{data:{user:(t=a.user)!==null&&t!==void 0?t:a},error:null}}function Wn(a){return{data:a,error:null}}function Xn(a){const{action_link:t,email_otp:e,hashed_token:r,redirect_to:i,verification_type:s}=a,l=qn(a,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:t,email_otp:e,hashed_token:r,redirect_to:i,verification_type:s},h=Object.assign({},l);return{data:{properties:d,user:h},error:null}}function Qn(a){return a}function Yn(a){return a.access_token&&a.refresh_token&&a.expires_in}var ae=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})},Zn=globalThis&&globalThis.__rest||function(a,t){var e={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&t.indexOf(r)<0&&(e[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(a);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(a,r[i])&&(e[r[i]]=a[r[i]]);return e};class ei{constructor({url:t="",headers:e={},fetch:r}){this.url=t,this.headers=e,this.fetch=cr(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(t){return ae(this,void 0,void 0,function*(){try{return yield F(this.fetch,"POST",`${this.url}/logout`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(e){if(D(e))return{data:null,error:e};throw e}})}inviteUserByEmail(t,e={}){return ae(this,void 0,void 0,function*(){try{return yield F(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:pe})}catch(r){if(D(r))return{data:{user:null},error:r};throw r}})}generateLink(t){return ae(this,void 0,void 0,function*(){try{const{options:e}=t,r=Zn(t,["options"]),i=Object.assign(Object.assign({},r),e);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),yield F(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Xn,redirectTo:e==null?void 0:e.redirectTo})}catch(e){if(D(e))return{data:{properties:null,user:null},error:e};throw e}})}createUser(t){return ae(this,void 0,void 0,function*(){try{return yield F(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:pe})}catch(e){if(D(e))return{data:{user:null},error:e};throw e}})}listUsers(t){var e,r,i,s,l,d,h;return ae(this,void 0,void 0,function*(){try{const u={nextPage:null,lastPage:0,total:0},_=yield F(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(e=t==null?void 0:t.page)===null||e===void 0?void 0:e.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Qn});if(_.error)throw _.error;const n=yield _.json(),o=(l=_.headers.get("x-total-count"))!==null&&l!==void 0?l:0,c=(h=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&h!==void 0?h:[];return c.length>0&&(c.forEach(f=>{const m=parseInt(f.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(f.split(";")[1].split("=")[1]);u[`${v}Page`]=m}),u.total=parseInt(o)),{data:Object.assign(Object.assign({},n),u),error:null}}catch(u){if(D(u))return{data:{users:[]},error:u};throw u}})}getUserById(t){return ae(this,void 0,void 0,function*(){try{return yield F(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:pe})}catch(e){if(D(e))return{data:{user:null},error:e};throw e}})}updateUserById(t,e){return ae(this,void 0,void 0,function*(){try{return yield F(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:pe})}catch(r){if(D(r))return{data:{user:null},error:r};throw r}})}deleteUser(t,e=!1){return ae(this,void 0,void 0,function*(){try{return yield F(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:pe})}catch(r){if(D(r))return{data:{user:null},error:r};throw r}})}_listFactors(t){return ae(this,void 0,void 0,function*(){try{const{data:e,error:r}=yield F(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:e,error:r}}catch(e){if(D(e))return{data:null,error:e};throw e}})}_deleteFactor(t){return ae(this,void 0,void 0,function*(){try{return{data:yield F(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(D(e))return{data:null,error:e};throw e}})}}const ti="2.24.0",ri="http://localhost:9999",ni="supabase.auth.token",ii={"X-Client-Info":`gotrue-js/${ti}`},si=10,oi={getItem:a=>et()?globalThis.localStorage.getItem(a):null,setItem:(a,t)=>{et()&&globalThis.localStorage.setItem(a,t)},removeItem:a=>{et()&&globalThis.localStorage.removeItem(a)}};function ai(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var $=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})};ai();const li={url:ri,storageKey:ni,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ii,flowType:"implicit"},it=30*1e3,ci=3;class ui{constructor(t){var e;this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.broadcastChannel=null;const r=Object.assign(Object.assign({},li),t);if(this.inMemorySession=null,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.persistSession=r.persistSession,this.storage=r.storage||oi,this.admin=new ei({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=cr(r.fetch),this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},ue()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(e=this.broadcastChannel)===null||e===void 0||e.addEventListener("message",i=>{this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}initialize(){return this.initializePromise||(this.initializePromise=this._initialize()),this.initializePromise}_initialize(){return $(this,void 0,void 0,function*(){if(this.initializePromise)return this.initializePromise;try{const t=yield this._isPKCEFlow();if(this.detectSessionInUrl&&this._isImplicitGrantFlow()||t){const{data:e,error:r}=yield this._getSessionFromUrl(t);if(r)return yield this._removeSession(),{error:r};const{session:i,redirectType:s}=e;return yield this._saveSession(i),setTimeout(()=>{s==="recovery"?this._notifyAllSubscribers("PASSWORD_RECOVERY",i):this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(t){return D(t)?{error:t}:{error:new ur("Unexpected error during initialization",t)}}finally{yield this._handleVisibilityChange()}})}signUp(t){var e,r,i;return $(this,void 0,void 0,function*(){try{yield this._removeSession();let s;if("email"in t){const{email:_,password:n,options:o}=t;let c=null,f=null;if(this.flowType==="pkce"){const m=De();yield Ae(this.storage,`${this.storageKey}-code-verifier`,m),c=yield Le(m),f=m===c?"plain":"s256"}s=yield F(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:o==null?void 0:o.emailRedirectTo,body:{email:_,password:n,data:(e=o==null?void 0:o.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken},code_challenge:c,code_challenge_method:f},xform:ce})}else if("phone"in t){const{phone:_,password:n,options:o}=t;s=yield F(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:n,data:(r=o==null?void 0:o.data)!==null&&r!==void 0?r:{},channel:(i=o==null?void 0:o.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:ce})}else throw new rt("You must provide either an email or phone number and a password");const{data:l,error:d}=s;if(d||!l)return{data:{user:null,session:null},error:d};const h=l.session,u=l.user;return l.session&&(yield this._saveSession(l.session),this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:u,session:h},error:null}}catch(s){if(D(s))return{data:{user:null,session:null},error:s};throw s}})}signInWithPassword(t){return $(this,void 0,void 0,function*(){try{yield this._removeSession();let e;if("email"in t){const{email:s,password:l,options:d}=t;e=yield F(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:ce})}else if("phone"in t){const{phone:s,password:l,options:d}=t;e=yield F(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:ce})}else throw new rt("You must provide either an email or phone number and a password");const{data:r,error:i}=e;return i||!r?{data:{user:null,session:null},error:i}:(r.session&&(yield this._saveSession(r.session),this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:r,error:i})}catch(e){if(D(e))return{data:{user:null,session:null},error:e};throw e}})}signInWithOAuth(t){var e,r,i,s;return $(this,void 0,void 0,function*(){return yield this._removeSession(),yield this._handleProviderSignIn(t.provider,{redirectTo:(e=t.options)===null||e===void 0?void 0:e.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})})}exchangeCodeForSession(t){return $(this,void 0,void 0,function*(){const e=yield Ce(this.storage,`${this.storageKey}-code-verifier`),{data:r,error:i}=yield F(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:e},xform:ce});return yield tt(this.storage,`${this.storageKey}-code-verifier`),i||!r?{data:{user:null,session:null},error:i}:(r.session&&(yield this._saveSession(r.session),this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:r,error:i})})}signInWithIdToken(t){return $(this,void 0,void 0,function*(){yield this._removeSession();try{const{options:e,provider:r,token:i,nonce:s}=t,l=yield F(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,nonce:s,gotrue_meta_security:{captcha_token:e==null?void 0:e.captchaToken}},xform:ce}),{data:d,error:h}=l;return h||!d?{data:{user:null,session:null},error:h}:(d.session&&(yield this._saveSession(d.session),this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:h})}catch(e){if(D(e))return{data:{user:null,session:null},error:e};throw e}})}signInWithOtp(t){var e,r,i,s,l;return $(this,void 0,void 0,function*(){try{if(yield this._removeSession(),"email"in t){const{email:d,options:h}=t;let u=null,_=null;if(this.flowType==="pkce"){const o=De();yield Ae(this.storage,`${this.storageKey}-code-verifier`,o),u=yield Le(o),_=o===u?"plain":"s256"}const{error:n}=yield F(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(e=h==null?void 0:h.data)!==null&&e!==void 0?e:{},create_user:(r=h==null?void 0:h.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:u,code_challenge_method:_},redirectTo:h==null?void 0:h.emailRedirectTo});return{data:{user:null,session:null},error:n}}if("phone"in t){const{phone:d,options:h}=t,{error:u}=yield F(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(i=h==null?void 0:h.data)!==null&&i!==void 0?i:{},create_user:(s=h==null?void 0:h.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},channel:(l=h==null?void 0:h.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null},error:u}}throw new rt("You must provide either an email or phone number.")}catch(d){if(D(d))return{data:{user:null,session:null},error:d};throw d}})}verifyOtp(t){var e,r;return $(this,void 0,void 0,function*(){try{yield this._removeSession();const{data:i,error:s}=yield F(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:(e=t.options)===null||e===void 0?void 0:e.captchaToken}}),redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,xform:ce});if(s)throw s;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,d=i.user;return l!=null&&l.access_token&&(yield this._saveSession(l),this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(i){if(D(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithSSO(t){var e,r,i;return $(this,void 0,void 0,function*(){try{return yield this._removeSession(),yield F(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(e=t.options)===null||e===void 0?void 0:e.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0}),headers:this.headers,xform:Wn})}catch(s){if(D(s))return{data:null,error:s};throw s}})}getSession(){return $(this,void 0,void 0,function*(){yield this.initializePromise;let t=null;if(this.persistSession){const s=yield Ce(this.storage,this.storageKey);s!==null&&(this._isValidSession(s)?t=s:yield this._removeSession())}else t=this.inMemorySession;if(!t)return{data:{session:null},error:null};if(!(t.expires_at?t.expires_at<=Date.now()/1e3:!1))return{data:{session:t},error:null};const{session:r,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:r},error:null}})}getUser(t){var e,r;return $(this,void 0,void 0,function*(){try{if(!t){const{data:i,error:s}=yield this.getSession();if(s)throw s;t=(r=(e=i.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:void 0}return yield F(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:pe})}catch(i){if(D(i))return{data:{user:null},error:i};throw i}})}updateUser(t,e={}){return $(this,void 0,void 0,function*(){try{const{data:r,error:i}=yield this.getSession();if(i)throw i;if(!r.session)throw new Se;const s=r.session,{data:l,error:d}=yield F(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e==null?void 0:e.emailRedirectTo,body:t,jwt:s.access_token,xform:pe});if(d)throw d;return s.user=l.user,yield this._saveSession(s),this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}}catch(r){if(D(r))return{data:{user:null},error:r};throw r}})}_decodeJWT(t){return Xt(t)}setSession(t){return $(this,void 0,void 0,function*(){try{if(!t.access_token||!t.refresh_token)throw new Se;const e=Date.now()/1e3;let r=e,i=!0,s=null;const l=Xt(t.access_token);if(l.exp&&(r=l.exp,i=r<=e),i){const{session:d,error:h}=yield this._callRefreshToken(t.refresh_token);if(h)return{data:{user:null,session:null},error:h};if(!d)return{data:{user:null,session:null},error:null};s=d}else{const{data:d,error:h}=yield this.getUser(t.access_token);if(h)throw h;s={access_token:t.access_token,refresh_token:t.refresh_token,user:d.user,token_type:"bearer",expires_in:r-e,expires_at:r},yield this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(e){if(D(e))return{data:{session:null,user:null},error:e};throw e}})}refreshSession(t){var e;return $(this,void 0,void 0,function*(){try{if(!t){const{data:s,error:l}=yield this.getSession();if(l)throw l;t=(e=s.session)!==null&&e!==void 0?e:void 0}if(!(t!=null&&t.refresh_token))throw new Se;const{session:r,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}catch(r){if(D(r))return{data:{user:null,session:null},error:r};throw r}})}_getSessionFromUrl(t){return $(this,void 0,void 0,function*(){try{if(!ue())throw new le("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new le("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!t)throw new nt("Not a valid PKCE flow url.");if(t){const v=X("code");if(!v)throw new nt("No code detected.");const{data:p,error:b}=yield this.exchangeCodeForSession(v);if(b)throw b;if(!p.session)throw new nt("No session detected.");return{data:{session:p.session,redirectType:null},error:null}}const e=X("error_description");if(e){const v=X("error_code");if(!v)throw new le("No error_code detected.");const p=X("error");throw p?new le(e,{error:p,code:v}):new le("No error detected.")}const r=X("provider_token"),i=X("provider_refresh_token"),s=X("access_token");if(!s)throw new le("No access_token detected.");const l=X("expires_in");if(!l)throw new le("No expires_in detected.");const d=X("refresh_token");if(!d)throw new le("No refresh_token detected.");const h=X("token_type");if(!h)throw new le("No token_type detected.");const _=Math.round(Date.now()/1e3)+parseInt(l),{data:n,error:o}=yield this.getUser(s);if(o)throw o;const c=n.user,f={provider_token:r,provider_refresh_token:i,access_token:s,expires_in:parseInt(l),expires_at:_,refresh_token:d,token_type:h,user:c},m=X("type");return window.location.hash="",{data:{session:f,redirectType:m},error:null}}catch(e){if(D(e))return{data:{session:null,redirectType:null},error:e};throw e}})}_isImplicitGrantFlow(){return ue()&&(!!X("access_token")||!!X("error_description"))}_isPKCEFlow(){return $(this,void 0,void 0,function*(){const t=yield Ce(this.storage,`${this.storageKey}-code-verifier`);return ue()&&!!X("code")&&!!t})}signOut(){var t;return $(this,void 0,void 0,function*(){const{data:e,error:r}=yield this.getSession();if(r)return{error:r};const i=(t=e.session)===null||t===void 0?void 0:t.access_token;if(i){const{error:s}=yield this.admin.signOut(i);if(s&&!(Vn(s)&&(s.status===404||s.status===401)))return{error:s}}return yield this._removeSession(),yield tt(this.storage,`${this.storageKey}-code-verifier`),this._notifyAllSubscribers("SIGNED_OUT",null),{error:null}})}onAuthStateChange(t){const e=Dn(),r={id:e,callback:t,unsubscribe:()=>{this.stateChangeEmitters.delete(e)}};return this.stateChangeEmitters.set(e,r),this.emitInitialSession(e),{data:{subscription:r}}}emitInitialSession(t){var e,r;return $(this,void 0,void 0,function*(){try{const{data:{session:i},error:s}=yield this.getSession();if(s)throw s;(e=this.stateChangeEmitters.get(t))===null||e===void 0||e.callback("INITIAL_SESSION",i)}catch(i){(r=this.stateChangeEmitters.get(t))===null||r===void 0||r.callback("INITIAL_SESSION",null),console.error(i)}})}resetPasswordForEmail(t,e={}){return $(this,void 0,void 0,function*(){let r=null,i=null;if(this.flowType==="pkce"){const s=De();yield Ae(this.storage,`${this.storageKey}-code-verifier`,s),r=yield Le(s),i=s===r?"plain":"s256"}try{return yield F(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(s){if(D(s))return{data:null,error:s};throw s}})}_refreshAccessToken(t){return $(this,void 0,void 0,function*(){try{const e=Date.now();return yield Un(r=>$(this,void 0,void 0,function*(){return yield Bn(r*200),yield F(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ce})}),(r,i,s)=>s&&s.error&&s.error instanceof ct&&Date.now()+(r+1)*200-e<it)}catch(e){if(D(e))return{data:{session:null,user:null},error:e};throw e}})}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}_handleProviderSignIn(t,e){return $(this,void 0,void 0,function*(){const r=yield this._getUrlForProvider(t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return ue()&&!e.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}})}_recoverAndRefresh(){var t;return $(this,void 0,void 0,function*(){try{const e=yield Ce(this.storage,this.storageKey);if(!this._isValidSession(e)){e!==null&&(yield this._removeSession());return}const r=Math.round(Date.now()/1e3);if(((t=e.expires_at)!==null&&t!==void 0?t:1/0)<r+si)if(this.autoRefreshToken&&e.refresh_token){const{error:i}=yield this._callRefreshToken(e.refresh_token);i&&(console.log(i.message),yield this._removeSession())}else yield this._removeSession();else this.persistSession&&(yield this._saveSession(e)),this._notifyAllSubscribers("SIGNED_IN",e)}catch(e){console.error(e);return}})}_callRefreshToken(t){var e,r;return $(this,void 0,void 0,function*(){if(this.refreshingDeferred)return this.refreshingDeferred.promise;try{if(this.refreshingDeferred=new Ne,!t)throw new Se;const{data:i,error:s}=yield this._refreshAccessToken(t);if(s)throw s;if(!i.session)throw new Se;yield this._saveSession(i.session),this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(D(i)){const s={session:null,error:i};return(e=this.refreshingDeferred)===null||e===void 0||e.resolve(s),s}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null}})}_notifyAllSubscribers(t,e,r=!0){this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:e}),this.stateChangeEmitters.forEach(i=>i.callback(t,e))}_saveSession(t){return $(this,void 0,void 0,function*(){this.persistSession||(this.inMemorySession=t),this.persistSession&&t.expires_at&&(yield this._persistSession(t))})}_persistSession(t){return Ae(this.storage,this.storageKey,t)}_removeSession(){return $(this,void 0,void 0,function*(){this.persistSession?yield tt(this.storage,this.storageKey):this.inMemorySession=null})}_removeVisibilityChangedCallback(){const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ue()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(e){console.error("removing visibilitychange callback failed",e)}}_startAutoRefresh(){return $(this,void 0,void 0,function*(){yield this._stopAutoRefresh();const t=setInterval(()=>this._autoRefreshTokenTick(),it);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),yield this._autoRefreshTokenTick()})}_stopAutoRefresh(){return $(this,void 0,void 0,function*(){const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)})}startAutoRefresh(){return $(this,void 0,void 0,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return $(this,void 0,void 0,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return $(this,void 0,void 0,function*(){const t=Date.now();try{const{data:{session:e}}=yield this.getSession();if(!e||!e.refresh_token||!e.expires_at)return;Math.floor((e.expires_at*1e3-t)/it)<ci&&(yield this._callRefreshToken(e.refresh_token))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}})}_handleVisibilityChange(){return $(this,void 0,void 0,function*(){if(!ue()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>$(this,void 0,void 0,function*(){return yield this._onVisibilityChanged(!1)}),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})}_onVisibilityChanged(t){return $(this,void 0,void 0,function*(){document.visibilityState==="visible"?(t||(yield this.initializePromise,yield this._recoverAndRefresh()),this.autoRefreshToken&&this._startAutoRefresh()):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(t,e){return $(this,void 0,void 0,function*(){const r=[`provider=${encodeURIComponent(t)}`];if(e!=null&&e.redirectTo&&r.push(`redirect_to=${encodeURIComponent(e.redirectTo)}`),e!=null&&e.scopes&&r.push(`scopes=${encodeURIComponent(e.scopes)}`),this.flowType==="pkce"){const i=De();yield Ae(this.storage,`${this.storageKey}-code-verifier`,i);const s=yield Le(i),l=i===s?"plain":"s256",d=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});r.push(d.toString())}if(e!=null&&e.queryParams){const i=new URLSearchParams(e.queryParams);r.push(i.toString())}return`${this.url}/authorize?${r.join("&")}`})}_unenroll(t){var e;return $(this,void 0,void 0,function*(){try{const{data:r,error:i}=yield this.getSession();return i?{data:null,error:i}:yield F(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(e=r==null?void 0:r.session)===null||e===void 0?void 0:e.access_token})}catch(r){if(D(r))return{data:null,error:r};throw r}})}_enroll(t){var e,r;return $(this,void 0,void 0,function*(){try{const{data:i,error:s}=yield this.getSession();if(s)return{data:null,error:s};const{data:l,error:d}=yield F(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:t.friendlyName,factor_type:t.factorType,issuer:t.issuer},headers:this.headers,jwt:(e=i==null?void 0:i.session)===null||e===void 0?void 0:e.access_token});return d?{data:null,error:d}:(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})}catch(i){if(D(i))return{data:null,error:i};throw i}})}_verify(t){var e;return $(this,void 0,void 0,function*(){try{const{data:r,error:i}=yield this.getSession();if(i)return{data:null,error:i};const{data:s,error:l}=yield F(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(e=r==null?void 0:r.session)===null||e===void 0?void 0:e.access_token});return l?{data:null,error:l}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:l})}catch(r){if(D(r))return{data:null,error:r};throw r}})}_challenge(t){var e;return $(this,void 0,void 0,function*(){try{const{data:r,error:i}=yield this.getSession();return i?{data:null,error:i}:yield F(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{headers:this.headers,jwt:(e=r==null?void 0:r.session)===null||e===void 0?void 0:e.access_token})}catch(r){if(D(r))return{data:null,error:r};throw r}})}_challengeAndVerify(t){return $(this,void 0,void 0,function*(){const{data:e,error:r}=yield this._challenge({factorId:t.factorId});return r?{data:null,error:r}:yield this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})})}_listFactors(){return $(this,void 0,void 0,function*(){const{data:{user:t},error:e}=yield this.getUser();if(e)return{data:null,error:e};const r=(t==null?void 0:t.factors)||[],i=r.filter(s=>s.factor_type==="totp"&&s.status==="verified");return{data:{all:r,totp:i},error:null}})}_getAuthenticatorAssuranceLevel(){var t,e;return $(this,void 0,void 0,function*(){const{data:{session:r},error:i}=yield this.getSession();if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const s=this._decodeJWT(r.access_token);let l=null;s.aal&&(l=s.aal);let d=l;((e=(t=r.user.factors)===null||t===void 0?void 0:t.filter(_=>_.status==="verified"))!==null&&e!==void 0?e:[]).length>0&&(d="aal2");const u=s.amr||[];return{data:{currentLevel:l,nextLevel:d,currentAuthenticationMethods:u},error:null}})}}class di extends ui{constructor(t){super(t)}}var hi=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function d(_){try{u(r.next(_))}catch(n){l(n)}}function h(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?s(_.value):i(_.value).then(d,h)}u((r=r.apply(a,t||[])).next())})};const fi={headers:On},_i={schema:"public"},pi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},vi={};class mi{constructor(t,e,r){var i,s,l,d,h,u,_,n;if(this.supabaseUrl=t,this.supabaseKey=e,!t)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const o=jn(t);if(this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,o.match(/(supabase\.co)|(supabase\.in)/)){const p=o.split(".");this.functionsUrl=`${p[0]}.functions.${p[1]}.${p[2]}`}else this.functionsUrl=`${o}/functions/v1`;const f=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,m={db:_i,realtime:vi,auth:Object.assign(Object.assign({},pi),{storageKey:f}),global:fi},v=Rn(r??{},m);this.storageKey=(s=(i=v.auth)===null||i===void 0?void 0:i.storageKey)!==null&&s!==void 0?s:"",this.headers=(d=(l=v.global)===null||l===void 0?void 0:l.headers)!==null&&d!==void 0?d:{},this.auth=this._initSupabaseAuthClient((h=v.auth)!==null&&h!==void 0?h:{},this.headers,(u=v.global)===null||u===void 0?void 0:u.fetch),this.fetch=$n(e,this._getAccessToken.bind(this),(_=v.global)===null||_===void 0?void 0:_.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},v.realtime)),this.rest=new jr(`${o}/rest/v1`,{headers:this.headers,schema:(n=v.db)===null||n===void 0?void 0:n.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Er(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new kn(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}rpc(t,e={},r){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,e;return hi(this,void 0,void 0,function*(){const{data:r}=yield this.auth.getSession();return(e=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:i,storageKey:s,flowType:l},d,h){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new di({url:this.authUrl,headers:Object.assign(Object.assign({},u),d),storageKey:s,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:i,flowType:l,fetch:h})}_initRealtimeClient(t){return new _n(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,r)=>{this._handleTokenChanged(e,r==null?void 0:r.access_token,"CLIENT")})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==e?(this.realtime.setAuth(e??null),this.changedAccessToken=e):t==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const yi=(a,t,e)=>new mi(a,t,e),gi="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml6bXRzd2F2c3ZobGlveml3YnN1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODAwNTQwMDMsImV4cCI6MTk5NTYzMDAwM30.gDfwu3GFqh1SDk3vPQqNuHUeL2BRQLr2gE2mab_o-oU",bi="https://izmtswavsvhlioziwbsu.supabase.co";yi(bi,gi);function Qt(a){let t,e,r,i,s;return{c(){t=x("div"),e=x("div"),r=x("a"),i=x("img"),this.h()},l(l){t=I(l,"DIV",{class:!0});var d=j(t);e=I(d,"DIV",{tabindex:!0,class:!0});var h=j(e);r=I(h,"A",{href:!0});var u=j(r);i=I(u,"IMG",{src:!0,alt:!0,class:!0}),u.forEach(T),h.forEach(T),d.forEach(T),this.h()},h(){Be(i.src,s="/back.png")||S(i,"src",s),S(i,"alt","back button"),S(i,"class","h-6 w-6"),S(r,"href","/library"),S(e,"tabindex","0"),S(e,"class","btn btn-ghost btn-circle"),S(t,"class","flex items-center")},m(l,d){K(l,t,d),w(t,e),w(e,r),w(r,i)},d(l){l&&T(t)}}}function Yt(a){let t,e;return{c(){t=x("a"),e=Q("Maverick White Reading Software"),this.h()},l(r){t=I(r,"A",{class:!0});var i=j(t);e=Y(i,"Maverick White Reading Software"),i.forEach(T),this.h()},h(){S(t,"class","text-2xl pb-1 poppins pt-2 mx-auto")},m(r,i){K(r,t,i),w(t,e)},d(r){r&&T(t)}}}function Zt(a){let t,e,r,i,s,l=a[5]?"Pause":"Start",d,h,u,_,n,o,c,f,m,v,p,b,A,k,L,G,q,R,P,W,V,Z,ee,y,g,E,U,J,C,te,ie,oe,Ge,Ve,Te,me,qe,Je,bt;return{c(){t=x("div"),e=H(),r=x("div"),i=x("div"),s=x("button"),d=Q(l),h=H(),u=x("button"),_=Q("Reset"),n=H(),o=x("div"),c=x("div"),f=Q(a[4]),m=H(),v=x("div"),p=H(),b=x("div"),A=x("center"),k=x("p"),L=Q("Progress:"),G=H(),q=x("div"),R=x("div"),P=H(),W=x("div"),V=H(),Z=x("script"),ee=Q(`function toggleDropdown(event) {
    const dropdown = event.target.nextElementSibling;
    dropdown.classList.toggle('hidden');
  }`),y=H(),g=x("div"),E=x("button"),U=x("img"),C=H(),te=x("ul"),ie=x("li"),oe=x("a"),Ge=Q("Reading Mode"),Ve=H(),Te=x("li"),me=x("a"),qe=Q("Audiobook Mode"),this.h()},l(O){t=I(O,"DIV",{class:!0}),j(t).forEach(T),e=N(O),r=I(O,"DIV",{class:!0});var M=j(r);i=I(M,"DIV",{});var Pe=j(i);s=I(Pe,"BUTTON",{class:!0});var wt=j(s);d=Y(wt,l),wt.forEach(T),h=N(Pe),u=I(Pe,"BUTTON",{class:!0});var Tt=j(u);_=Y(Tt,"Reset"),Tt.forEach(T),Pe.forEach(T),n=N(M),o=I(M,"DIV",{class:!0});var At=j(o);c=I(At,"DIV",{class:!0});var St=j(c);f=Y(St,a[4]),St.forEach(T),At.forEach(T),M.forEach(T),m=N(O),v=I(O,"DIV",{class:!0}),j(v).forEach(T),p=N(O),b=I(O,"DIV",{class:!0});var $e=j(b);A=I($e,"CENTER",{});var kt=j(A);k=I(kt,"P",{class:!0});var Et=j(k);L=Y(Et,"Progress:"),Et.forEach(T),kt.forEach(T),G=N($e),q=I($e,"DIV",{class:!0});var Ot=j(q);R=I(Ot,"DIV",{class:!0,style:!0}),j(R).forEach(T),Ot.forEach(T),$e.forEach(T),P=N(O),W=I(O,"DIV",{class:!0}),j(W).forEach(T),V=N(O),Z=I(O,"SCRIPT",{});var xt=j(Z);ee=Y(xt,`function toggleDropdown(event) {
    const dropdown = event.target.nextElementSibling;
    dropdown.classList.toggle('hidden');
  }`),xt.forEach(T),y=N(O),g=I(O,"DIV",{class:!0});var je=j(g);E=I(je,"BUTTON",{class:!0,tabindex:!0});var It=j(E);U=I(It,"IMG",{src:!0,alt:!0}),It.forEach(T),C=N(je),te=I(je,"UL",{class:!0});var Re=j(te);ie=I(Re,"LI",{});var Pt=j(ie);oe=I(Pt,"A",{class:!0});var $t=j(oe);Ge=Y($t,"Reading Mode"),$t.forEach(T),Pt.forEach(T),Ve=N(Re),Te=I(Re,"LI",{});var jt=j(Te);me=I(jt,"A",{class:!0});var Rt=j(me);qe=Y(Rt,"Audiobook Mode"),Rt.forEach(T),jt.forEach(T),Re.forEach(T),je.forEach(T),this.h()},h(){S(t,"class","divider divider-horizontal"),S(s,"class","bg-gray-100 text-black font-bold rounded-full poppins py-2 px-4 rounded timer-button svelte-1vdmm9a"),S(u,"class","bg-gray-100 text-black rounded-full font-bold poppins py-2 px-5 rounded timer-button pr-10 svelte-1vdmm9a"),S(c,"class","text-xl rounded-full font-medium text-center text-black p-3 rounded bg-gray-100"),S(o,"class","pr-1"),S(r,"class","flex items-center gap-2"),S(v,"class","divider divider-horizontal"),S(k,"class","poppins text-base pb-3"),S(R,"class","progress svelte-1vdmm9a"),Dt(R,"width",a[6]+"%"),S(q,"class","progress-bar rounded-full svelte-1vdmm9a"),S(b,"class","w-48"),S(W,"class","divider divider-horizontal"),Be(U.src,J="/bookoptions.png")||S(U,"src",J),S(U,"alt","Book Options"),S(E,"class","btn btn-ghost btn-circle w-12"),S(E,"tabindex","0"),S(oe,"class","poppins"),S(me,"class","poppins"),S(te,"class","menu menu-compact dropdown-content w-52 mt-3 p-2 rounded-box shadow-lg bg-white hidden"),S(g,"class","dropdown")},m(O,M){K(O,t,M),K(O,e,M),K(O,r,M),w(r,i),w(i,s),w(s,d),w(i,h),w(i,u),w(u,_),w(r,n),w(r,o),w(o,c),w(c,f),K(O,m,M),K(O,v,M),K(O,p,M),K(O,b,M),w(b,A),w(A,k),w(k,L),w(b,G),w(b,q),w(q,R),K(O,P,M),K(O,W,M),K(O,V,M),K(O,Z,M),w(Z,ee),K(O,y,M),K(O,g,M),w(g,E),w(E,U),w(g,C),w(g,te),w(te,ie),w(ie,oe),w(oe,Ge),w(te,Ve),w(te,Te),w(Te,me),w(me,qe),Je||(bt=[Ke(s,"click",a[12]),Ke(u,"click",a[10]),Ke(E,"click",toggleDropdown)],Je=!0)},p(O,M){M&32&&l!==(l=O[5]?"Pause":"Start")&&Lt(d,l),M&16&&Lt(f,O[4]),M&64&&Dt(R,"width",O[6]+"%")},d(O){O&&T(t),O&&T(e),O&&T(r),O&&T(m),O&&T(v),O&&T(p),O&&T(b),O&&T(P),O&&T(W),O&&T(V),O&&T(Z),O&&T(y),O&&T(g),Je=!1,hr(bt)}}}function er(a){let t,e,r,i;return{c(){t=x("div"),e=x("a"),r=x("img"),this.h()},l(s){t=I(s,"DIV",{class:!0});var l=j(t);e=I(l,"A",{href:!0});var d=j(e);r=I(d,"IMG",{src:!0,alt:!0,class:!0}),d.forEach(T),l.forEach(T),this.h()},h(){Be(r.src,i="/profile.png")||S(r,"src",i),S(r,"alt","profile"),S(r,"class","rounded-full"),S(e,"href","/profile"),S(t,"class","avatar w-12 btn btn-ghost btn-circle")},m(s,l){K(s,t,l),w(t,e),w(e,r)},d(s){s&&T(t)}}}function wi(a){let t,e,r,i,s,l,d=!a[7]&!a[1]&!a[2]&!a[3]&&Qt(),h=!a[0]&&Yt(),u=a[0]&&Zt(a),_=!a[1]&!a[0]&!a[2]&!a[3]&&er();return{c(){t=x("div"),e=x("div"),r=x("nav"),d&&d.c(),i=H(),h&&h.c(),s=H(),u&&u.c(),l=H(),_&&_.c(),this.h()},l(n){t=I(n,"DIV",{class:!0});var o=j(t);e=I(o,"DIV",{class:!0});var c=j(e);r=I(c,"NAV",{class:!0});var f=j(r);d&&d.l(f),i=N(f),h&&h.l(f),s=N(f),u&&u.l(f),l=N(f),_&&_.l(f),f.forEach(T),c.forEach(T),o.forEach(T),this.h()},h(){S(r,"class","flex justify-between overflow-x-auto"),S(e,"class","container mx-auto px-5 py-2"),S(t,"class","fixed inset-x-0 top-0 z-50 bg-white")},m(n,o){K(n,t,o),w(t,e),w(e,r),d&&d.m(r,null),w(r,i),h&&h.m(r,null),w(r,s),u&&u.m(r,null),w(r,l),_&&_.m(r,null)},p(n,[o]){!n[7]&!n[1]&!n[2]&!n[3]?d||(d=Qt(),d.c(),d.m(r,i)):d&&(d.d(1),d=null),n[0]?h&&(h.d(1),h=null):h||(h=Yt(),h.c(),h.m(r,s)),n[0]?u?u.p(n,o):(u=Zt(n),u.c(),u.m(r,l)):u&&(u.d(1),u=null),!n[1]&!n[0]&!n[2]&!n[3]?_||(_=er(),_.c(),_.m(r,null)):_&&(_.d(1),_=null)},i:ke,o:ke,d(n){n&&T(t),d&&d.d(),h&&h.d(),u&&u.d(),_&&_.d()}}}function Ti(a,t,e){let r,i;dr(a,mr,R=>e(11,i=R));var s,l,d,h;let u,_="0:00",n=!1,o,c=0,f;const m=()=>{f=new tr.Howl({src:"/mixkit-classic-alarm-995.wav"}),f.play()},v=()=>{f.stop()},p=()=>{e(5,n=!0),o=Date.now()-c,u=setInterval(()=>{c=Date.now()-o;const R=Math.floor(c/6e4),P=Math.floor(c%6e4/1e3);e(4,_=`${R}:${P.toString().padStart(2,"0")}`)},1e3)},b=()=>{clearInterval(u),e(5,n=!1),c=Date.now()-o},A=()=>{clearInterval(u),e(5,n=!1),e(4,_="0:00"),c=0};Ct(()=>{m(),v()});let k=0;Ct(()=>{window.addEventListener("scroll",L),e(6,k=localStorage.getItem("scrollPercentage")||0)});function L(){const R=document.documentElement.scrollTop,P=document.documentElement.scrollHeight-document.documentElement.clientHeight;e(6,k=Math.floor(R/P*100)),localStorage.setItem("scrollPercentage",k),G()}function G(){const R=document.getElementById("scrubber");R&&R.value&&k&&(R.value=k)}const q=()=>{n?b():p()};return a.$$.update=()=>{a.$$.dirty&2048&&e(0,s=i.url.pathname.indexOf("book/")>0),a.$$.dirty&2048&&i.url.pathname.indexOf("audiobook/")>0,a.$$.dirty&2048&&e(1,l=i.url.pathname=="/"),a.$$.dirty&2048&&e(3,h=i.url.pathname=="/signin"),a.$$.dirty&2048&&e(7,r=i.url.pathname=="/library"),a.$$.dirty&2048&&e(2,d=i.url.pathname.indexOf("setup/")>0)},[s,l,d,h,_,n,k,r,p,b,A,i,q]}class Ai extends ut{constructor(t){super(),dt(this,t,Ti,wi,ht,{})}}function Si(a){let t,e,r,i,s,l,d,h,u,_,n,o,c,f,m,v,p,b,A,k;return{c(){t=x("footer"),e=x("div"),r=x("img"),s=H(),l=x("a"),d=Q("Maverick White Reading 2023 Beta"),h=H(),u=x("div"),_=x("a"),n=Q("Youtube"),o=H(),c=x("a"),f=Q("Contact Us"),m=H(),v=x("a"),p=Q("Merch"),b=H(),A=x("a"),k=Q("Donate"),this.h()},l(L){t=I(L,"FOOTER",{class:!0});var G=j(t);e=I(G,"DIV",{class:!0});var q=j(e);r=I(q,"IMG",{src:!0,width:!0}),s=N(q),l=I(q,"A",{class:!0});var R=j(l);d=Y(R,"Maverick White Reading 2023 Beta"),R.forEach(T),q.forEach(T),h=N(G),u=I(G,"DIV",{class:!0});var P=j(u);_=I(P,"A",{class:!0,target:!0,href:!0});var W=j(_);n=Y(W,"Youtube"),W.forEach(T),o=N(P),c=I(P,"A",{class:!0,target:!0,href:!0});var V=j(c);f=Y(V,"Contact Us"),V.forEach(T),m=N(P),v=I(P,"A",{target:!0,class:!0,href:!0});var Z=j(v);p=Y(Z,"Merch"),Z.forEach(T),b=N(P),A=I(P,"A",{target:!0,class:!0,href:!0});var ee=j(A);k=Y(ee,"Donate"),ee.forEach(T),P.forEach(T),G.forEach(T),this.h()},h(){Be(r.src,i="/blacklogo.png")||S(r,"src",i),S(r,"width","125"),S(l,"class","poppins text-2xl text-black"),S(e,"class","items-center grid-flow-col"),S(_,"class","btn btn-outline rounded-full poppins text-black"),S(_,"target","_blank"),S(_,"href","https://www.youtube.com/channel/UCFX6Qz84JDNXvfCegXOq3aA"),S(c,"class","btn btn-outline rounded-full poppins text-black"),S(c,"target","_blank"),S(c,"href","mailto:maverick.white.books@gmail.com?subject="),S(v,"target","_blank"),S(v,"class","btn rounded-full poppins btn-outline"),S(v,"href","https://www.zazzle.com/store/maverick_merch/products"),S(A,"target","_blank"),S(A,"class","btn rounded-full poppins btn-outline"),S(A,"href","https://donate.stripe.com/test_bIYcQI4aK1YGcHCaEJ"),S(u,"class","grid-flow-col gap-4 md:place-self-center md:justify-self-end"),S(t,"class","footer rounded-full items-center bg-white p-4 m-0 mt-40 text-neutral-content")},m(L,G){K(L,t,G),w(t,e),w(e,r),w(e,s),w(e,l),w(l,d),w(t,h),w(t,u),w(u,_),w(_,n),w(u,o),w(u,c),w(c,f),w(u,m),w(u,v),w(v,p),w(u,b),w(u,A),w(A,k)},p:ke,i:ke,o:ke,d(L){L&&T(t)}}}class ki extends ut{constructor(t){super(),dt(this,t,null,Si,ht,{})}}function Ei(a){let t,e,r,i,s,l,d,h,u;e=new Ai({});const _=a[1].default,n=fr(_,a,a[0],null);return h=new ki({}),{c(){t=x("div"),Ft(e.$$.fragment),r=H(),i=x("div"),s=Q(" "),l=H(),n&&n.c(),d=H(),Ft(h.$$.fragment),this.h()},l(o){t=I(o,"DIV",{class:!0});var c=j(t);Bt(e.$$.fragment,c),r=N(c),i=I(c,"DIV",{class:!0});var f=j(i);s=Y(f," "),f.forEach(T),l=N(c),n&&n.l(c),d=N(c),Bt(h.$$.fragment,c),c.forEach(T),this.h()},h(){S(i,"class","h-20"),S(t,"class","max-w-screen mx-auto overflow-hidden")},m(o,c){K(o,t,c),Ut(e,t,null),w(t,r),w(t,i),w(i,s),w(t,l),n&&n.m(t,null),w(t,d),Ut(h,t,null),u=!0},p(o,[c]){n&&n.p&&(!u||c&1)&&_r(n,_,o,o[0],u?vr(_,o[0],c,null):pr(o[0]),null)},i(o){u||(ze(e.$$.fragment,o),ze(n,o),ze(h.$$.fragment,o),u=!0)},o(o){We(e.$$.fragment,o),We(n,o),We(h.$$.fragment,o),u=!1},d(o){o&&T(t),Mt(e),n&&n.d(o),Mt(h)}}}function Oi(a,t,e){let{$$slots:r={},$$scope:i}=t;return a.$$set=s=>{"$$scope"in s&&e(0,i=s.$$scope)},[i,r]}class $i extends ut{constructor(t){super(),dt(this,t,Oi,Ei,ht,{})}}export{$i as default};
