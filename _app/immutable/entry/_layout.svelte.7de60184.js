import{S as Qe,i as Ye,s as Ze,k as O,a as V,l as x,m as j,c as q,h as S,n as w,b as W,D as A,C as Te,E as Gt,o as ut,F as ae,q as le,r as ce,p as dt,G as ht,u as ft,H as Vt,I as qt,y as _t,z as pt,A as vt,J as Jt,K as Kt,L as Wt,g as De,d as Le,B as mt}from"../chunks/index.a6311b6a.js";import{p as zt}from"../chunks/stores.7fd017df.js";import{_ as $e}from"../chunks/preload-helper.41c905a7.js";function Xt(a,t){for(var e=0;e<t.length;e++){const r=t[e];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in a)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(a,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}))}var me=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qt(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Rt={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(a){(function(){var t=function(){this.init()};t.prototype={init:function(){var n=this||e;return n._counter=1e3,n._html5AudioPool=[],n.html5PoolSize=10,n._codecs={},n._howls=[],n._muted=!1,n._volume=1,n._canPlayEvent="canplaythrough",n._navigator=typeof window<"u"&&window.navigator?window.navigator:null,n.masterGain=null,n.noAudio=!1,n.usingWebAudio=!0,n.autoSuspend=!0,n.ctx=null,n.autoUnlock=!0,n._setup(),n},volume:function(n){var s=this||e;if(n=parseFloat(n),s.ctx||_(),typeof n<"u"&&n>=0&&n<=1){if(s._volume=n,s._muted)return s;s.usingWebAudio&&s.masterGain.gain.setValueAtTime(n,e.ctx.currentTime);for(var c=0;c<s._howls.length;c++)if(!s._howls[c]._webAudio)for(var f=s._howls[c]._getSoundIds(),p=0;p<f.length;p++){var v=s._howls[c]._soundById(f[p]);v&&v._node&&(v._node.volume=v._volume*n)}return s}return s._volume},mute:function(n){var s=this||e;s.ctx||_(),s._muted=n,s.usingWebAudio&&s.masterGain.gain.setValueAtTime(n?0:s._volume,e.ctx.currentTime);for(var c=0;c<s._howls.length;c++)if(!s._howls[c]._webAudio)for(var f=s._howls[c]._getSoundIds(),p=0;p<f.length;p++){var v=s._howls[c]._soundById(f[p]);v&&v._node&&(v._node.muted=n?!0:v._muted)}return s},stop:function(){for(var n=this||e,s=0;s<n._howls.length;s++)n._howls[s].stop();return n},unload:function(){for(var n=this||e,s=n._howls.length-1;s>=0;s--)n._howls[s].unload();return n.usingWebAudio&&n.ctx&&typeof n.ctx.close<"u"&&(n.ctx.close(),n.ctx=null,_()),n},codecs:function(n){return(this||e)._codecs[n.replace(/^x-/,"")]},_setup:function(){var n=this||e;if(n.state=n.ctx&&n.ctx.state||"suspended",n._autoSuspend(),!n.usingWebAudio)if(typeof Audio<"u")try{var s=new Audio;typeof s.oncanplaythrough>"u"&&(n._canPlayEvent="canplay")}catch{n.noAudio=!0}else n.noAudio=!0;try{var s=new Audio;s.muted&&(n.noAudio=!0)}catch{}return n.noAudio||n._setupCodecs(),n},_setupCodecs:function(){var n=this||e,s=null;try{s=typeof Audio<"u"?new Audio:null}catch{return n}if(!s||typeof s.canPlayType!="function")return n;var c=s.canPlayType("audio/mpeg;").replace(/^no$/,""),f=n._navigator?n._navigator.userAgent:"",p=f.match(/OPR\/([0-6].)/g),v=p&&parseInt(p[0].split("/")[1],10)<33,y=f.indexOf("Safari")!==-1&&f.indexOf("Chrome")===-1,b=f.match(/Version\/(.*?) /),T=y&&b&&parseInt(b[1],10)<15;return n._codecs={mp3:!!(!v&&(c||s.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!c,opus:!!s.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!s.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!s.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(s.canPlayType('audio/wav; codecs="1"')||s.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!s.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!s.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(s.canPlayType("audio/x-m4a;")||s.canPlayType("audio/m4a;")||s.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(s.canPlayType("audio/x-m4b;")||s.canPlayType("audio/m4b;")||s.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(s.canPlayType("audio/x-mp4;")||s.canPlayType("audio/mp4;")||s.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!T&&s.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!T&&s.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!s.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(s.canPlayType("audio/x-flac;")||s.canPlayType("audio/flac;")).replace(/^no$/,"")},n},_unlockAudio:function(){var n=this||e;if(!(n._audioUnlocked||!n.ctx)){n._audioUnlocked=!1,n.autoUnlock=!1,!n._mobileUnloaded&&n.ctx.sampleRate!==44100&&(n._mobileUnloaded=!0,n.unload()),n._scratchBuffer=n.ctx.createBuffer(1,1,22050);var s=function(c){for(;n._html5AudioPool.length<n.html5PoolSize;)try{var f=new Audio;f._unlocked=!0,n._releaseHtml5Audio(f)}catch{n.noAudio=!0;break}for(var p=0;p<n._howls.length;p++)if(!n._howls[p]._webAudio)for(var v=n._howls[p]._getSoundIds(),y=0;y<v.length;y++){var b=n._howls[p]._soundById(v[y]);b&&b._node&&!b._node._unlocked&&(b._node._unlocked=!0,b._node.load())}n._autoResume();var T=n.ctx.createBufferSource();T.buffer=n._scratchBuffer,T.connect(n.ctx.destination),typeof T.start>"u"?T.noteOn(0):T.start(0),typeof n.ctx.resume=="function"&&n.ctx.resume(),T.onended=function(){T.disconnect(0),n._audioUnlocked=!0,document.removeEventListener("touchstart",s,!0),document.removeEventListener("touchend",s,!0),document.removeEventListener("click",s,!0),document.removeEventListener("keydown",s,!0);for(var E=0;E<n._howls.length;E++)n._howls[E]._emit("unlock")}};return document.addEventListener("touchstart",s,!0),document.addEventListener("touchend",s,!0),document.addEventListener("click",s,!0),document.addEventListener("keydown",s,!0),n}},_obtainHtml5Audio:function(){var n=this||e;if(n._html5AudioPool.length)return n._html5AudioPool.pop();var s=new Audio().play();return s&&typeof Promise<"u"&&(s instanceof Promise||typeof s.then=="function")&&s.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(n){var s=this||e;return n._unlocked&&s._html5AudioPool.push(n),s},_autoSuspend:function(){var n=this;if(!(!n.autoSuspend||!n.ctx||typeof n.ctx.suspend>"u"||!e.usingWebAudio)){for(var s=0;s<n._howls.length;s++)if(n._howls[s]._webAudio){for(var c=0;c<n._howls[s]._sounds.length;c++)if(!n._howls[s]._sounds[c]._paused)return n}return n._suspendTimer&&clearTimeout(n._suspendTimer),n._suspendTimer=setTimeout(function(){if(n.autoSuspend){n._suspendTimer=null,n.state="suspending";var f=function(){n.state="suspended",n._resumeAfterSuspend&&(delete n._resumeAfterSuspend,n._autoResume())};n.ctx.suspend().then(f,f)}},3e4),n}},_autoResume:function(){var n=this;if(!(!n.ctx||typeof n.ctx.resume>"u"||!e.usingWebAudio))return n.state==="running"&&n.ctx.state!=="interrupted"&&n._suspendTimer?(clearTimeout(n._suspendTimer),n._suspendTimer=null):n.state==="suspended"||n.state==="running"&&n.ctx.state==="interrupted"?(n.ctx.resume().then(function(){n.state="running";for(var s=0;s<n._howls.length;s++)n._howls[s]._emit("resume")}),n._suspendTimer&&(clearTimeout(n._suspendTimer),n._suspendTimer=null)):n.state==="suspending"&&(n._resumeAfterSuspend=!0),n}};var e=new t,r=function(n){var s=this;if(!n.src||n.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}s.init(n)};r.prototype={init:function(n){var s=this;return e.ctx||_(),s._autoplay=n.autoplay||!1,s._format=typeof n.format!="string"?n.format:[n.format],s._html5=n.html5||!1,s._muted=n.mute||!1,s._loop=n.loop||!1,s._pool=n.pool||5,s._preload=typeof n.preload=="boolean"||n.preload==="metadata"?n.preload:!0,s._rate=n.rate||1,s._sprite=n.sprite||{},s._src=typeof n.src!="string"?n.src:[n.src],s._volume=n.volume!==void 0?n.volume:1,s._xhr={method:n.xhr&&n.xhr.method?n.xhr.method:"GET",headers:n.xhr&&n.xhr.headers?n.xhr.headers:null,withCredentials:n.xhr&&n.xhr.withCredentials?n.xhr.withCredentials:!1},s._duration=0,s._state="unloaded",s._sounds=[],s._endTimers={},s._queue=[],s._playLock=!1,s._onend=n.onend?[{fn:n.onend}]:[],s._onfade=n.onfade?[{fn:n.onfade}]:[],s._onload=n.onload?[{fn:n.onload}]:[],s._onloaderror=n.onloaderror?[{fn:n.onloaderror}]:[],s._onplayerror=n.onplayerror?[{fn:n.onplayerror}]:[],s._onpause=n.onpause?[{fn:n.onpause}]:[],s._onplay=n.onplay?[{fn:n.onplay}]:[],s._onstop=n.onstop?[{fn:n.onstop}]:[],s._onmute=n.onmute?[{fn:n.onmute}]:[],s._onvolume=n.onvolume?[{fn:n.onvolume}]:[],s._onrate=n.onrate?[{fn:n.onrate}]:[],s._onseek=n.onseek?[{fn:n.onseek}]:[],s._onunlock=n.onunlock?[{fn:n.onunlock}]:[],s._onresume=[],s._webAudio=e.usingWebAudio&&!s._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(s),s._autoplay&&s._queue.push({event:"play",action:function(){s.play()}}),s._preload&&s._preload!=="none"&&s.load(),s},load:function(){var n=this,s=null;if(e.noAudio){n._emit("loaderror",null,"No audio support.");return}typeof n._src=="string"&&(n._src=[n._src]);for(var c=0;c<n._src.length;c++){var f,p;if(n._format&&n._format[c])f=n._format[c];else{if(p=n._src[c],typeof p!="string"){n._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}f=/^data:audio\/([^;,]+);/i.exec(p),f||(f=/\.([^.]+)$/.exec(p.split("?",1)[0])),f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),f&&e.codecs(f)){s=n._src[c];break}}if(!s){n._emit("loaderror",null,"No codec support for selected audio sources.");return}return n._src=s,n._state="loading",window.location.protocol==="https:"&&s.slice(0,5)==="http:"&&(n._html5=!0,n._webAudio=!1),new i(n),n._webAudio&&l(n),n},play:function(n,s){var c=this,f=null;if(typeof n=="number")f=n,n=null;else{if(typeof n=="string"&&c._state==="loaded"&&!c._sprite[n])return null;if(typeof n>"u"&&(n="__default",!c._playLock)){for(var p=0,v=0;v<c._sounds.length;v++)c._sounds[v]._paused&&!c._sounds[v]._ended&&(p++,f=c._sounds[v]._id);p===1?n=null:f=null}}var y=f?c._soundById(f):c._inactiveSound();if(!y)return null;if(f&&!n&&(n=y._sprite||"__default"),c._state!=="loaded"){y._sprite=n,y._ended=!1;var b=y._id;return c._queue.push({event:"play",action:function(){c.play(b)}}),b}if(f&&!y._paused)return s||c._loadQueue("play"),y._id;c._webAudio&&e._autoResume();var T=Math.max(0,y._seek>0?y._seek:c._sprite[n][0]/1e3),E=Math.max(0,(c._sprite[n][0]+c._sprite[n][1])/1e3-T),$=E*1e3/Math.abs(y._rate),U=c._sprite[n][0]/1e3,M=(c._sprite[n][0]+c._sprite[n][1])/1e3;y._sprite=n,y._ended=!1;var F=function(){y._paused=!1,y._seek=T,y._start=U,y._stop=M,y._loop=!!(y._loop||c._sprite[n][2])};if(T>=M){c._ended(y);return}var I=y._node;if(c._webAudio){var G=function(){c._playLock=!1,F(),c._refreshBuffer(y);var m=y._muted||c._muted?0:y._volume;I.gain.setValueAtTime(m,e.ctx.currentTime),y._playStart=e.ctx.currentTime,typeof I.bufferSource.start>"u"?y._loop?I.bufferSource.noteGrainOn(0,T,86400):I.bufferSource.noteGrainOn(0,T,E):y._loop?I.bufferSource.start(0,T,86400):I.bufferSource.start(0,T,E),$!==1/0&&(c._endTimers[y._id]=setTimeout(c._ended.bind(c,y),$)),s||setTimeout(function(){c._emit("play",y._id),c._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?G():(c._playLock=!0,c.once("resume",G),c._clearTimer(y._id))}else{var D=function(){I.currentTime=T,I.muted=y._muted||c._muted||e._muted||I.muted,I.volume=y._volume*e.volume(),I.playbackRate=y._rate;try{var m=I.play();if(m&&typeof Promise<"u"&&(m instanceof Promise||typeof m.then=="function")?(c._playLock=!0,F(),m.then(function(){c._playLock=!1,I._unlocked=!0,s?c._loadQueue():c._emit("play",y._id)}).catch(function(){c._playLock=!1,c._emit("playerror",y._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),y._ended=!0,y._paused=!0})):s||(c._playLock=!1,F(),c._emit("play",y._id)),I.playbackRate=y._rate,I.paused){c._emit("playerror",y._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}n!=="__default"||y._loop?c._endTimers[y._id]=setTimeout(c._ended.bind(c,y),$):(c._endTimers[y._id]=function(){c._ended(y),I.removeEventListener("ended",c._endTimers[y._id],!1)},I.addEventListener("ended",c._endTimers[y._id],!1))}catch(g){c._emit("playerror",y._id,g)}};I.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(I.src=c._src,I.load());var X=window&&window.ejecta||!I.readyState&&e._navigator.isCocoonJS;if(I.readyState>=3||X)D();else{c._playLock=!0,c._state="loading";var Q=function(){c._state="loaded",D(),I.removeEventListener(e._canPlayEvent,Q,!1)};I.addEventListener(e._canPlayEvent,Q,!1),c._clearTimer(y._id)}}return y._id},pause:function(n){var s=this;if(s._state!=="loaded"||s._playLock)return s._queue.push({event:"pause",action:function(){s.pause(n)}}),s;for(var c=s._getSoundIds(n),f=0;f<c.length;f++){s._clearTimer(c[f]);var p=s._soundById(c[f]);if(p&&!p._paused&&(p._seek=s.seek(c[f]),p._rateSeek=0,p._paused=!0,s._stopFade(c[f]),p._node))if(s._webAudio){if(!p._node.bufferSource)continue;typeof p._node.bufferSource.stop>"u"?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0),s._cleanBuffer(p._node)}else(!isNaN(p._node.duration)||p._node.duration===1/0)&&p._node.pause();arguments[1]||s._emit("pause",p?p._id:null)}return s},stop:function(n,s){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"stop",action:function(){c.stop(n)}}),c;for(var f=c._getSoundIds(n),p=0;p<f.length;p++){c._clearTimer(f[p]);var v=c._soundById(f[p]);v&&(v._seek=v._start||0,v._rateSeek=0,v._paused=!0,v._ended=!0,c._stopFade(f[p]),v._node&&(c._webAudio?v._node.bufferSource&&(typeof v._node.bufferSource.stop>"u"?v._node.bufferSource.noteOff(0):v._node.bufferSource.stop(0),c._cleanBuffer(v._node)):(!isNaN(v._node.duration)||v._node.duration===1/0)&&(v._node.currentTime=v._start||0,v._node.pause(),v._node.duration===1/0&&c._clearSound(v._node))),s||c._emit("stop",v._id))}return c},mute:function(n,s){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"mute",action:function(){c.mute(n,s)}}),c;if(typeof s>"u")if(typeof n=="boolean")c._muted=n;else return c._muted;for(var f=c._getSoundIds(s),p=0;p<f.length;p++){var v=c._soundById(f[p]);v&&(v._muted=n,v._interval&&c._stopFade(v._id),c._webAudio&&v._node?v._node.gain.setValueAtTime(n?0:v._volume,e.ctx.currentTime):v._node&&(v._node.muted=e._muted?!0:n),c._emit("mute",v._id))}return c},volume:function(){var n=this,s=arguments,c,f;if(s.length===0)return n._volume;if(s.length===1||s.length===2&&typeof s[1]>"u"){var p=n._getSoundIds(),v=p.indexOf(s[0]);v>=0?f=parseInt(s[0],10):c=parseFloat(s[0])}else s.length>=2&&(c=parseFloat(s[0]),f=parseInt(s[1],10));var y;if(typeof c<"u"&&c>=0&&c<=1){if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,s)}}),n;typeof f>"u"&&(n._volume=c),f=n._getSoundIds(f);for(var b=0;b<f.length;b++)y=n._soundById(f[b]),y&&(y._volume=c,s[2]||n._stopFade(f[b]),n._webAudio&&y._node&&!y._muted?y._node.gain.setValueAtTime(c,e.ctx.currentTime):y._node&&!y._muted&&(y._node.volume=c*e.volume()),n._emit("volume",y._id))}else return y=f?n._soundById(f):n._sounds[0],y?y._volume:0;return n},fade:function(n,s,c,f){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"fade",action:function(){p.fade(n,s,c,f)}}),p;n=Math.min(Math.max(0,parseFloat(n)),1),s=Math.min(Math.max(0,parseFloat(s)),1),c=parseFloat(c),p.volume(n,f);for(var v=p._getSoundIds(f),y=0;y<v.length;y++){var b=p._soundById(v[y]);if(b){if(f||p._stopFade(v[y]),p._webAudio&&!b._muted){var T=e.ctx.currentTime,E=T+c/1e3;b._volume=n,b._node.gain.setValueAtTime(n,T),b._node.gain.linearRampToValueAtTime(s,E)}p._startFadeInterval(b,n,s,c,v[y],typeof f>"u")}}return p},_startFadeInterval:function(n,s,c,f,p,v){var y=this,b=s,T=c-s,E=Math.abs(T/.01),$=Math.max(4,E>0?f/E:f),U=Date.now();n._fadeTo=c,n._interval=setInterval(function(){var M=(Date.now()-U)/f;U=Date.now(),b+=T*M,b=Math.round(b*100)/100,T<0?b=Math.max(c,b):b=Math.min(c,b),y._webAudio?n._volume=b:y.volume(b,n._id,!0),v&&(y._volume=b),(c<s&&b<=c||c>s&&b>=c)&&(clearInterval(n._interval),n._interval=null,n._fadeTo=null,y.volume(c,n._id),y._emit("fade",n._id))},$)},_stopFade:function(n){var s=this,c=s._soundById(n);return c&&c._interval&&(s._webAudio&&c._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(c._interval),c._interval=null,s.volume(c._fadeTo,n),c._fadeTo=null,s._emit("fade",n)),s},loop:function(){var n=this,s=arguments,c,f,p;if(s.length===0)return n._loop;if(s.length===1)if(typeof s[0]=="boolean")c=s[0],n._loop=c;else return p=n._soundById(parseInt(s[0],10)),p?p._loop:!1;else s.length===2&&(c=s[0],f=parseInt(s[1],10));for(var v=n._getSoundIds(f),y=0;y<v.length;y++)p=n._soundById(v[y]),p&&(p._loop=c,n._webAudio&&p._node&&p._node.bufferSource&&(p._node.bufferSource.loop=c,c&&(p._node.bufferSource.loopStart=p._start||0,p._node.bufferSource.loopEnd=p._stop,n.playing(v[y])&&(n.pause(v[y],!0),n.play(v[y],!0)))));return n},rate:function(){var n=this,s=arguments,c,f;if(s.length===0)f=n._sounds[0]._id;else if(s.length===1){var p=n._getSoundIds(),v=p.indexOf(s[0]);v>=0?f=parseInt(s[0],10):c=parseFloat(s[0])}else s.length===2&&(c=parseFloat(s[0]),f=parseInt(s[1],10));var y;if(typeof c=="number"){if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,s)}}),n;typeof f>"u"&&(n._rate=c),f=n._getSoundIds(f);for(var b=0;b<f.length;b++)if(y=n._soundById(f[b]),y){n.playing(f[b])&&(y._rateSeek=n.seek(f[b]),y._playStart=n._webAudio?e.ctx.currentTime:y._playStart),y._rate=c,n._webAudio&&y._node&&y._node.bufferSource?y._node.bufferSource.playbackRate.setValueAtTime(c,e.ctx.currentTime):y._node&&(y._node.playbackRate=c);var T=n.seek(f[b]),E=(n._sprite[y._sprite][0]+n._sprite[y._sprite][1])/1e3-T,$=E*1e3/Math.abs(y._rate);(n._endTimers[f[b]]||!y._paused)&&(n._clearTimer(f[b]),n._endTimers[f[b]]=setTimeout(n._ended.bind(n,y),$)),n._emit("rate",y._id)}}else return y=n._soundById(f),y?y._rate:n._rate;return n},seek:function(){var n=this,s=arguments,c,f;if(s.length===0)n._sounds.length&&(f=n._sounds[0]._id);else if(s.length===1){var p=n._getSoundIds(),v=p.indexOf(s[0]);v>=0?f=parseInt(s[0],10):n._sounds.length&&(f=n._sounds[0]._id,c=parseFloat(s[0]))}else s.length===2&&(c=parseFloat(s[0]),f=parseInt(s[1],10));if(typeof f>"u")return 0;if(typeof c=="number"&&(n._state!=="loaded"||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,s)}}),n;var y=n._soundById(f);if(y)if(typeof c=="number"&&c>=0){var b=n.playing(f);b&&n.pause(f,!0),y._seek=c,y._ended=!1,n._clearTimer(f),!n._webAudio&&y._node&&!isNaN(y._node.duration)&&(y._node.currentTime=c);var T=function(){b&&n.play(f,!0),n._emit("seek",f)};if(b&&!n._webAudio){var E=function(){n._playLock?setTimeout(E,0):T()};setTimeout(E,0)}else T()}else if(n._webAudio){var $=n.playing(f)?e.ctx.currentTime-y._playStart:0,U=y._rateSeek?y._rateSeek-y._seek:0;return y._seek+(U+$*Math.abs(y._rate))}else return y._node.currentTime;return n},playing:function(n){var s=this;if(typeof n=="number"){var c=s._soundById(n);return c?!c._paused:!1}for(var f=0;f<s._sounds.length;f++)if(!s._sounds[f]._paused)return!0;return!1},duration:function(n){var s=this,c=s._duration,f=s._soundById(n);return f&&(c=s._sprite[f._sprite][1]/1e3),c},state:function(){return this._state},unload:function(){for(var n=this,s=n._sounds,c=0;c<s.length;c++)s[c]._paused||n.stop(s[c]._id),n._webAudio||(n._clearSound(s[c]._node),s[c]._node.removeEventListener("error",s[c]._errorFn,!1),s[c]._node.removeEventListener(e._canPlayEvent,s[c]._loadFn,!1),s[c]._node.removeEventListener("ended",s[c]._endFn,!1),e._releaseHtml5Audio(s[c]._node)),delete s[c]._node,n._clearTimer(s[c]._id);var f=e._howls.indexOf(n);f>=0&&e._howls.splice(f,1);var p=!0;for(c=0;c<e._howls.length;c++)if(e._howls[c]._src===n._src||n._src.indexOf(e._howls[c]._src)>=0){p=!1;break}return o&&p&&delete o[n._src],e.noAudio=!1,n._state="unloaded",n._sounds=[],n=null,null},on:function(n,s,c,f){var p=this,v=p["_on"+n];return typeof s=="function"&&v.push(f?{id:c,fn:s,once:f}:{id:c,fn:s}),p},off:function(n,s,c){var f=this,p=f["_on"+n],v=0;if(typeof s=="number"&&(c=s,s=null),s||c)for(v=0;v<p.length;v++){var y=c===p[v].id;if(s===p[v].fn&&y||!s&&y){p.splice(v,1);break}}else if(n)f["_on"+n]=[];else{var b=Object.keys(f);for(v=0;v<b.length;v++)b[v].indexOf("_on")===0&&Array.isArray(f[b[v]])&&(f[b[v]]=[])}return f},once:function(n,s,c){var f=this;return f.on(n,s,c,1),f},_emit:function(n,s,c){for(var f=this,p=f["_on"+n],v=p.length-1;v>=0;v--)(!p[v].id||p[v].id===s||n==="load")&&(setTimeout(function(y){y.call(this,s,c)}.bind(f,p[v].fn),0),p[v].once&&f.off(n,p[v].fn,p[v].id));return f._loadQueue(n),f},_loadQueue:function(n){var s=this;if(s._queue.length>0){var c=s._queue[0];c.event===n&&(s._queue.shift(),s._loadQueue()),n||c.action()}return s},_ended:function(n){var s=this,c=n._sprite;if(!s._webAudio&&n._node&&!n._node.paused&&!n._node.ended&&n._node.currentTime<n._stop)return setTimeout(s._ended.bind(s,n),100),s;var f=!!(n._loop||s._sprite[c][2]);if(s._emit("end",n._id),!s._webAudio&&f&&s.stop(n._id,!0).play(n._id),s._webAudio&&f){s._emit("play",n._id),n._seek=n._start||0,n._rateSeek=0,n._playStart=e.ctx.currentTime;var p=(n._stop-n._start)*1e3/Math.abs(n._rate);s._endTimers[n._id]=setTimeout(s._ended.bind(s,n),p)}return s._webAudio&&!f&&(n._paused=!0,n._ended=!0,n._seek=n._start||0,n._rateSeek=0,s._clearTimer(n._id),s._cleanBuffer(n._node),e._autoSuspend()),!s._webAudio&&!f&&s.stop(n._id,!0),s},_clearTimer:function(n){var s=this;if(s._endTimers[n]){if(typeof s._endTimers[n]!="function")clearTimeout(s._endTimers[n]);else{var c=s._soundById(n);c&&c._node&&c._node.removeEventListener("ended",s._endTimers[n],!1)}delete s._endTimers[n]}return s},_soundById:function(n){for(var s=this,c=0;c<s._sounds.length;c++)if(n===s._sounds[c]._id)return s._sounds[c];return null},_inactiveSound:function(){var n=this;n._drain();for(var s=0;s<n._sounds.length;s++)if(n._sounds[s]._ended)return n._sounds[s].reset();return new i(n)},_drain:function(){var n=this,s=n._pool,c=0,f=0;if(!(n._sounds.length<s)){for(f=0;f<n._sounds.length;f++)n._sounds[f]._ended&&c++;for(f=n._sounds.length-1;f>=0;f--){if(c<=s)return;n._sounds[f]._ended&&(n._webAudio&&n._sounds[f]._node&&n._sounds[f]._node.disconnect(0),n._sounds.splice(f,1),c--)}}},_getSoundIds:function(n){var s=this;if(typeof n>"u"){for(var c=[],f=0;f<s._sounds.length;f++)c.push(s._sounds[f]._id);return c}else return[n]},_refreshBuffer:function(n){var s=this;return n._node.bufferSource=e.ctx.createBufferSource(),n._node.bufferSource.buffer=o[s._src],n._panner?n._node.bufferSource.connect(n._panner):n._node.bufferSource.connect(n._node),n._node.bufferSource.loop=n._loop,n._loop&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop||0),n._node.bufferSource.playbackRate.setValueAtTime(n._rate,e.ctx.currentTime),s},_cleanBuffer:function(n){var s=this,c=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&n.bufferSource&&(n.bufferSource.onended=null,n.bufferSource.disconnect(0),c))try{n.bufferSource.buffer=e._scratchBuffer}catch{}return n.bufferSource=null,s},_clearSound:function(n){var s=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);s||(n.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(n){this._parent=n,this.init()};i.prototype={init:function(){var n=this,s=n._parent;return n._muted=s._muted,n._loop=s._loop,n._volume=s._volume,n._rate=s._rate,n._seek=0,n._paused=!0,n._ended=!0,n._sprite="__default",n._id=++e._counter,s._sounds.push(n),n.create(),n},create:function(){var n=this,s=n._parent,c=e._muted||n._muted||n._parent._muted?0:n._volume;return s._webAudio?(n._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),n._node.gain.setValueAtTime(c,e.ctx.currentTime),n._node.paused=!0,n._node.connect(e.masterGain)):e.noAudio||(n._node=e._obtainHtml5Audio(),n._errorFn=n._errorListener.bind(n),n._node.addEventListener("error",n._errorFn,!1),n._loadFn=n._loadListener.bind(n),n._node.addEventListener(e._canPlayEvent,n._loadFn,!1),n._endFn=n._endListener.bind(n),n._node.addEventListener("ended",n._endFn,!1),n._node.src=s._src,n._node.preload=s._preload===!0?"auto":s._preload,n._node.volume=c*e.volume(),n._node.load()),n},reset:function(){var n=this,s=n._parent;return n._muted=s._muted,n._loop=s._loop,n._volume=s._volume,n._rate=s._rate,n._seek=0,n._rateSeek=0,n._paused=!0,n._ended=!0,n._sprite="__default",n._id=++e._counter,n},_errorListener:function(){var n=this;n._parent._emit("loaderror",n._id,n._node.error?n._node.error.code:0),n._node.removeEventListener("error",n._errorFn,!1)},_loadListener:function(){var n=this,s=n._parent;s._duration=Math.ceil(n._node.duration*10)/10,Object.keys(s._sprite).length===0&&(s._sprite={__default:[0,s._duration*1e3]}),s._state!=="loaded"&&(s._state="loaded",s._emit("load"),s._loadQueue()),n._node.removeEventListener(e._canPlayEvent,n._loadFn,!1)},_endListener:function(){var n=this,s=n._parent;s._duration===1/0&&(s._duration=Math.ceil(n._node.duration*10)/10,s._sprite.__default[1]===1/0&&(s._sprite.__default[1]=s._duration*1e3),s._ended(n)),n._node.removeEventListener("ended",n._endFn,!1)}};var o={},l=function(n){var s=n._src;if(o[s]){n._duration=o[s].duration,u(n);return}if(/^data:[^;]+;base64,/.test(s)){for(var c=atob(s.split(",")[1]),f=new Uint8Array(c.length),p=0;p<c.length;++p)f[p]=c.charCodeAt(p);d(f.buffer,n)}else{var v=new XMLHttpRequest;v.open(n._xhr.method,s,!0),v.withCredentials=n._xhr.withCredentials,v.responseType="arraybuffer",n._xhr.headers&&Object.keys(n._xhr.headers).forEach(function(y){v.setRequestHeader(y,n._xhr.headers[y])}),v.onload=function(){var y=(v.status+"")[0];if(y!=="0"&&y!=="2"&&y!=="3"){n._emit("loaderror",null,"Failed loading audio file with status: "+v.status+".");return}d(v.response,n)},v.onerror=function(){n._webAudio&&(n._html5=!0,n._webAudio=!1,n._sounds=[],delete o[s],n.load())},h(v)}},h=function(n){try{n.send()}catch{n.onerror()}},d=function(n,s){var c=function(){s._emit("loaderror",null,"Decoding audio data failed.")},f=function(p){p&&s._sounds.length>0?(o[s._src]=p,u(s,p)):c()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(n).then(f).catch(c):e.ctx.decodeAudioData(n,f,c)},u=function(n,s){s&&!n._duration&&(n._duration=s.duration),Object.keys(n._sprite).length===0&&(n._sprite={__default:[0,n._duration*1e3]}),n._state!=="loaded"&&(n._state="loaded",n._emit("load"),n._loadQueue())},_=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var n=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),s=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),c=s?parseInt(s[1],10):null;if(n&&c&&c<9){var f=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!f&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};a.Howler=e,a.Howl=r,typeof me<"u"?(me.HowlerGlobal=t,me.Howler=e,me.Howl=r,me.Sound=i):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=r,window.Sound=i)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var r=this;if(!r.ctx||!r.ctx.listener)return r;for(var i=r._howls.length-1;i>=0;i--)r._howls[i].stereo(e);return r},HowlerGlobal.prototype.pos=function(e,r,i){var o=this;if(!o.ctx||!o.ctx.listener)return o;if(r=typeof r!="number"?o._pos[1]:r,i=typeof i!="number"?o._pos[2]:i,typeof e=="number")o._pos=[e,r,i],typeof o.ctx.listener.positionX<"u"?(o.ctx.listener.positionX.setTargetAtTime(o._pos[0],Howler.ctx.currentTime,.1),o.ctx.listener.positionY.setTargetAtTime(o._pos[1],Howler.ctx.currentTime,.1),o.ctx.listener.positionZ.setTargetAtTime(o._pos[2],Howler.ctx.currentTime,.1)):o.ctx.listener.setPosition(o._pos[0],o._pos[1],o._pos[2]);else return o._pos;return o},HowlerGlobal.prototype.orientation=function(e,r,i,o,l,h){var d=this;if(!d.ctx||!d.ctx.listener)return d;var u=d._orientation;if(r=typeof r!="number"?u[1]:r,i=typeof i!="number"?u[2]:i,o=typeof o!="number"?u[3]:o,l=typeof l!="number"?u[4]:l,h=typeof h!="number"?u[5]:h,typeof e=="number")d._orientation=[e,r,i,o,l,h],typeof d.ctx.listener.forwardX<"u"?(d.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),d.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),d.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),d.ctx.listener.upX.setTargetAtTime(o,Howler.ctx.currentTime,.1),d.ctx.listener.upY.setTargetAtTime(l,Howler.ctx.currentTime,.1),d.ctx.listener.upZ.setTargetAtTime(h,Howler.ctx.currentTime,.1)):d.ctx.listener.setOrientation(e,r,i,o,l,h);else return u;return d},Howl.prototype.init=function(e){return function(r){var i=this;return i._orientation=r.orientation||[1,0,0],i._stereo=r.stereo||null,i._pos=r.pos||null,i._pannerAttr={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:360,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:360,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:0,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:"inverse",maxDistance:typeof r.maxDistance<"u"?r.maxDistance:1e4,panningModel:typeof r.panningModel<"u"?r.panningModel:"HRTF",refDistance:typeof r.refDistance<"u"?r.refDistance:1,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:1},i._onstereo=r.onstereo?[{fn:r.onstereo}]:[],i._onpos=r.onpos?[{fn:r.onpos}]:[],i._onorientation=r.onorientation?[{fn:r.onorientation}]:[],e.call(this,r)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,r){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(e,r)}}),i;var o=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof r>"u")if(typeof e=="number")i._stereo=e,i._pos=[e,0,0];else return i._stereo;for(var l=i._getSoundIds(r),h=0;h<l.length;h++){var d=i._soundById(l[h]);if(d)if(typeof e=="number")d._stereo=e,d._pos=[e,0,0],d._node&&(d._pannerAttr.panningModel="equalpower",(!d._panner||!d._panner.pan)&&t(d,o),o==="spatial"?typeof d._panner.positionX<"u"?(d._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),d._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),d._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):d._panner.setPosition(e,0,0):d._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),i._emit("stereo",d._id);else return d._stereo}return i},Howl.prototype.pos=function(e,r,i,o){var l=this;if(!l._webAudio)return l;if(l._state!=="loaded")return l._queue.push({event:"pos",action:function(){l.pos(e,r,i,o)}}),l;if(r=typeof r!="number"?0:r,i=typeof i!="number"?-.5:i,typeof o>"u")if(typeof e=="number")l._pos=[e,r,i];else return l._pos;for(var h=l._getSoundIds(o),d=0;d<h.length;d++){var u=l._soundById(h[d]);if(u)if(typeof e=="number")u._pos=[e,r,i],u._node&&((!u._panner||u._panner.pan)&&t(u,"spatial"),typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setPosition(e,r,i)),l._emit("pos",u._id);else return u._pos}return l},Howl.prototype.orientation=function(e,r,i,o){var l=this;if(!l._webAudio)return l;if(l._state!=="loaded")return l._queue.push({event:"orientation",action:function(){l.orientation(e,r,i,o)}}),l;if(r=typeof r!="number"?l._orientation[1]:r,i=typeof i!="number"?l._orientation[2]:i,typeof o>"u")if(typeof e=="number")l._orientation=[e,r,i];else return l._orientation;for(var h=l._getSoundIds(o),d=0;d<h.length;d++){var u=l._soundById(h[d]);if(u)if(typeof e=="number")u._orientation=[e,r,i],u._node&&(u._panner||(u._pos||(u._pos=l._pos||[0,0,-.5]),t(u,"spatial")),typeof u._panner.orientationX<"u"?(u._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setOrientation(e,r,i)),l._emit("orientation",u._id);else return u._orientation}return l},Howl.prototype.pannerAttr=function(){var e=this,r=arguments,i,o,l;if(!e._webAudio)return e;if(r.length===0)return e._pannerAttr;if(r.length===1)if(typeof r[0]=="object")i=r[0],typeof o>"u"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),e._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle<"u"?i.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle<"u"?i.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain<"u"?i.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel<"u"?i.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance<"u"?i.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof i.pannerAttr.refDistance<"u"?i.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor<"u"?i.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel<"u"?i.pannerAttr.panningModel:e._panningModel});else return l=e._soundById(parseInt(r[0],10)),l?l._pannerAttr:e._pannerAttr;else r.length===2&&(i=r[0],o=parseInt(r[1],10));for(var h=e._getSoundIds(o),d=0;d<h.length;d++)if(l=e._soundById(h[d]),l){var u=l._pannerAttr;u={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:u.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:u.coneOuterGain,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:u.distanceModel,maxDistance:typeof i.maxDistance<"u"?i.maxDistance:u.maxDistance,refDistance:typeof i.refDistance<"u"?i.refDistance:u.refDistance,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:u.rolloffFactor,panningModel:typeof i.panningModel<"u"?i.panningModel:u.panningModel};var _=l._panner;_?(_.coneInnerAngle=u.coneInnerAngle,_.coneOuterAngle=u.coneOuterAngle,_.coneOuterGain=u.coneOuterGain,_.distanceModel=u.distanceModel,_.maxDistance=u.maxDistance,_.refDistance=u.refDistance,_.rolloffFactor=u.rolloffFactor,_.panningModel=u.panningModel):(l._pos||(l._pos=e._pos||[0,0,-.5]),t(l,"spatial"))}return e},Sound.prototype.init=function(e){return function(){var r=this,i=r._parent;r._orientation=i._orientation,r._stereo=i._stereo,r._pos=i._pos,r._pannerAttr=i._pannerAttr,e.call(this),r._stereo?i.stereo(r._stereo):r._pos&&i.pos(r._pos[0],r._pos[1],r._pos[2],r._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var r=this,i=r._parent;return r._orientation=i._orientation,r._stereo=i._stereo,r._pos=i._pos,r._pannerAttr=i._pannerAttr,r._stereo?i.stereo(r._stereo):r._pos?i.pos(r._pos[0],r._pos[1],r._pos[2],r._id):r._panner&&(r._panner.disconnect(0),r._panner=void 0,i._refreshBuffer(r)),e.call(this)}}(Sound.prototype.reset);var t=function(e,r){r=r||"spatial",r==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()})(Rt);var Yt=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const Zt=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...e)=>Yt(void 0,void 0,void 0,function*(){return yield(yield $e(()=>Promise.resolve().then(()=>je),void 0,import.meta.url)).fetch(...e)}):t=fetch,(...e)=>t(...e)};class et extends Error{constructor(t,e="FunctionsError",r){super(t),super.name=e,this.context=r}}class er extends et{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class tr extends et{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class rr extends et{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var nr=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};class ir{constructor(t,{headers:e={},customFetch:r}={}){this.url=t,this.headers=e,this.fetch=Zt(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,e={}){var r;return nr(this,void 0,void 0,function*(){try{const{headers:i,method:o,body:l}=e;let h={},d;l&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",d=l):typeof l=="string"?(h["Content-Type"]="text/plain",d=l):typeof FormData<"u"&&l instanceof FormData?d=l:(h["Content-Type"]="application/json",d=JSON.stringify(l)));const u=yield this.fetch(`${this.url}/${t}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),i),body:d}).catch(c=>{throw new er(c)}),_=u.headers.get("x-relay-error");if(_&&_==="true")throw new tr(u);if(!u.ok)throw new rr(u);let n=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),s;return n==="application/json"?s=yield u.json():n==="application/octet-stream"?s=yield u.blob():n==="multipart/form-data"?s=yield u.formData():s=yield u.text(),{data:s,error:null}}catch(i){return{data:null,error:i}}})}}var Je={exports:{}};(function(a,t){var e=typeof self<"u"?self:me,r=function(){function o(){this.fetch=!1,this.DOMException=e.DOMException}return o.prototype=e,new o}();(function(o){(function(l){var h={searchParams:"URLSearchParams"in o,iterable:"Symbol"in o&&"iterator"in Symbol,blob:"FileReader"in o&&"Blob"in o&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in o,arrayBuffer:"ArrayBuffer"in o};function d(m){return m&&DataView.prototype.isPrototypeOf(m)}if(h.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=ArrayBuffer.isView||function(m){return m&&u.indexOf(Object.prototype.toString.call(m))>-1};function n(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function s(m){return typeof m!="string"&&(m=String(m)),m}function c(m){var g={next:function(){var k=m.shift();return{done:k===void 0,value:k}}};return h.iterable&&(g[Symbol.iterator]=function(){return g}),g}function f(m){this.map={},m instanceof f?m.forEach(function(g,k){this.append(k,g)},this):Array.isArray(m)?m.forEach(function(g){this.append(g[0],g[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(g){this.append(g,m[g])},this)}f.prototype.append=function(m,g){m=n(m),g=s(g);var k=this.map[m];this.map[m]=k?k+", "+g:g},f.prototype.delete=function(m){delete this.map[n(m)]},f.prototype.get=function(m){return m=n(m),this.has(m)?this.map[m]:null},f.prototype.has=function(m){return this.map.hasOwnProperty(n(m))},f.prototype.set=function(m,g){this.map[n(m)]=s(g)},f.prototype.forEach=function(m,g){for(var k in this.map)this.map.hasOwnProperty(k)&&m.call(g,this.map[k],k,this)},f.prototype.keys=function(){var m=[];return this.forEach(function(g,k){m.push(k)}),c(m)},f.prototype.values=function(){var m=[];return this.forEach(function(g){m.push(g)}),c(m)},f.prototype.entries=function(){var m=[];return this.forEach(function(g,k){m.push([k,g])}),c(m)},h.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);function p(m){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}function v(m){return new Promise(function(g,k){m.onload=function(){g(m.result)},m.onerror=function(){k(m.error)}})}function y(m){var g=new FileReader,k=v(g);return g.readAsArrayBuffer(m),k}function b(m){var g=new FileReader,k=v(g);return g.readAsText(m),k}function T(m){for(var g=new Uint8Array(m),k=new Array(g.length),N=0;N<g.length;N++)k[N]=String.fromCharCode(g[N]);return k.join("")}function E(m){if(m.slice)return m.slice(0);var g=new Uint8Array(m.byteLength);return g.set(new Uint8Array(m)),g.buffer}function $(){return this.bodyUsed=!1,this._initBody=function(m){this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:h.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:h.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:h.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():h.arrayBuffer&&h.blob&&d(m)?(this._bodyArrayBuffer=E(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):h.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||_(m))?this._bodyArrayBuffer=E(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):h.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},h.blob&&(this.blob=function(){var m=p(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var m=p(this);if(m)return m;if(this._bodyBlob)return b(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(T(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},h.formData&&(this.formData=function(){return this.text().then(I)}),this.json=function(){return this.text().then(JSON.parse)},this}var U=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function M(m){var g=m.toUpperCase();return U.indexOf(g)>-1?g:m}function F(m,g){g=g||{};var k=g.body;if(m instanceof F){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,g.headers||(this.headers=new f(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!k&&m._bodyInit!=null&&(k=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=g.credentials||this.credentials||"same-origin",(g.headers||!this.headers)&&(this.headers=new f(g.headers)),this.method=M(g.method||this.method||"GET"),this.mode=g.mode||this.mode||null,this.signal=g.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&k)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(k)}F.prototype.clone=function(){return new F(this,{body:this._bodyInit})};function I(m){var g=new FormData;return m.trim().split("&").forEach(function(k){if(k){var N=k.split("="),H=N.shift().replace(/\+/g," "),R=N.join("=").replace(/\+/g," ");g.append(decodeURIComponent(H),decodeURIComponent(R))}}),g}function G(m){var g=new f,k=m.replace(/\r?\n[\t ]+/g," ");return k.split(/\r?\n/).forEach(function(N){var H=N.split(":"),R=H.shift().trim();if(R){var ue=H.join(":").trim();g.append(R,ue)}}),g}$.call(F.prototype);function D(m,g){g||(g={}),this.type="default",this.status=g.status===void 0?200:g.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in g?g.statusText:"OK",this.headers=new f(g.headers),this.url=g.url||"",this._initBody(m)}$.call(D.prototype),D.prototype.clone=function(){return new D(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},D.error=function(){var m=new D(null,{status:0,statusText:""});return m.type="error",m};var X=[301,302,303,307,308];D.redirect=function(m,g){if(X.indexOf(g)===-1)throw new RangeError("Invalid status code");return new D(null,{status:g,headers:{location:m}})},l.DOMException=o.DOMException;try{new l.DOMException}catch{l.DOMException=function(g,k){this.message=g,this.name=k;var N=Error(g);this.stack=N.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function Q(m,g){return new Promise(function(k,N){var H=new F(m,g);if(H.signal&&H.signal.aborted)return N(new l.DOMException("Aborted","AbortError"));var R=new XMLHttpRequest;function ue(){R.abort()}R.onload=function(){var re={status:R.status,statusText:R.statusText,headers:G(R.getAllResponseHeaders()||"")};re.url="responseURL"in R?R.responseURL:re.headers.get("X-Request-URL");var ne="response"in R?R.response:R.responseText;k(new D(ne,re))},R.onerror=function(){N(new TypeError("Network request failed"))},R.ontimeout=function(){N(new TypeError("Network request failed"))},R.onabort=function(){N(new l.DOMException("Aborted","AbortError"))},R.open(H.method,H.url,!0),H.credentials==="include"?R.withCredentials=!0:H.credentials==="omit"&&(R.withCredentials=!1),"responseType"in R&&h.blob&&(R.responseType="blob"),H.headers.forEach(function(re,ne){R.setRequestHeader(ne,re)}),H.signal&&(H.signal.addEventListener("abort",ue),R.onreadystatechange=function(){R.readyState===4&&H.signal.removeEventListener("abort",ue)}),R.send(typeof H._bodyInit>"u"?null:H._bodyInit)})}return Q.polyfill=!0,o.fetch||(o.fetch=Q,o.Headers=f,o.Request=F,o.Response=D),l.Headers=f,l.Request=F,l.Response=D,l.fetch=Q,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;t=i.fetch,t.default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,a.exports=t})(Je,Je.exports);var tt=Je.exports;const rt=Qt(tt),je=Xt({__proto__:null,default:rt},[tt]);class sr{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.allowEmpty=t.allowEmpty,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=rt:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(t,e){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var l,h,d;let u=null,_=null,n=null,s=o.status,c=o.statusText;if(o.ok){if(this.method!=="HEAD"){const y=await o.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?_=y:_=JSON.parse(y))}const p=(l=this.headers.Prefer)===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),v=(h=o.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");p&&v&&v.length>1&&(n=parseInt(v[1]))}else{const p=await o.text();try{u=JSON.parse(p),Array.isArray(u)&&o.status===404&&(_=[],u=null,s=200,c="OK")}catch{o.status===404&&p===""?(s=204,c="No Content"):u={message:p}}if(u&&this.allowEmpty&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("Results contain 0 rows"))&&(u=null,s=200,c="OK"),u&&this.shouldThrowOnError)throw u}return{error:u,data:_,count:n,status:s,statusText:c}});return this.shouldThrowOnError||(i=i.catch(o=>{var l,h,d;return{error:{message:`${(l=o==null?void 0:o.name)!==null&&l!==void 0?l:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(h=o==null?void 0:o.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=o==null?void 0:o.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,e)}}class or extends sr{select(t){let e=!1;const r=(t??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:i}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e}={}){const r=typeof e>"u"?"limit":`${e}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,e,{foreignTable:r}={}){const i=typeof r>"u"?"offset":`${r}.offset`,o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.headers.Accept="application/vnd.pgrst.object+json",this.allowEmpty=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:i=!1,wal:o=!1,format:l="text"}={}){const h=[t?"analyze":null,e?"verbose":null,r?"settings":null,i?"buffers":null,o?"wal":null].filter(Boolean).join("|"),d=this.headers.Accept;return this.headers.Accept=`application/vnd.pgrst.plan+${l}; for="${d}"; options=${h};`,l==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class ye extends or{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){const r=e.map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:i}={}){let o="";i==="plain"?o="pl":i==="phrase"?o="ph":i==="websearch"&&(o="w");const l=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${o}fts${l}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e}={}){const r=e?`${e}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}}class ar{constructor(t,{headers:e={},schema:r,fetch:i}){this.url=t,this.headers=e,this.schema=r,this.fetch=i}select(t,{head:e=!1,count:r}={}){const i=e?"HEAD":"GET";let o=!1;const l=(t??"*").split("").map(h=>/\s/.test(h)&&!o?"":(h==='"'&&(o=!o),h)).join("");return this.url.searchParams.set("select",l),r&&(this.headers.Prefer=`count=${r}`),new ye({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:e,defaultToNull:r=!0}={}){const i="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),e&&o.push(`count=${e}`),r||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(l.length>0){const h=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new ye({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:i,defaultToNull:o=!0}={}){const l="POST",h=[`resolution=${r?"ignore":"merge"}-duplicates`];if(e!==void 0&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&h.push(this.headers.Prefer),i&&h.push(`count=${i}`),o||h.push("missing=default"),this.headers.Prefer=h.join(","),Array.isArray(t)){const d=t.reduce((u,_)=>u.concat(Object.keys(_)),[]);if(d.length>0){const u=[...new Set(d)].map(_=>`"${_}"`);this.url.searchParams.set("columns",u.join(","))}}return new ye({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:e}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),e&&i.push(`count=${e}`),this.headers.Prefer=i.join(","),new ye({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const e="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new ye({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const lr="1.6.0",cr={"X-Client-Info":`postgrest-js/${lr}`};class ur{constructor(t,{headers:e={},schema:r,fetch:i}={}){this.url=t,this.headers=Object.assign(Object.assign({},cr),e),this.schema=r,this.fetch=i}from(t){const e=new URL(`${this.url}/${t}`);return new ar(e,{headers:Object.assign({},this.headers),schema:this.schema,fetch:this.fetch})}rpc(t,e={},{head:r=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${t}`);let h;r?(o="HEAD",Object.entries(e).forEach(([u,_])=>{l.searchParams.append(u,`${_}`)})):(o="POST",h=e);const d=Object.assign({},this.headers);return i&&(d.Prefer=`count=${i}`),new ye({method:o,url:l,headers:d,schema:this.schema,body:h,fetch:this.fetch,allowEmpty:!1})}}var Fe,yt;function dr(){if(yt)return Fe;yt=1;var a=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return Fe=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return a()}try{return __global__||a()}finally{delete Object.prototype.__global__}}(),Fe}const hr="websocket",fr="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",_r=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],pr="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",vr=["Iaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],mr="1.0.34",yr={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},gr="https://github.com/theturtle32/WebSocket-Node",br={node:">=4.0.0"},wr={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},Tr={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},Ar={verbose:!1},Sr={test:"tape test/unit/*.js",gulp:"gulp"},kr="index",Er={lib:"./lib"},Or="lib/browser.js",xr="Apache-2.0",Ir={name:hr,description:fr,keywords:_r,author:pr,contributors:vr,version:mr,repository:yr,homepage:gr,engines:br,dependencies:wr,devDependencies:Tr,config:Ar,scripts:Sr,main:kr,directories:Er,browser:Or,license:xr};var Pr=Ir.version,he;if(typeof globalThis=="object")he=globalThis;else try{he=dr()}catch{}finally{if(!he&&typeof window<"u"&&(he=window),!he)throw new Error("Could not determine global this")}var ke=he.WebSocket||he.MozWebSocket,$r=Pr;function Ct(a,t){var e;return t?e=new ke(a,t):e=new ke(a),e}ke&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(a){Object.defineProperty(Ct,a,{get:function(){return ke[a]}})});var jr={w3cwebsocket:ke?Ct:null,version:$r};const Rr="2.7.2",Cr={"X-Client-Info":`realtime-js/${Rr}`},Dr="1.0.0",Dt=1e4,Lr=1e3;var Ae;(function(a){a[a.connecting=0]="connecting",a[a.open=1]="open",a[a.closing=2]="closing",a[a.closed=3]="closed"})(Ae||(Ae={}));var z;(function(a){a.closed="closed",a.errored="errored",a.joined="joined",a.joining="joining",a.leaving="leaving"})(z||(z={}));var Z;(function(a){a.close="phx_close",a.error="phx_error",a.join="phx_join",a.reply="phx_reply",a.leave="phx_leave",a.access_token="access_token"})(Z||(Z={}));var Ke;(function(a){a.websocket="websocket"})(Ke||(Ke={}));var fe;(function(a){a.Connecting="connecting",a.Open="open",a.Closing="closing",a.Closed="closed"})(fe||(fe={}));class Lt{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class Fr{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const e=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,e,r)}_decodeBroadcast(t,e,r){const i=e.getUint8(1),o=e.getUint8(2);let l=this.HEADER_LENGTH+2;const h=r.decode(t.slice(l,l+i));l=l+i;const d=r.decode(t.slice(l,l+o));l=l+o;const u=JSON.parse(r.decode(t.slice(l,t.byteLength)));return{ref:null,topic:h,event:d,payload:u}}}class Be{constructor(t,e,r={},i=Dt){this.channel=t,this.event=e,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null,this.rateLimited=!1}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){if(this._hasReceived("timeout"))return;this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()})==="rate limited"&&(this.rateLimited=!0)}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var r;return this._hasReceived(t)&&e((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var gt;(function(a){a.SYNC="sync",a.JOIN="join",a.LEAVE="leave"})(gt||(gt={}));class Se{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(e==null?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:o,onLeave:l,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Se.syncState(this.state,i,o,l),this.pendingDiffs.forEach(d=>{this.state=Se.syncDiff(this.state,d,o,l)}),this.pendingDiffs=[],h()}),this.channel._on(r.diff,{},i=>{const{onJoin:o,onLeave:l,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Se.syncDiff(this.state,i,o,l),h())}),this.onJoin((i,o,l)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:o,newPresences:l})}),this.onLeave((i,o,l)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:o,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,r,i){const o=this.cloneDeep(t),l=this.transformState(e),h={},d={};return this.map(o,(u,_)=>{l[u]||(d[u]=_)}),this.map(l,(u,_)=>{const n=o[u];if(n){const s=_.map(v=>v.presence_ref),c=n.map(v=>v.presence_ref),f=_.filter(v=>c.indexOf(v.presence_ref)<0),p=n.filter(v=>s.indexOf(v.presence_ref)<0);f.length>0&&(h[u]=f),p.length>0&&(d[u]=p)}else h[u]=_}),this.syncDiff(o,{joins:h,leaves:d},r,i)}static syncDiff(t,e,r,i){const{joins:o,leaves:l}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(o,(h,d)=>{var u;const _=(u=t[h])!==null&&u!==void 0?u:[];if(t[h]=this.cloneDeep(d),_.length>0){const n=t[h].map(c=>c.presence_ref),s=_.filter(c=>n.indexOf(c.presence_ref)<0);t[h].unshift(...s)}r(h,_,d)}),this.map(l,(h,d)=>{let u=t[h];if(!u)return;const _=d.map(n=>n.presence_ref);u=u.filter(n=>_.indexOf(n.presence_ref)<0),t[h]=u,i(h,u,d),u.length===0&&delete t[h]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(r=>e(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,r)=>{const i=t[r];return"metas"in i?e[r]=i.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):e[r]=i,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var B;(function(a){a.abstime="abstime",a.bool="bool",a.date="date",a.daterange="daterange",a.float4="float4",a.float8="float8",a.int2="int2",a.int4="int4",a.int4range="int4range",a.int8="int8",a.int8range="int8range",a.json="json",a.jsonb="jsonb",a.money="money",a.numeric="numeric",a.oid="oid",a.reltime="reltime",a.text="text",a.time="time",a.timestamp="timestamp",a.timestamptz="timestamptz",a.timetz="timetz",a.tsrange="tsrange",a.tstzrange="tstzrange"})(B||(B={}));const bt=(a,t,e={})=>{var r;const i=(r=e.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((o,l)=>(o[l]=Br(l,a,t,i),o),{})},Br=(a,t,e,r)=>{const i=t.find(h=>h.name===a),o=i==null?void 0:i.type,l=e[a];return o&&!r.includes(o)?Ft(o,l):We(l)},Ft=(a,t)=>{if(a.charAt(0)==="_"){const e=a.slice(1,a.length);return Nr(t,e)}switch(a){case B.bool:return Ur(t);case B.float4:case B.float8:case B.int2:case B.int4:case B.int8:case B.numeric:case B.oid:return Mr(t);case B.json:case B.jsonb:return Hr(t);case B.timestamp:return Gr(t);case B.abstime:case B.date:case B.daterange:case B.int4range:case B.int8range:case B.money:case B.reltime:case B.text:case B.time:case B.timestamptz:case B.timetz:case B.tsrange:case B.tstzrange:return We(t);default:return We(t)}},We=a=>a,Ur=a=>{switch(a){case"t":return!0;case"f":return!1;default:return a}},Mr=a=>{if(typeof a=="string"){const t=parseFloat(a);if(!Number.isNaN(t))return t}return a},Hr=a=>{if(typeof a=="string")try{return JSON.parse(a)}catch(t){return console.log(`JSON parse error: ${t}`),a}return a},Nr=(a,t)=>{if(typeof a!="string")return a;const e=a.length-1,r=a[e];if(a[0]==="{"&&r==="}"){let o;const l=a.slice(1,e);try{o=JSON.parse("["+l+"]")}catch{o=l?l.split(","):[]}return o.map(h=>Ft(t,h))}return a},Gr=a=>typeof a=="string"?a.replace(" ","T"):a;var wt=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})},Tt;(function(a){a.ALL="*",a.INSERT="INSERT",a.UPDATE="UPDATE",a.DELETE="DELETE"})(Tt||(Tt={}));var At;(function(a){a.BROADCAST="broadcast",a.PRESENCE="presence",a.POSTGRES_CHANGES="postgres_changes"})(At||(At={}));var St;(function(a){a.SUBSCRIBED="SUBSCRIBED",a.TIMED_OUT="TIMED_OUT",a.CLOSED="CLOSED",a.CHANNEL_ERROR="CHANNEL_ERROR"})(St||(St={}));class nt{constructor(t,e={config:{}},r){this.topic=t,this.params=e,this.socket=r,this.bindings={},this.state=z.closed,this.joinedOnce=!1,this.pushBuffer=[],this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},e.config),this.timeout=this.socket.timeout,this.joinPush=new Be(this,Z.join,this.params,this.timeout),this.rejoinTimer=new Lt(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=z.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=z.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=z.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=z.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Z.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new Se(this)}subscribe(t,e=this.timeout){var r,i;if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:o,presence:l}}=this.params;this._onError(u=>t&&t("CHANNEL_ERROR",u)),this._onClose(()=>t&&t("CLOSED"));const h={},d={broadcast:o,presence:l,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&i!==void 0?i:[]};this.socket.accessToken&&(h.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:d},h)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",({postgres_changes:u})=>{var _;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){t&&t("SUBSCRIBED");return}else{const n=this.bindings.postgres_changes,s=(_=n==null?void 0:n.length)!==null&&_!==void 0?_:0,c=[];for(let f=0;f<s;f++){const p=n[f],{filter:{event:v,schema:y,table:b,filter:T}}=p,E=u&&u[f];if(E&&E.event===v&&E.schema===y&&E.table===b&&E.filter===T)c.push(Object.assign(Object.assign({},p),{id:E.id}));else{this.unsubscribe(),t&&t("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=c,t&&t("SUBSCRIBED");return}}).receive("error",u=>{t&&t("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t&&t("TIMED_OUT")})}return this}presenceState(){return this.presence.state}track(t,e={}){return wt(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)})}untrack(t={}){return wt(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,e,r){return this._on(t,e,r)}send(t,e={}){return new Promise(r=>{var i,o,l;const h=this._push(t.type,t,e.timeout||this.timeout);h.rateLimited&&r("rate limited"),t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&r("ok"),h.receive("ok",()=>r("ok")),h.receive("timeout",()=>r("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=z.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Z.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const i=new Be(this,Z.leave,{},t);i.receive("ok",()=>{e(),r("ok")}).receive("timeout",()=>{e(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}_push(t,e,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Be(this,t,e,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,e,r){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,r){var i,o;const l=t.toLocaleLowerCase(),{close:h,error:d,leave:u,join:_}=Z;if(r&&[h,d,u,_].indexOf(l)>=0&&r!==this._joinRef())return;let s=this._onMessage(l,e,r);if(e&&!s)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(c=>{var f,p,v;return((f=c.filter)===null||f===void 0?void 0:f.event)==="*"||((v=(p=c.filter)===null||p===void 0?void 0:p.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===l}).map(c=>c.callback(s,r)):(o=this.bindings[l])===null||o===void 0||o.filter(c=>{var f,p,v,y,b,T;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in c){const E=c.id,$=(f=c.filter)===null||f===void 0?void 0:f.event;return E&&((p=e.ids)===null||p===void 0?void 0:p.includes(E))&&($==="*"||($==null?void 0:$.toLocaleLowerCase())===((v=e.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const E=(b=(y=c==null?void 0:c.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return E==="*"||E===((T=e==null?void 0:e.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return c.type.toLocaleLowerCase()===l}).map(c=>{if(typeof s=="object"&&"ids"in s){const f=s.data,{schema:p,table:v,commit_timestamp:y,type:b,errors:T}=f;s=Object.assign(Object.assign({},{schema:p,table:v,commit_timestamp:y,eventType:b,new:{},old:{},errors:T}),this._getPayloadRecords(f))}c.callback(s,r)})}_isClosed(){return this.state===z.closed}_isJoined(){return this.state===z.joined}_isJoining(){return this.state===z.joining}_isLeaving(){return this.state===z.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,r){const i=t.toLocaleLowerCase(),o={type:i,filter:e,callback:r};return this.bindings[i]?this.bindings[i].push(o):this.bindings[i]=[o],this}_off(t,e){const r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var o;return!(((o=i.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===r&&nt.isEqual(i.filter,e))}),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Z.close,{},t)}_onError(t){this._on(Z.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=z.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=bt(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=bt(t.columns,t.old_record)),e}}var Ue=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const Vr=()=>{};class qr{constructor(t,e){var r;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=Cr,this.params={},this.timeout=Dt,this.transport=jr.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Vr,this.conn=null,this.sendBuffer=[],this.serializer=new Fr,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.eventsPerSecondLimitMs=100,this.inThrottle=!1,this.endPoint=`${t}/${Ke.websocket}`,e!=null&&e.params&&(this.params=e.params),e!=null&&e.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e!=null&&e.timeout&&(this.timeout=e.timeout),e!=null&&e.logger&&(this.logger=e.logger),e!=null&&e.transport&&(this.transport=e.transport),e!=null&&e.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);const i=(r=e==null?void 0:e.params)===null||r===void 0?void 0:r.eventsPerSecond;i&&(this.eventsPerSecondLimitMs=Math.floor(1e3/i)),this.reconnectAfterMs=e!=null&&e.reconnectAfterMs?e.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=e!=null&&e.encode?e.encode:(o,l)=>l(JSON.stringify(o)),this.decode=e!=null&&e.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Lt(()=>Ue(this,void 0,void 0,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t)))}disconnect(t,e){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(t){return Ue(this,void 0,void 0,function*(){const e=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),e})}removeAllChannels(){return Ue(this,void 0,void 0,function*(){const t=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),t})}log(t,e,r){this.logger(t,e,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ae.connecting:return fe.Connecting;case Ae.open:return fe.Open;case Ae.closing:return fe.Closing;default:return fe.Closed}}isConnected(){return this.connectionState()===fe.Open}channel(t,e={config:{}}){this.isConnected()||this.connect();const r=new nt(`realtime:${t}`,e,this);return this.channels.push(r),r}push(t){const{topic:e,event:r,payload:i,ref:o}=t;let l=()=>{this.encode(t,h=>{var d;(d=this.conn)===null||d===void 0||d.send(h)})};if(this.log("push",`${e} ${r} (${o})`,i),this.isConnected())if(["broadcast","presence","postgres_changes"].includes(r)){if(this._throttle(l)())return"rate limited"}else l();else this.sendBuffer.push(l)}setAuth(t){this.accessToken=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(Z.access_token,{access_token:t})})}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e._joinRef()!==t._joinRef())}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Dr}))}_onConnMessage(t){this.decode(t.data,e=>{let{topic:r,event:i,payload:o,ref:l}=e;(l&&l===this.pendingHeartbeatRef||i===(o==null?void 0:o.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${o.status||""} ${r} ${i} ${l&&"("+l+")"||""}`,o),this.channels.filter(h=>h._isMember(r)).forEach(h=>h._trigger(i,o,l)),this.stateChangeCallbacks.message.forEach(h=>h(e))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Z.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;const r=t.match(/\?/)?"&":"?",i=new URLSearchParams(e);return`${t}${r}${i}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(Lr,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_throttle(t,e=this.eventsPerSecondLimitMs){return()=>this.inThrottle?!0:(t(),e>0&&(this.inThrottle=!0,setTimeout(()=>{this.inThrottle=!1},e)),!1)}}class it extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function J(a){return typeof a=="object"&&a!==null&&"__isStorageError"in a}class Jr extends it{constructor(t,e){super(t),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class kt extends it{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}var Bt=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const Ut=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...e)=>Bt(void 0,void 0,void 0,function*(){return yield(yield $e(()=>Promise.resolve().then(()=>je),void 0,import.meta.url)).fetch(...e)}):t=fetch,(...e)=>t(...e)},Kr=()=>Bt(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield $e(()=>Promise.resolve().then(()=>je),void 0,import.meta.url)).Response:Response});var ge=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const Me=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),Wr=(a,t)=>ge(void 0,void 0,void 0,function*(){const e=yield Kr();a instanceof e?a.json().then(r=>{t(new Jr(Me(r),a.status||500))}).catch(r=>{t(new kt(Me(r),r))}):t(new kt(Me(a),a))}),zr=(a,t,e,r)=>{const i={method:a,headers:(t==null?void 0:t.headers)||{}};return a==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),e))};function Re(a,t,e,r,i,o){return ge(this,void 0,void 0,function*(){return new Promise((l,h)=>{a(e,zr(t,r,i,o)).then(d=>{if(!d.ok)throw d;return r!=null&&r.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>Wr(d,h))})})}function ze(a,t,e,r){return ge(this,void 0,void 0,function*(){return Re(a,"GET",t,e,r)})}function oe(a,t,e,r,i){return ge(this,void 0,void 0,function*(){return Re(a,"POST",t,r,i,e)})}function Xr(a,t,e,r,i){return ge(this,void 0,void 0,function*(){return Re(a,"PUT",t,r,i,e)})}function Mt(a,t,e,r,i){return ge(this,void 0,void 0,function*(){return Re(a,"DELETE",t,r,i,e)})}var Y=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const Qr={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Et={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Yr{constructor(t,e={},r,i){this.url=t,this.headers=e,this.bucketId=r,this.fetch=Ut(i)}uploadOrUpdate(t,e,r,i){return Y(this,void 0,void 0,function*(){try{let o;const l=Object.assign(Object.assign({},Et),i),h=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",l.cacheControl),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.append("cacheControl",l.cacheControl)):(o=r,h["cache-control"]=`max-age=${l.cacheControl}`,h["content-type"]=l.contentType);const d=this._removeEmptyFolders(e),u=this._getFinalPath(d),_=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:o,headers:h},l!=null&&l.duplex?{duplex:l.duplex}:{}));return _.ok?{data:{path:d},error:null}:{data:null,error:yield _.json()}}catch(o){if(J(o))return{data:null,error:o};throw o}})}upload(t,e,r){return Y(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,r)})}uploadToSignedUrl(t,e,r,i){return Y(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(t),l=this._getFinalPath(o),h=new URL(this.url+`/object/upload/sign/${l}`);h.searchParams.set("token",e);try{let d;const u=Object.assign({upsert:Et.upsert},i),_=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",u.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",u.cacheControl)):(d=r,_["cache-control"]=`max-age=${u.cacheControl}`,_["content-type"]=u.contentType);const n=yield this.fetch(h.toString(),{method:"PUT",body:d,headers:_});return n.ok?{data:{path:o},error:null}:{data:null,error:yield n.json()}}catch(d){if(J(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(t){return Y(this,void 0,void 0,function*(){try{let e=this._getFinalPath(t);const r=yield oe(this.fetch,`${this.url}/object/upload/sign/${e}`,{},{headers:this.headers}),i=new URL(this.url+r.url),o=i.searchParams.get("token");if(!o)throw new it("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(e){if(J(e))return{data:null,error:e};throw e}})}update(t,e,r){return Y(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,r)})}move(t,e){return Y(this,void 0,void 0,function*(){try{return{data:yield oe(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e},{headers:this.headers}),error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}})}copy(t,e){return Y(this,void 0,void 0,function*(){try{return{data:{path:(yield oe(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e},{headers:this.headers})).Key},error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}})}createSignedUrl(t,e,r){return Y(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),o=yield oe(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:e},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${l}`)},{data:o,error:null}}catch(i){if(J(i))return{data:null,error:i};throw i}})}createSignedUrls(t,e,r){return Y(this,void 0,void 0,function*(){try{const i=yield oe(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${o}`):null})),error:null}}catch(i){if(J(i))return{data:null,error:i};throw i}})}download(t,e){return Y(this,void 0,void 0,function*(){const i=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),l=o?`?${o}`:"";try{const h=this._getFinalPath(t);return{data:yield(yield ze(this.fetch,`${this.url}/${i}/${h}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(h){if(J(h))return{data:null,error:h};throw h}})}getPublicUrl(t,e){const r=this._getFinalPath(t),i=[],o=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";o!==""&&i.push(o);const h=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});d!==""&&i.push(d);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${r}${u}`)}}}remove(t){return Y(this,void 0,void 0,function*(){try{return{data:yield Mt(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(J(e))return{data:null,error:e};throw e}})}list(t,e,r){return Y(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Qr),e),{prefix:t||""});return{data:yield oe(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(J(i))return{data:null,error:i};throw i}})}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const Zr="2.5.1",en={"X-Client-Info":`storage-js/${Zr}`};var ve=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};class tn{constructor(t,e={},r){this.url=t,this.headers=Object.assign(Object.assign({},en),e),this.fetch=Ut(r)}listBuckets(){return ve(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(J(t))return{data:null,error:t};throw t}})}getBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(J(e))return{data:null,error:e};throw e}})}createBucket(t,e={public:!1}){return ve(this,void 0,void 0,function*(){try{return{data:yield oe(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}})}updateBucket(t,e){return ve(this,void 0,void 0,function*(){try{return{data:yield Xr(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}})}emptyBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:yield oe(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(J(e))return{data:null,error:e};throw e}})}deleteBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:yield Mt(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(J(e))return{data:null,error:e};throw e}})}}class rn extends tn{constructor(t,e={},r){super(t,e,r)}from(t){return new Yr(this.url,this.headers,t,this.fetch)}}const nn="2.21.0",sn={"X-Client-Info":`supabase-js/${nn}`};var on=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const an=a=>{let t;return a?t=a:typeof fetch>"u"?t=rt:t=fetch,(...e)=>t(...e)},ln=()=>typeof Headers>"u"?tt.Headers:Headers,cn=(a,t,e)=>{const r=an(e),i=ln();return(o,l)=>on(void 0,void 0,void 0,function*(){var h;const d=(h=yield t())!==null&&h!==void 0?h:a;let u=new i(l==null?void 0:l.headers);return u.has("apikey")||u.set("apikey",a),u.has("Authorization")||u.set("Authorization",`Bearer ${d}`),r(o,Object.assign(Object.assign({},l),{headers:u}))})};function un(a){return a.replace(/\/$/,"")}function dn(a,t){const{db:e,auth:r,realtime:i,global:o}=a,{db:l,auth:h,realtime:d,global:u}=t;return{db:Object.assign(Object.assign({},l),e),auth:Object.assign(Object.assign({},h),r),realtime:Object.assign(Object.assign({},d),i),global:Object.assign(Object.assign({},u),o)}}var pe=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};function hn(a){return Math.round(Date.now()/1e3)+a}function fn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){const t=Math.random()*16|0;return(a=="x"?t:t&3|8).toString(16)})}const se=()=>typeof document<"u",de={tested:!1,writable:!1},He=()=>{if(!se())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(de.tested)return de.writable;const a=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(a,a),globalThis.localStorage.removeItem(a),de.tested=!0,de.writable=!0}catch{de.tested=!0,de.writable=!1}return de.writable};function K(a,t){var e;t||(t=((e=window==null?void 0:window.location)===null||e===void 0?void 0:e.href)||""),a=a.replace(/[\[\]]/g,"\\$&");const r=new RegExp("[?&#]"+a+"(=([^&#]*)|&|#|$)"),i=r.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}const Ht=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...e)=>pe(void 0,void 0,void 0,function*(){return yield(yield $e(()=>Promise.resolve().then(()=>je),void 0,import.meta.url)).fetch(...e)}):t=fetch,(...e)=>t(...e)},_n=a=>typeof a=="object"&&a!==null&&"status"in a&&"ok"in a&&"json"in a&&typeof a.json=="function",be=(a,t,e)=>pe(void 0,void 0,void 0,function*(){yield a.setItem(t,JSON.stringify(e))}),Oe=(a,t)=>pe(void 0,void 0,void 0,function*(){const e=yield a.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}}),Ne=(a,t)=>pe(void 0,void 0,void 0,function*(){yield a.removeItem(t)});function pn(a){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let e="",r,i,o,l,h,d,u,_=0;for(a=a.replace("-","+").replace("_","/");_<a.length;)l=t.indexOf(a.charAt(_++)),h=t.indexOf(a.charAt(_++)),d=t.indexOf(a.charAt(_++)),u=t.indexOf(a.charAt(_++)),r=l<<2|h>>4,i=(h&15)<<4|d>>2,o=(d&3)<<6|u,e=e+String.fromCharCode(r),d!=64&&i!=0&&(e=e+String.fromCharCode(i)),u!=64&&o!=0&&(e=e+String.fromCharCode(o));return e}class Ce{constructor(){this.promise=new Ce.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}Ce.promiseConstructor=Promise;function Ot(a){const t=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,e=a.split(".");if(e.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!t.test(e[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=e[1];return JSON.parse(pn(r))}function vn(a){return new Promise(t=>{setTimeout(()=>t(null),a)})}function mn(a,t){return new Promise((r,i)=>{pe(this,void 0,void 0,function*(){for(let o=0;o<1/0;o++)try{const l=yield a(o);if(!t(o,null,l)){r(l);return}}catch(l){if(!t(o,l)){i(l);return}}})})}function yn(a){return("0"+a.toString(16)).substr(-2)}function xe(){const t=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=e.length;let i="";for(let o=0;o<56;o++)i+=e.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(t),Array.from(t,yn).join("")}function gn(a){return pe(this,void 0,void 0,function*(){const e=new TextEncoder().encode(a),r=yield crypto.subtle.digest("SHA-256",e),i=new Uint8Array(r);return Array.from(i).map(o=>String.fromCharCode(o)).join("")})}function bn(a){return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function Ie(a){return pe(this,void 0,void 0,function*(){if(typeof crypto>"u")return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),a;const t=yield gn(a);return bn(t)})}class st extends Error{constructor(t,e){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e}}function C(a){return typeof a=="object"&&a!==null&&"__isAuthError"in a}class wn extends st{constructor(t,e){super(t,e),this.name="AuthApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function Tn(a){return C(a)&&a.name==="AuthApiError"}class Nt extends st{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class Ee extends st{constructor(t,e,r){super(t),this.name=e,this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class we extends Ee{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class Ge extends Ee{constructor(t){super(t,"AuthInvalidCredentialsError",400)}}class te extends Ee{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ve extends Ee{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Xe extends Ee{constructor(t,e){super(t,"AuthRetryableFetchError",e)}}var ot=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})},An=globalThis&&globalThis.__rest||function(a,t){var e={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&t.indexOf(r)<0&&(e[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(a);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(a,r[i])&&(e[r[i]]=a[r[i]]);return e};const Pe=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),Sn=(a,t)=>ot(void 0,void 0,void 0,function*(){const e=[502,503,504];_n(a)?e.includes(a.status)?t(new Xe(Pe(a),a.status)):a.json().then(r=>{t(new wn(Pe(r),a.status||500))}).catch(r=>{t(new Nt(Pe(r),r))}):t(new Xe(Pe(a),0))}),kn=(a,t,e,r)=>{const i={method:a,headers:(t==null?void 0:t.headers)||{}};return a==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),e))};function L(a,t,e,r){var i;return ot(this,void 0,void 0,function*(){const o=Object.assign({},r==null?void 0:r.headers);r!=null&&r.jwt&&(o.Authorization=`Bearer ${r.jwt}`);const l=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(l.redirect_to=r.redirectTo);const h=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=yield En(a,t,e+h,{headers:o,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(d):{data:Object.assign({},d),error:null}})}function En(a,t,e,r,i,o){return ot(this,void 0,void 0,function*(){return new Promise((l,h)=>{a(e,kn(t,r,i,o)).then(d=>{if(!d.ok)throw d;return r!=null&&r.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>Sn(d,h))})})}function ie(a){var t;let e=null;Pn(a)&&(e=Object.assign({},a),e.expires_at=hn(a.expires_in));const r=(t=a.user)!==null&&t!==void 0?t:a;return{data:{session:e,user:r},error:null}}function _e(a){var t;return{data:{user:(t=a.user)!==null&&t!==void 0?t:a},error:null}}function On(a){return{data:a,error:null}}function xn(a){const{action_link:t,email_otp:e,hashed_token:r,redirect_to:i,verification_type:o}=a,l=An(a,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:t,email_otp:e,hashed_token:r,redirect_to:i,verification_type:o},d=Object.assign({},l);return{data:{properties:h,user:d},error:null}}function In(a){return a}function Pn(a){return a.access_token&&a.refresh_token&&a.expires_in}var ee=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})},$n=globalThis&&globalThis.__rest||function(a,t){var e={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&t.indexOf(r)<0&&(e[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(a);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(a,r[i])&&(e[r[i]]=a[r[i]]);return e};class jn{constructor({url:t="",headers:e={},fetch:r}){this.url=t,this.headers=e,this.fetch=Ht(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(t){return ee(this,void 0,void 0,function*(){try{return yield L(this.fetch,"POST",`${this.url}/logout`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(e){if(C(e))return{data:null,error:e};throw e}})}inviteUserByEmail(t,e={}){return ee(this,void 0,void 0,function*(){try{return yield L(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:_e})}catch(r){if(C(r))return{data:{user:null},error:r};throw r}})}generateLink(t){return ee(this,void 0,void 0,function*(){try{const{options:e}=t,r=$n(t,["options"]),i=Object.assign(Object.assign({},r),e);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),yield L(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:xn,redirectTo:e==null?void 0:e.redirectTo})}catch(e){if(C(e))return{data:{properties:null,user:null},error:e};throw e}})}createUser(t){return ee(this,void 0,void 0,function*(){try{return yield L(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:_e})}catch(e){if(C(e))return{data:{user:null},error:e};throw e}})}listUsers(t){var e,r,i,o,l,h,d;return ee(this,void 0,void 0,function*(){try{const u={nextPage:null,lastPage:0,total:0},_=yield L(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(e=t==null?void 0:t.page)===null||e===void 0?void 0:e.toString())!==null&&r!==void 0?r:"",per_page:(o=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:In});if(_.error)throw _.error;const n=yield _.json(),s=(l=_.headers.get("x-total-count"))!==null&&l!==void 0?l:0,c=(d=(h=_.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&d!==void 0?d:[];return c.length>0&&(c.forEach(f=>{const p=parseInt(f.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(f.split(";")[1].split("=")[1]);u[`${v}Page`]=p}),u.total=parseInt(s)),{data:Object.assign(Object.assign({},n),u),error:null}}catch(u){if(C(u))return{data:{users:[]},error:u};throw u}})}getUserById(t){return ee(this,void 0,void 0,function*(){try{return yield L(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:_e})}catch(e){if(C(e))return{data:{user:null},error:e};throw e}})}updateUserById(t,e){return ee(this,void 0,void 0,function*(){try{return yield L(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:_e})}catch(r){if(C(r))return{data:{user:null},error:r};throw r}})}deleteUser(t,e=!1){return ee(this,void 0,void 0,function*(){try{return yield L(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:_e})}catch(r){if(C(r))return{data:{user:null},error:r};throw r}})}_listFactors(t){return ee(this,void 0,void 0,function*(){try{const{data:e,error:r}=yield L(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:e,error:r}}catch(e){if(C(e))return{data:null,error:e};throw e}})}_deleteFactor(t){return ee(this,void 0,void 0,function*(){try{return{data:yield L(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(C(e))return{data:null,error:e};throw e}})}}const Rn="2.24.0",Cn="http://localhost:9999",Dn="supabase.auth.token",Ln={"X-Client-Info":`gotrue-js/${Rn}`},Fn=10,Bn={getItem:a=>He()?globalThis.localStorage.getItem(a):null,setItem:(a,t)=>{He()&&globalThis.localStorage.setItem(a,t)},removeItem:a=>{He()&&globalThis.localStorage.removeItem(a)}};function Un(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var P=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};Un();const Mn={url:Cn,storageKey:Dn,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ln,flowType:"implicit"},qe=30*1e3,Hn=3;class Nn{constructor(t){var e;this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.broadcastChannel=null;const r=Object.assign(Object.assign({},Mn),t);if(this.inMemorySession=null,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.persistSession=r.persistSession,this.storage=r.storage||Bn,this.admin=new jn({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Ht(r.fetch),this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},se()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(e=this.broadcastChannel)===null||e===void 0||e.addEventListener("message",i=>{this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}initialize(){return this.initializePromise||(this.initializePromise=this._initialize()),this.initializePromise}_initialize(){return P(this,void 0,void 0,function*(){if(this.initializePromise)return this.initializePromise;try{const t=yield this._isPKCEFlow();if(this.detectSessionInUrl&&this._isImplicitGrantFlow()||t){const{data:e,error:r}=yield this._getSessionFromUrl(t);if(r)return yield this._removeSession(),{error:r};const{session:i,redirectType:o}=e;return yield this._saveSession(i),setTimeout(()=>{o==="recovery"?this._notifyAllSubscribers("PASSWORD_RECOVERY",i):this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(t){return C(t)?{error:t}:{error:new Nt("Unexpected error during initialization",t)}}finally{yield this._handleVisibilityChange()}})}signUp(t){var e,r,i;return P(this,void 0,void 0,function*(){try{yield this._removeSession();let o;if("email"in t){const{email:_,password:n,options:s}=t;let c=null,f=null;if(this.flowType==="pkce"){const p=xe();yield be(this.storage,`${this.storageKey}-code-verifier`,p),c=yield Ie(p),f=p===c?"plain":"s256"}o=yield L(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:{email:_,password:n,data:(e=s==null?void 0:s.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken},code_challenge:c,code_challenge_method:f},xform:ie})}else if("phone"in t){const{phone:_,password:n,options:s}=t;o=yield L(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:n,data:(r=s==null?void 0:s.data)!==null&&r!==void 0?r:{},channel:(i=s==null?void 0:s.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:ie})}else throw new Ge("You must provide either an email or phone number and a password");const{data:l,error:h}=o;if(h||!l)return{data:{user:null,session:null},error:h};const d=l.session,u=l.user;return l.session&&(yield this._saveSession(l.session),this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:u,session:d},error:null}}catch(o){if(C(o))return{data:{user:null,session:null},error:o};throw o}})}signInWithPassword(t){return P(this,void 0,void 0,function*(){try{yield this._removeSession();let e;if("email"in t){const{email:o,password:l,options:h}=t;e=yield L(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:l,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ie})}else if("phone"in t){const{phone:o,password:l,options:h}=t;e=yield L(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:l,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ie})}else throw new Ge("You must provide either an email or phone number and a password");const{data:r,error:i}=e;return i||!r?{data:{user:null,session:null},error:i}:(r.session&&(yield this._saveSession(r.session),this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:r,error:i})}catch(e){if(C(e))return{data:{user:null,session:null},error:e};throw e}})}signInWithOAuth(t){var e,r,i,o;return P(this,void 0,void 0,function*(){return yield this._removeSession(),yield this._handleProviderSignIn(t.provider,{redirectTo:(e=t.options)===null||e===void 0?void 0:e.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})})}exchangeCodeForSession(t){return P(this,void 0,void 0,function*(){const e=yield Oe(this.storage,`${this.storageKey}-code-verifier`),{data:r,error:i}=yield L(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:e},xform:ie});return yield Ne(this.storage,`${this.storageKey}-code-verifier`),i||!r?{data:{user:null,session:null},error:i}:(r.session&&(yield this._saveSession(r.session),this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:r,error:i})})}signInWithIdToken(t){return P(this,void 0,void 0,function*(){yield this._removeSession();try{const{options:e,provider:r,token:i,nonce:o}=t,l=yield L(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,nonce:o,gotrue_meta_security:{captcha_token:e==null?void 0:e.captchaToken}},xform:ie}),{data:h,error:d}=l;return d||!h?{data:{user:null,session:null},error:d}:(h.session&&(yield this._saveSession(h.session),this._notifyAllSubscribers("SIGNED_IN",h.session)),{data:h,error:d})}catch(e){if(C(e))return{data:{user:null,session:null},error:e};throw e}})}signInWithOtp(t){var e,r,i,o,l;return P(this,void 0,void 0,function*(){try{if(yield this._removeSession(),"email"in t){const{email:h,options:d}=t;let u=null,_=null;if(this.flowType==="pkce"){const s=xe();yield be(this.storage,`${this.storageKey}-code-verifier`,s),u=yield Ie(s),_=s===u?"plain":"s256"}const{error:n}=yield L(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(e=d==null?void 0:d.data)!==null&&e!==void 0?e:{},create_user:(r=d==null?void 0:d.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:u,code_challenge_method:_},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:n}}if("phone"in t){const{phone:h,options:d}=t,{error:u}=yield L(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(i=d==null?void 0:d.data)!==null&&i!==void 0?i:{},create_user:(o=d==null?void 0:d.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(l=d==null?void 0:d.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null},error:u}}throw new Ge("You must provide either an email or phone number.")}catch(h){if(C(h))return{data:{user:null,session:null},error:h};throw h}})}verifyOtp(t){var e,r;return P(this,void 0,void 0,function*(){try{yield this._removeSession();const{data:i,error:o}=yield L(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:(e=t.options)===null||e===void 0?void 0:e.captchaToken}}),redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,xform:ie});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,h=i.user;return l!=null&&l.access_token&&(yield this._saveSession(l),this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:h,session:l},error:null}}catch(i){if(C(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithSSO(t){var e,r,i;return P(this,void 0,void 0,function*(){try{return yield this._removeSession(),yield L(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(e=t.options)===null||e===void 0?void 0:e.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0}),headers:this.headers,xform:On})}catch(o){if(C(o))return{data:null,error:o};throw o}})}getSession(){return P(this,void 0,void 0,function*(){yield this.initializePromise;let t=null;if(this.persistSession){const o=yield Oe(this.storage,this.storageKey);o!==null&&(this._isValidSession(o)?t=o:yield this._removeSession())}else t=this.inMemorySession;if(!t)return{data:{session:null},error:null};if(!(t.expires_at?t.expires_at<=Date.now()/1e3:!1))return{data:{session:t},error:null};const{session:r,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:r},error:null}})}getUser(t){var e,r;return P(this,void 0,void 0,function*(){try{if(!t){const{data:i,error:o}=yield this.getSession();if(o)throw o;t=(r=(e=i.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:void 0}return yield L(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:_e})}catch(i){if(C(i))return{data:{user:null},error:i};throw i}})}updateUser(t,e={}){return P(this,void 0,void 0,function*(){try{const{data:r,error:i}=yield this.getSession();if(i)throw i;if(!r.session)throw new we;const o=r.session,{data:l,error:h}=yield L(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e==null?void 0:e.emailRedirectTo,body:t,jwt:o.access_token,xform:_e});if(h)throw h;return o.user=l.user,yield this._saveSession(o),this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}}catch(r){if(C(r))return{data:{user:null},error:r};throw r}})}_decodeJWT(t){return Ot(t)}setSession(t){return P(this,void 0,void 0,function*(){try{if(!t.access_token||!t.refresh_token)throw new we;const e=Date.now()/1e3;let r=e,i=!0,o=null;const l=Ot(t.access_token);if(l.exp&&(r=l.exp,i=r<=e),i){const{session:h,error:d}=yield this._callRefreshToken(t.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!h)return{data:{user:null,session:null},error:null};o=h}else{const{data:h,error:d}=yield this.getUser(t.access_token);if(d)throw d;o={access_token:t.access_token,refresh_token:t.refresh_token,user:h.user,token_type:"bearer",expires_in:r-e,expires_at:r},yield this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(e){if(C(e))return{data:{session:null,user:null},error:e};throw e}})}refreshSession(t){var e;return P(this,void 0,void 0,function*(){try{if(!t){const{data:o,error:l}=yield this.getSession();if(l)throw l;t=(e=o.session)!==null&&e!==void 0?e:void 0}if(!(t!=null&&t.refresh_token))throw new we;const{session:r,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}catch(r){if(C(r))return{data:{user:null,session:null},error:r};throw r}})}_getSessionFromUrl(t){return P(this,void 0,void 0,function*(){try{if(!se())throw new te("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new te("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!t)throw new Ve("Not a valid PKCE flow url.");if(t){const v=K("code");if(!v)throw new Ve("No code detected.");const{data:y,error:b}=yield this.exchangeCodeForSession(v);if(b)throw b;if(!y.session)throw new Ve("No session detected.");return{data:{session:y.session,redirectType:null},error:null}}const e=K("error_description");if(e){const v=K("error_code");if(!v)throw new te("No error_code detected.");const y=K("error");throw y?new te(e,{error:y,code:v}):new te("No error detected.")}const r=K("provider_token"),i=K("provider_refresh_token"),o=K("access_token");if(!o)throw new te("No access_token detected.");const l=K("expires_in");if(!l)throw new te("No expires_in detected.");const h=K("refresh_token");if(!h)throw new te("No refresh_token detected.");const d=K("token_type");if(!d)throw new te("No token_type detected.");const _=Math.round(Date.now()/1e3)+parseInt(l),{data:n,error:s}=yield this.getUser(o);if(s)throw s;const c=n.user,f={provider_token:r,provider_refresh_token:i,access_token:o,expires_in:parseInt(l),expires_at:_,refresh_token:h,token_type:d,user:c},p=K("type");return window.location.hash="",{data:{session:f,redirectType:p},error:null}}catch(e){if(C(e))return{data:{session:null,redirectType:null},error:e};throw e}})}_isImplicitGrantFlow(){return se()&&(!!K("access_token")||!!K("error_description"))}_isPKCEFlow(){return P(this,void 0,void 0,function*(){const t=yield Oe(this.storage,`${this.storageKey}-code-verifier`);return se()&&!!K("code")&&!!t})}signOut(){var t;return P(this,void 0,void 0,function*(){const{data:e,error:r}=yield this.getSession();if(r)return{error:r};const i=(t=e.session)===null||t===void 0?void 0:t.access_token;if(i){const{error:o}=yield this.admin.signOut(i);if(o&&!(Tn(o)&&(o.status===404||o.status===401)))return{error:o}}return yield this._removeSession(),yield Ne(this.storage,`${this.storageKey}-code-verifier`),this._notifyAllSubscribers("SIGNED_OUT",null),{error:null}})}onAuthStateChange(t){const e=fn(),r={id:e,callback:t,unsubscribe:()=>{this.stateChangeEmitters.delete(e)}};return this.stateChangeEmitters.set(e,r),this.emitInitialSession(e),{data:{subscription:r}}}emitInitialSession(t){var e,r;return P(this,void 0,void 0,function*(){try{const{data:{session:i},error:o}=yield this.getSession();if(o)throw o;(e=this.stateChangeEmitters.get(t))===null||e===void 0||e.callback("INITIAL_SESSION",i)}catch(i){(r=this.stateChangeEmitters.get(t))===null||r===void 0||r.callback("INITIAL_SESSION",null),console.error(i)}})}resetPasswordForEmail(t,e={}){return P(this,void 0,void 0,function*(){let r=null,i=null;if(this.flowType==="pkce"){const o=xe();yield be(this.storage,`${this.storageKey}-code-verifier`,o),r=yield Ie(o),i=o===r?"plain":"s256"}try{return yield L(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(o){if(C(o))return{data:null,error:o};throw o}})}_refreshAccessToken(t){return P(this,void 0,void 0,function*(){try{const e=Date.now();return yield mn(r=>P(this,void 0,void 0,function*(){return yield vn(r*200),yield L(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ie})}),(r,i,o)=>o&&o.error&&o.error instanceof Xe&&Date.now()+(r+1)*200-e<qe)}catch(e){if(C(e))return{data:{session:null,user:null},error:e};throw e}})}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}_handleProviderSignIn(t,e){return P(this,void 0,void 0,function*(){const r=yield this._getUrlForProvider(t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return se()&&!e.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}})}_recoverAndRefresh(){var t;return P(this,void 0,void 0,function*(){try{const e=yield Oe(this.storage,this.storageKey);if(!this._isValidSession(e)){e!==null&&(yield this._removeSession());return}const r=Math.round(Date.now()/1e3);if(((t=e.expires_at)!==null&&t!==void 0?t:1/0)<r+Fn)if(this.autoRefreshToken&&e.refresh_token){const{error:i}=yield this._callRefreshToken(e.refresh_token);i&&(console.log(i.message),yield this._removeSession())}else yield this._removeSession();else this.persistSession&&(yield this._saveSession(e)),this._notifyAllSubscribers("SIGNED_IN",e)}catch(e){console.error(e);return}})}_callRefreshToken(t){var e,r;return P(this,void 0,void 0,function*(){if(this.refreshingDeferred)return this.refreshingDeferred.promise;try{if(this.refreshingDeferred=new Ce,!t)throw new we;const{data:i,error:o}=yield this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new we;yield this._saveSession(i.session),this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(C(i)){const o={session:null,error:i};return(e=this.refreshingDeferred)===null||e===void 0||e.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null}})}_notifyAllSubscribers(t,e,r=!0){this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:e}),this.stateChangeEmitters.forEach(i=>i.callback(t,e))}_saveSession(t){return P(this,void 0,void 0,function*(){this.persistSession||(this.inMemorySession=t),this.persistSession&&t.expires_at&&(yield this._persistSession(t))})}_persistSession(t){return be(this.storage,this.storageKey,t)}_removeSession(){return P(this,void 0,void 0,function*(){this.persistSession?yield Ne(this.storage,this.storageKey):this.inMemorySession=null})}_removeVisibilityChangedCallback(){const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&se()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(e){console.error("removing visibilitychange callback failed",e)}}_startAutoRefresh(){return P(this,void 0,void 0,function*(){yield this._stopAutoRefresh();const t=setInterval(()=>this._autoRefreshTokenTick(),qe);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),yield this._autoRefreshTokenTick()})}_stopAutoRefresh(){return P(this,void 0,void 0,function*(){const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)})}startAutoRefresh(){return P(this,void 0,void 0,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return P(this,void 0,void 0,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return P(this,void 0,void 0,function*(){const t=Date.now();try{const{data:{session:e}}=yield this.getSession();if(!e||!e.refresh_token||!e.expires_at)return;Math.floor((e.expires_at*1e3-t)/qe)<Hn&&(yield this._callRefreshToken(e.refresh_token))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}})}_handleVisibilityChange(){return P(this,void 0,void 0,function*(){if(!se()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>P(this,void 0,void 0,function*(){return yield this._onVisibilityChanged(!1)}),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})}_onVisibilityChanged(t){return P(this,void 0,void 0,function*(){document.visibilityState==="visible"?(t||(yield this.initializePromise,yield this._recoverAndRefresh()),this.autoRefreshToken&&this._startAutoRefresh()):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(t,e){return P(this,void 0,void 0,function*(){const r=[`provider=${encodeURIComponent(t)}`];if(e!=null&&e.redirectTo&&r.push(`redirect_to=${encodeURIComponent(e.redirectTo)}`),e!=null&&e.scopes&&r.push(`scopes=${encodeURIComponent(e.scopes)}`),this.flowType==="pkce"){const i=xe();yield be(this.storage,`${this.storageKey}-code-verifier`,i);const o=yield Ie(i),l=i===o?"plain":"s256",h=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(l)}`});r.push(h.toString())}if(e!=null&&e.queryParams){const i=new URLSearchParams(e.queryParams);r.push(i.toString())}return`${this.url}/authorize?${r.join("&")}`})}_unenroll(t){var e;return P(this,void 0,void 0,function*(){try{const{data:r,error:i}=yield this.getSession();return i?{data:null,error:i}:yield L(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(e=r==null?void 0:r.session)===null||e===void 0?void 0:e.access_token})}catch(r){if(C(r))return{data:null,error:r};throw r}})}_enroll(t){var e,r;return P(this,void 0,void 0,function*(){try{const{data:i,error:o}=yield this.getSession();if(o)return{data:null,error:o};const{data:l,error:h}=yield L(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:t.friendlyName,factor_type:t.factorType,issuer:t.issuer},headers:this.headers,jwt:(e=i==null?void 0:i.session)===null||e===void 0?void 0:e.access_token});return h?{data:null,error:h}:(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})}catch(i){if(C(i))return{data:null,error:i};throw i}})}_verify(t){var e;return P(this,void 0,void 0,function*(){try{const{data:r,error:i}=yield this.getSession();if(i)return{data:null,error:i};const{data:o,error:l}=yield L(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(e=r==null?void 0:r.session)===null||e===void 0?void 0:e.access_token});return l?{data:null,error:l}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})}catch(r){if(C(r))return{data:null,error:r};throw r}})}_challenge(t){var e;return P(this,void 0,void 0,function*(){try{const{data:r,error:i}=yield this.getSession();return i?{data:null,error:i}:yield L(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{headers:this.headers,jwt:(e=r==null?void 0:r.session)===null||e===void 0?void 0:e.access_token})}catch(r){if(C(r))return{data:null,error:r};throw r}})}_challengeAndVerify(t){return P(this,void 0,void 0,function*(){const{data:e,error:r}=yield this._challenge({factorId:t.factorId});return r?{data:null,error:r}:yield this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})})}_listFactors(){return P(this,void 0,void 0,function*(){const{data:{user:t},error:e}=yield this.getUser();if(e)return{data:null,error:e};const r=(t==null?void 0:t.factors)||[],i=r.filter(o=>o.factor_type==="totp"&&o.status==="verified");return{data:{all:r,totp:i},error:null}})}_getAuthenticatorAssuranceLevel(){var t,e;return P(this,void 0,void 0,function*(){const{data:{session:r},error:i}=yield this.getSession();if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(r.access_token);let l=null;o.aal&&(l=o.aal);let h=l;((e=(t=r.user.factors)===null||t===void 0?void 0:t.filter(_=>_.status==="verified"))!==null&&e!==void 0?e:[]).length>0&&(h="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:h,currentAuthenticationMethods:u},error:null}})}}class Gn extends Nn{constructor(t){super(t)}}var Vn=globalThis&&globalThis.__awaiter||function(a,t,e,r){function i(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function h(_){try{u(r.next(_))}catch(n){l(n)}}function d(_){try{u(r.throw(_))}catch(n){l(n)}}function u(_){_.done?o(_.value):i(_.value).then(h,d)}u((r=r.apply(a,t||[])).next())})};const qn={headers:sn},Jn={schema:"public"},Kn={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Wn={};class zn{constructor(t,e,r){var i,o,l,h,d,u,_,n;if(this.supabaseUrl=t,this.supabaseKey=e,!t)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const s=un(t);if(this.realtimeUrl=`${s}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${s}/auth/v1`,this.storageUrl=`${s}/storage/v1`,s.match(/(supabase\.co)|(supabase\.in)/)){const y=s.split(".");this.functionsUrl=`${y[0]}.functions.${y[1]}.${y[2]}`}else this.functionsUrl=`${s}/functions/v1`;const f=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,p={db:Jn,realtime:Wn,auth:Object.assign(Object.assign({},Kn),{storageKey:f}),global:qn},v=dn(r??{},p);this.storageKey=(o=(i=v.auth)===null||i===void 0?void 0:i.storageKey)!==null&&o!==void 0?o:"",this.headers=(h=(l=v.global)===null||l===void 0?void 0:l.headers)!==null&&h!==void 0?h:{},this.auth=this._initSupabaseAuthClient((d=v.auth)!==null&&d!==void 0?d:{},this.headers,(u=v.global)===null||u===void 0?void 0:u.fetch),this.fetch=cn(e,this._getAccessToken.bind(this),(_=v.global)===null||_===void 0?void 0:_.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},v.realtime)),this.rest=new ur(`${s}/rest/v1`,{headers:this.headers,schema:(n=v.db)===null||n===void 0?void 0:n.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new ir(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new rn(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}rpc(t,e={},r){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,e;return Vn(this,void 0,void 0,function*(){const{data:r}=yield this.auth.getSession();return(e=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:i,storageKey:o,flowType:l},h,d){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Gn({url:this.authUrl,headers:Object.assign(Object.assign({},u),h),storageKey:o,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:i,flowType:l,fetch:d})}_initRealtimeClient(t){return new qr(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,r)=>{this._handleTokenChanged(e,r==null?void 0:r.access_token,"CLIENT")})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==e?(this.realtime.setAuth(e??null),this.changedAccessToken=e):t==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Xn=(a,t,e)=>new zn(a,t,e),Qn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml6bXRzd2F2c3ZobGlveml3YnN1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODAwNTQwMDMsImV4cCI6MTk5NTYzMDAwM30.gDfwu3GFqh1SDk3vPQqNuHUeL2BRQLr2gE2mab_o-oU",Yn="https://izmtswavsvhlioziwbsu.supabase.co";Xn(Yn,Qn);function xt(a){let t,e,r,i,o;return{c(){t=O("div"),e=O("div"),r=O("a"),i=O("img"),this.h()},l(l){t=x(l,"DIV",{class:!0});var h=j(t);e=x(h,"DIV",{tabindex:!0,class:!0});var d=j(e);r=x(d,"A",{href:!0});var u=j(r);i=x(u,"IMG",{src:!0,alt:!0,class:!0}),u.forEach(S),d.forEach(S),h.forEach(S),this.h()},h(){ae(i.src,o="/back.png")||w(i,"src",o),w(i,"alt","back button"),w(i,"class","h-6 w-6"),w(r,"href","/library"),w(e,"tabindex","0"),w(e,"class","btn btn-ghost btn-circle"),w(t,"class","flex items-center")},m(l,h){W(l,t,h),A(t,e),A(e,r),A(r,i)},d(l){l&&S(t)}}}function It(a){let t,e,r,i,o;return{c(){t=O("div"),e=O("div"),r=O("a"),i=O("img"),this.h()},l(l){t=x(l,"DIV",{class:!0});var h=j(t);e=x(h,"DIV",{tabindex:!0,class:!0});var d=j(e);r=x(d,"A",{href:!0});var u=j(r);i=x(u,"IMG",{src:!0,alt:!0,class:!0}),u.forEach(S),d.forEach(S),h.forEach(S),this.h()},h(){ae(i.src,o="/back.png")||w(i,"src",o),w(i,"alt","back button"),w(i,"class","h-6 w-6"),w(r,"href","/"),w(e,"tabindex","0"),w(e,"class","btn btn-ghost btn-circle"),w(t,"class","flex items-center")},m(l,h){W(l,t,h),A(t,e),A(e,r),A(r,i)},d(l){l&&S(t)}}}function Pt(a){let t,e;return{c(){t=O("a"),e=le("Maverick White Reading Software"),this.h()},l(r){t=x(r,"A",{class:!0});var i=j(t);e=ce(i,"Maverick White Reading Software"),i.forEach(S),this.h()},h(){w(t,"class","text-2xl pb-1 poppins pt-2 mx-auto")},m(r,i){W(r,t,i),A(t,e)},d(r){r&&S(t)}}}function $t(a){let t,e,r,i,o,l,h,d,u=a[6]?"Pause":"Start",_,n,s,c,f,p,v,y,b,T,E,$,U,M,F,I,G,D,X,Q;return{c(){t=O("div"),e=V(),r=O("div"),i=O("div"),o=O("a"),l=le("Stopwatch:"),h=V(),d=O("button"),_=le(u),n=V(),s=O("button"),c=le("Reset"),f=V(),p=O("div"),v=O("div"),y=le(a[5]),b=V(),T=O("div"),E=V(),$=O("div"),U=O("center"),M=O("p"),F=le("Progress:"),I=V(),G=O("div"),D=O("div"),this.h()},l(m){t=x(m,"DIV",{class:!0}),j(t).forEach(S),e=q(m),r=x(m,"DIV",{class:!0});var g=j(r);i=x(g,"DIV",{});var k=j(i);o=x(k,"A",{class:!0});var N=j(o);l=ce(N,"Stopwatch:"),N.forEach(S),h=q(k),d=x(k,"BUTTON",{class:!0});var H=j(d);_=ce(H,u),H.forEach(S),n=q(k),s=x(k,"BUTTON",{class:!0});var R=j(s);c=ce(R,"Reset"),R.forEach(S),k.forEach(S),f=q(g),p=x(g,"DIV",{class:!0});var ue=j(p);v=x(ue,"DIV",{class:!0});var re=j(v);y=ce(re,a[5]),re.forEach(S),ue.forEach(S),g.forEach(S),b=q(m),T=x(m,"DIV",{class:!0}),j(T).forEach(S),E=q(m),$=x(m,"DIV",{class:!0});var ne=j($);U=x(ne,"CENTER",{});var at=j(U);M=x(at,"P",{class:!0});var lt=j(M);F=ce(lt,"Progress:"),lt.forEach(S),at.forEach(S),I=q(ne),G=x(ne,"DIV",{class:!0});var ct=j(G);D=x(ct,"DIV",{class:!0,style:!0}),j(D).forEach(S),ct.forEach(S),ne.forEach(S),this.h()},h(){w(t,"class","divider divider-horizontal"),w(o,"class","poppins text-xl pr-4"),w(d,"class","bg-gray-100 text-black font-bold rounded-full poppins py-2 px-4 rounded timer-button svelte-1vdmm9a"),w(s,"class","bg-gray-100 text-black rounded-full font-bold poppins py-2 px-5 rounded timer-button pr-10 svelte-1vdmm9a"),w(v,"class","text-xl rounded-full font-medium text-center text-black p-3 rounded bg-gray-100"),w(p,"class","pr-1"),w(r,"class","flex items-center gap-2"),w(T,"class","divider divider-horizontal"),w(M,"class","poppins text-base pb-3"),w(D,"class","progress svelte-1vdmm9a"),dt(D,"width",a[7]+"%"),w(G,"class","progress-bar rounded-full svelte-1vdmm9a"),w($,"class","w-48")},m(m,g){W(m,t,g),W(m,e,g),W(m,r,g),A(r,i),A(i,o),A(o,l),A(i,h),A(i,d),A(d,_),A(i,n),A(i,s),A(s,c),A(r,f),A(r,p),A(p,v),A(v,y),W(m,b,g),W(m,T,g),W(m,E,g),W(m,$,g),A($,U),A(U,M),A(M,F),A($,I),A($,G),A(G,D),X||(Q=[ht(d,"click",a[13]),ht(s,"click",a[11])],X=!0)},p(m,g){g&64&&u!==(u=m[6]?"Pause":"Start")&&ft(_,u),g&32&&ft(y,m[5]),g&128&&dt(D,"width",m[7]+"%")},d(m){m&&S(t),m&&S(e),m&&S(r),m&&S(b),m&&S(T),m&&S(E),m&&S($),X=!1,Vt(Q)}}}function jt(a){let t,e,r,i;return{c(){t=O("div"),e=O("a"),r=O("img"),this.h()},l(o){t=x(o,"DIV",{class:!0});var l=j(t);e=x(l,"A",{href:!0});var h=j(e);r=x(h,"IMG",{src:!0,alt:!0,class:!0}),h.forEach(S),l.forEach(S),this.h()},h(){ae(r.src,i="/profile.png")||w(r,"src",i),w(r,"alt","profile"),w(r,"class","rounded-full"),w(e,"href","/profile"),w(t,"class","avatar w-12 btn btn-ghost btn-circle")},m(o,l){W(o,t,l),A(t,e),A(e,r)},d(o){o&&S(t)}}}function Zn(a){let t,e,r,i,o,l,h,d=!a[8]&!a[1]&!a[2]&!a[3]&&xt(),u=a[4]&&It(),_=!a[0]&&Pt(),n=a[0]&&$t(a),s=!a[1]&!a[0]&!a[2]&!a[3]&&jt();return{c(){t=O("div"),e=O("div"),r=O("nav"),d&&d.c(),i=V(),u&&u.c(),o=V(),_&&_.c(),l=V(),n&&n.c(),h=V(),s&&s.c(),this.h()},l(c){t=x(c,"DIV",{class:!0});var f=j(t);e=x(f,"DIV",{class:!0});var p=j(e);r=x(p,"NAV",{class:!0});var v=j(r);d&&d.l(v),i=q(v),u&&u.l(v),o=q(v),_&&_.l(v),l=q(v),n&&n.l(v),h=q(v),s&&s.l(v),v.forEach(S),p.forEach(S),f.forEach(S),this.h()},h(){w(r,"class","flex justify-between overflow-x-auto"),w(e,"class","container mx-auto px-5 py-2"),w(t,"class","fixed inset-x-0 top-0 z-50 bg-white")},m(c,f){W(c,t,f),A(t,e),A(e,r),d&&d.m(r,null),A(r,i),u&&u.m(r,null),A(r,o),_&&_.m(r,null),A(r,l),n&&n.m(r,null),A(r,h),s&&s.m(r,null)},p(c,[f]){!c[8]&!c[1]&!c[2]&!c[3]?d||(d=xt(),d.c(),d.m(r,i)):d&&(d.d(1),d=null),c[4]?u||(u=It(),u.c(),u.m(r,o)):u&&(u.d(1),u=null),c[0]?_&&(_.d(1),_=null):_||(_=Pt(),_.c(),_.m(r,l)),c[0]?n?n.p(c,f):(n=$t(c),n.c(),n.m(r,h)):n&&(n.d(1),n=null),!c[1]&!c[0]&!c[2]&!c[3]?s||(s=jt(),s.c(),s.m(r,null)):s&&(s.d(1),s=null)},i:Te,o:Te,d(c){c&&S(t),d&&d.d(),u&&u.d(),_&&_.d(),n&&n.d(),s&&s.d()}}}function ei(a,t,e){let r,i;Gt(a,zt,I=>e(12,i=I));var o,l,h,d,u;let _,n="0:00",s=!1,c,f=0,p;const v=()=>{p=new Rt.Howl({src:"/mixkit-classic-alarm-995.wav"}),p.play()},y=()=>{p.stop()},b=()=>{e(6,s=!0),c=Date.now()-f,_=setInterval(()=>{f=Date.now()-c;const I=Math.floor(f/6e4),G=Math.floor(f%6e4/1e3);e(5,n=`${I}:${G.toString().padStart(2,"0")}`)},1e3)},T=()=>{clearInterval(_),e(6,s=!1),f=Date.now()-c},E=()=>{clearInterval(_),e(6,s=!1),e(5,n="0:00"),f=0};ut(()=>{v(),y()});let $=0;ut(()=>{window.addEventListener("scroll",U),e(7,$=localStorage.getItem("scrollPercentage")||0)});function U(){const I=document.documentElement.scrollTop,G=document.documentElement.scrollHeight-document.documentElement.clientHeight;e(7,$=Math.floor(I/G*100)),localStorage.setItem("scrollPercentage",$),M()}function M(){const I=document.getElementById("scrubber");I&&I.value&&$&&(I.value=$)}const F=()=>{s?T():b()};return a.$$.update=()=>{a.$$.dirty&4096&&e(0,o=i.url.pathname.indexOf("book/")>0),a.$$.dirty&4096&&i.url.pathname.indexOf("audiobook/")>0,a.$$.dirty&4096&&e(1,l=i.url.pathname=="/"),a.$$.dirty&4096&&e(3,d=i.url.pathname=="/signin"),a.$$.dirty&4096&&e(8,r=i.url.pathname=="/library"),a.$$.dirty&4096&&e(4,u=i.url.pathname=="/setup/signup"),a.$$.dirty&4096&&e(2,h=i.url.pathname.indexOf("setup/")>0)},[o,l,h,d,u,n,s,$,r,b,T,E,i,F]}class ti extends Qe{constructor(t){super(),Ye(this,t,ei,Zn,Ze,{})}}function ri(a){let t,e,r,i,o,l,h,d,u,_,n,s,c,f,p,v,y,b,T,E,$,U,M,F,I;return{c(){t=O("footer"),e=O("div"),r=O("img"),o=V(),l=O("a"),h=le("Maverick White Reading May 2023 Beta"),d=V(),u=O("div"),_=O("a"),n=O("img"),c=V(),f=O("a"),p=O("img"),y=V(),b=O("a"),T=O("img"),$=V(),U=O("div"),M=O("a"),F=O("img"),this.h()},l(G){t=x(G,"FOOTER",{class:!0});var D=j(t);e=x(D,"DIV",{class:!0});var X=j(e);r=x(X,"IMG",{src:!0,width:!0}),o=q(X),l=x(X,"A",{class:!0});var Q=j(l);h=ce(Q,"Maverick White Reading May 2023 Beta"),Q.forEach(S),X.forEach(S),d=q(D),u=x(D,"DIV",{class:!0});var m=j(u);_=x(m,"A",{target:!0,href:!0});var g=j(_);n=x(g,"IMG",{src:!0,class:!0,alt:!0,width:!0}),g.forEach(S),c=q(m),f=x(m,"A",{target:!0,href:!0});var k=j(f);p=x(k,"IMG",{src:!0,class:!0,alt:!0,width:!0}),k.forEach(S),y=q(m),b=x(m,"A",{target:!0,href:!0});var N=j(b);T=x(N,"IMG",{src:!0,class:!0,alt:!0,width:!0}),N.forEach(S),$=q(m),U=x(m,"DIV",{class:!0});var H=j(U);M=x(H,"A",{target:!0,href:!0});var R=j(M);F=x(R,"IMG",{src:!0,class:!0,alt:!0,width:!0}),R.forEach(S),H.forEach(S),m.forEach(S),D.forEach(S),this.h()},h(){ae(r.src,i="/blacklogo.png")||w(r,"src",i),w(r,"width","120"),w(l,"class","poppins text-xl text-black"),w(e,"class","items-center grid-flow-col"),ae(n.src,s="/youtube.svg")||w(n,"src",s),w(n,"class","btn p-2 btn-square hover:bg-red-400 btn-outline"),w(n,"alt","Youtube"),w(n,"width","60"),w(_,"target","_blank"),w(_,"href","https://www.youtube.com/channel/UCFX6Qz84JDNXvfCegXOq3aA"),ae(p.src,v="/mail.png")||w(p,"src",v),w(p,"class","py-3 p-2 btn hover:bg-purple-400 btn-square btn-outline"),w(p,"alt","Contact Us"),w(p,"width","60"),w(f,"target","_blank"),w(f,"href","mailto:maverick.white.books@gmail.com?subject="),ae(T.src,E="/merch.png")||w(T,"src",E),w(T,"class","btn p-2 hover:bg-blue-400 btn-square btn-outline"),w(T,"alt","Merch"),w(T,"width","55"),w(b,"target","_blank"),w(b,"href","https://www.zazzle.com/store/maverick_merch/products"),ae(F.src,I="/donate.png")||w(F,"src",I),w(F,"class","btn p-2 hover:bg-green-300 btn-square btn-outline"),w(F,"alt","Donate"),w(F,"width","55"),w(M,"target","_blank"),w(M,"href","https://donate.stripe.com/test_bIYcQI4aK1YGcHCaEJ"),w(U,"class","pr-10 pb-2"),w(u,"class","grid-flow-col gap-4 md:place-self-center md:justify-self-end"),w(t,"class","footer rounded-full items-center bg-white p-4 m-0 mt-40 text-neutral-content")},m(G,D){W(G,t,D),A(t,e),A(e,r),A(e,o),A(e,l),A(l,h),A(t,d),A(t,u),A(u,_),A(_,n),A(u,c),A(u,f),A(f,p),A(u,y),A(u,b),A(b,T),A(u,$),A(u,U),A(U,M),A(M,F)},p:Te,i:Te,o:Te,d(G){G&&S(t)}}}class ni extends Qe{constructor(t){super(),Ye(this,t,null,ri,Ze,{})}}function ii(a){let t,e,r,i,o,l,h,d,u;e=new ti({});const _=a[1].default,n=qt(_,a,a[0],null);return d=new ni({}),{c(){t=O("div"),_t(e.$$.fragment),r=V(),i=O("div"),o=le(""),l=V(),n&&n.c(),h=V(),_t(d.$$.fragment),this.h()},l(s){t=x(s,"DIV",{class:!0});var c=j(t);pt(e.$$.fragment,c),r=q(c),i=x(c,"DIV",{class:!0});var f=j(i);o=ce(f,""),f.forEach(S),l=q(c),n&&n.l(c),h=q(c),pt(d.$$.fragment,c),c.forEach(S),this.h()},h(){w(i,"class","h-20"),w(t,"class","max-w-screen mx-auto overflow-hidden")},m(s,c){W(s,t,c),vt(e,t,null),A(t,r),A(t,i),A(i,o),A(t,l),n&&n.m(t,null),A(t,h),vt(d,t,null),u=!0},p(s,[c]){n&&n.p&&(!u||c&1)&&Jt(n,_,s,s[0],u?Wt(_,s[0],c,null):Kt(s[0]),null)},i(s){u||(De(e.$$.fragment,s),De(n,s),De(d.$$.fragment,s),u=!0)},o(s){Le(e.$$.fragment,s),Le(n,s),Le(d.$$.fragment,s),u=!1},d(s){s&&S(t),mt(e),n&&n.d(s),mt(d)}}}function si(a,t,e){let{$$slots:r={},$$scope:i}=t;return a.$$set=o=>{"$$scope"in o&&e(0,i=o.$$scope)},[i,r]}class ci extends Qe{constructor(t){super(),Ye(this,t,si,ii,Ze,{})}}export{ci as default};
